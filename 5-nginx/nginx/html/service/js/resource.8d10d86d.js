(window.webpackJsonp=window.webpackJsonp||[]).push([["resource"],{"000d":function(e,t,a){"use strict";var n=a("a45b");a.n(n).a},"0097":function(e,t,a){"use strict";var n=a("6b16");a.n(n).a},"02f7":function(e,t,a){"use strict";a("ac6a"),a("3b2b"),a("a481"),a("f751"),a("c5f6");var n=a("7e65"),r=a("e61f"),i={id:"",userSource:"",activityName:"",followType:"",isEffectiveCommunication:1,content:"",followResult:"",followFlag:"",noIntentionReason:"",noIntentionReasonExtra:"",isQuotaReserved:"",customerLevel:"",intendedTerm:"",intendedSubject:"",intendedClassType:"",intendedTime:"",intendedTeacher:"",intendedTeachingPoint:"",noDiagnosisReason:"",noDiagnosisReasonExtra:"",isAppointmentFollow:0,appointmentTime:"",appointmentContent:"",timeValue:"",resultArr:[]},s={name:"MaintainRecordAdd",props:{show:{type:Boolean,default:!1},uid:Number,data:{type:Object,default:function(){return{}}},tempData:{type:Object},from:String},data:function(){var e=this;return{showValidateMsg:!1,formData:Object.assign({},i),ruleValidate:{followType:[{required:!0,message:"请选择沟通方式"}],isEffectiveCommunication:[{required:!0,message:"请选择是否有效沟通"}],activityName:[{validator:function(t,a,n){"3"!==e.formData.userSource||a?n():n(new Error("请输入用户参与的活动/短期班/直播名称"))}}],followFlag:[{validator:function(t,a,n){100!==e.formData.resultArr[0]||a?n():n(new Error("请输入自定义达成结果"))}}],noIntentionReasonExtra:[{validator:function(t,a,n){100!==e.formData.resultArr[1]||a?n():n(new Error("请输入无意向报名原因"))}}],resultArr:[{validator:function(t,a,n){1!==e.formData.isEffectiveCommunication||a&&a.length?n():n(new Error("请选择达成结果"))}}],isQuotaReserved:[{validator:function(t,a,n){1===e.formData.isEffectiveCommunication&&""===a?n(new Error("请选择是否预留名额")):n()}}],customerLevel:[{validator:function(t,a,n){1===e.formData.isEffectiveCommunication&&""===a?n(new Error("请选择客户分级")):n()}}],noDiagnosisReasonExtra:[{validator:function(t,a,n){"100"!==e.formData.noDiagnosisReason||a?n():n(new Error("请输入其他不参诊原因"))}}],timeValue:[{validator:function(t,a,n){1!==e.formData.isAppointmentFollow||a?n():n(new Error("请选择维护时间"))}}],appointmentContent:[{validator:function(t,a,n){1!==e.formData.isAppointmentFollow||a?n():n(new Error("请填写预约内容"))}}]}}},methods:{tempSave:function(){var e=this;this.formData.pyUid=this.uid,Object(n.d)(this.formData).then((function(){e.$Message.success("保存成功")})).catch((function(t){e.$Message.error("保存失败:"+t.message)}))},saveConfirm:function(){var e=this;this.showValidateMsg=!0,this.$refs.recordAddForm.validate((function(t){t&&e.$emit("success",e.formData)}))},clear:function(){var e=this;this.$Modal.confirm({title:"确认",content:"是否确认清空？",onOk:function(){e.formData.id?Object(n.b)({tmpId:e.formData.id}).then((function(){e.$Message.success("清空成功"),e.formData=Object.assign({},i),e.$refs.recordAddForm.resetFields()})).catch((function(t){e.$Message.error("清空失败:"+t.message)})):e.$refs.recordAddForm.resetFields()}})},changeTime:function(e){e&&(e=e.replace(new RegExp(/-/gm),"/"),this.formData.appointmentTime=new Date(e).getTime()/1e3)},setValue:function(){this.$refs.recordAddForm.resetFields(),this.formData.id&&Object(n.b)({tmpId:this.formData.id}),this.formData.appointmentTime=""},diagnosisReasonChange:function(){this.formData.noDiagnosisReasonExtra=""},changeStatus:function(){0===this.formData.isAppointmentFollow&&(this.formData.timeValue="",this.formData.appointmentTime="",this.formData.appointmentContent="")},changeResult:function(e){this.formData.followResult=e[0],this.formData.noIntentionReason=e[1],this.formData.followFlag="",this.formData.noIntentionReasonExtra=""},getTempData:function(){var e=this;Object(n.c)({pyUid:this.uid}).then((function(t){t&&t.id&&(t.userSource&&(t.userSource=String(t.userSource)),t.followType&&(t.followType=String(t.followType)),t.noDiagnosisReason&&(t.noDiagnosisReason=String(t.noDiagnosisReason)),t.resultArr=[t.followResult,t.noIntentionReason],t.appointmentTime&&"0"!==t.appointmentTime&&(t.timeValue=new Date(1e3*t.appointmentTime)),null===t.isEffectiveCommunication&&(t.isEffectiveCommunication=1),e.formData=Object.assign(e.formData,t))})).catch((function(t){e.$Message.error("查询缓存数据失败:"+t.message)}))},isEffectiveCommunicationChange:function(e){if(0===e){var t={id:this.formData.id,followType:this.formData.followType,isEffectiveCommunication:this.formData.isEffectiveCommunication,isAppointmentFollow:this.formData.isAppointmentFollow,timeValue:this.formData.timeValue,appointmentTime:this.formData.appointmentTime,appointmentContent:this.formData.appointmentContent};this.formData=Object.assign({},i,t)}}},computed:{modalValue:{get:function(){if(this.show&&(this.getTempData(),this.data.needFollowTaskList)){var e="";this.data.needFollowTaskList.forEach((function(t){e+=t.taskName+","})),Object(r.a)("click_UUYa0Ong",{task_name:e.slice(0,-1),biz_type:this.from})}return this.show},set:function(e){this.showValidateMsg=!1,this.formData=Object.assign({},i),this.$refs.recordAddForm.resetFields(),this.$emit("close",e)}}}},o=(a("f6ce"),a("2877")),l=Object(o.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{"mask-closable":!1,title:"添加维护记录",width:"700px"},model:{value:e.modalValue,callback:function(t){e.modalValue=t},expression:"modalValue"}},[a("Form",{ref:"recordAddForm",attrs:{model:e.formData,rules:e.ruleValidate,"label-width":100,"label-position":"right","show-message":e.showValidateMsg}},[a("FormItem",{attrs:{label:"维护任务",prop:"tag"}},[e.data.needFollowTaskList&&e.data.needFollowTaskList.length?e._l(e.data.needFollowTaskList,(function(t,n){return a("Tag",{key:n,attrs:{color:"primary"}},[e._v(e._s(t.taskName))])})):a("Tag",{attrs:{color:"primary"}},[e._v("其他")])],2),e._v(" "),a("Row",[a("Col",{attrs:{span:12}},[a("FormItem",{attrs:{label:"沟通方式",prop:"followType"}},[a("Select",{staticStyle:{width:"120px"},model:{value:e.formData.followType,callback:function(t){e.$set(e.formData,"followType",t)},expression:"formData.followType"}},e._l(e.data.followRecordCommModeMap,(function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1)],1),e._v(" "),a("Col",{attrs:{span:12}},[a("FormItem",{attrs:{label:"是否有效沟通",prop:"isEffectiveCommunication"}},[a("RadioGroup",{on:{"on-change":e.isEffectiveCommunicationChange},model:{value:e.formData.isEffectiveCommunication,callback:function(t){e.$set(e.formData,"isEffectiveCommunication",t)},expression:"formData.isEffectiveCommunication"}},[a("Radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("Radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1)],1),e._v(" "),1===e.formData.isEffectiveCommunication?[a("FormItem",{attrs:{label:"用户来源",prop:"userSource"}},[a("Select",{staticStyle:{width:"120px"},model:{value:e.formData.userSource,callback:function(t){e.$set(e.formData,"userSource",t)},expression:"formData.userSource"}},e._l(e.data.followRecordUserSource,(function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"3"===e.formData.userSource,expression:"formData.userSource === '3'"}]},[a("FormItem",{staticStyle:{"margin-bottom":"3px"},attrs:{prop:"activityName"}},[a("Input",{attrs:{maxlength:20,placeholder:"请输入用户参与的活动、短期班、直播名称"},model:{value:e.formData.activityName,callback:function(t){e.$set(e.formData,"activityName",t)},expression:"formData.activityName"}})],1),e._v(" "),a("div",{staticClass:"text-num"},[e._v(e._s(e.formData.activityName.length)+"/20")])],1),e._v(" "),a("FormItem",{staticStyle:{"margin-bottom":"3px"},attrs:{label:"沟通内容",prop:"content"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},maxlength:300,placeholder:"请输入沟通内容"},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1),e._v(" "),a("div",{staticClass:"text-num"},[e._v(e._s(e.formData.content.length)+"/300")]),e._v(" "),a("Row",[a("Col",{attrs:{span:12}},[a("FormItem",{attrs:{label:"达成结果",prop:"resultArr"}},[a("Cascader",{attrs:{data:e.data.followRecordCommResultMap},on:{"on-change":e.changeResult},model:{value:e.formData.resultArr,callback:function(t){e.$set(e.formData,"resultArr",t)},expression:"formData.resultArr"}})],1)],1),e._v(" "),a("Col",{attrs:{span:12}},[a("FormItem",{attrs:{label:"是否预留名额",prop:"isQuotaReserved"}},[a("RadioGroup",{model:{value:e.formData.isQuotaReserved,callback:function(t){e.$set(e.formData,"isQuotaReserved",t)},expression:"formData.isQuotaReserved"}},[a("Radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("Radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:100===e.formData.resultArr[0],expression:"formData.resultArr[0] === 100"}]},[a("FormItem",{staticStyle:{"margin-bottom":"3px"},attrs:{label:"",prop:"followFlag"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},maxlength:300,placeholder:"请输入自定义达成结果"},model:{value:e.formData.followFlag,callback:function(t){e.$set(e.formData,"followFlag",t)},expression:"formData.followFlag"}})],1),e._v(" "),a("div",{staticClass:"text-num"},[e._v(e._s(e.formData.followFlag.length)+"/300")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:100===e.formData.resultArr[1],expression:"formData.resultArr[1] === 100"}]},[a("FormItem",{staticStyle:{"margin-bottom":"3px"},attrs:{label:"",prop:"noIntentionReasonExtra"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},maxlength:300,placeholder:"请输入无意向报名原因"},model:{value:e.formData.noIntentionReasonExtra,callback:function(t){e.$set(e.formData,"noIntentionReasonExtra",t)},expression:"formData.noIntentionReasonExtra"}})],1),e._v(" "),a("div",{staticClass:"text-num"},[e._v(e._s(e.formData.noIntentionReasonExtra.length)+"/300")])],1),e._v(" "),a("FormItem",{attrs:{label:"客户分级",prop:"customerLevel"}},[a("Select",{staticStyle:{width:"120px"},model:{value:e.formData.customerLevel,callback:function(t){e.$set(e.formData,"customerLevel",t)},expression:"formData.customerLevel"}},e._l(e.data.followRecordCustomerLevel,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),e._v(" "),a("FormItem",{attrs:{label:"意向记录"}},[a("Row",[a("Col",{attrs:{span:8}},[e._v("意向学期 "),a("Input",{staticStyle:{width:"120px"},attrs:{maxlength:50},model:{value:e.formData.intendedTerm,callback:function(t){e.$set(e.formData,"intendedTerm",t)},expression:"formData.intendedTerm"}})],1),e._v(" "),a("Col",{attrs:{span:8}},[e._v("意向学科 "),a("Input",{staticStyle:{width:"120px"},attrs:{maxlength:50},model:{value:e.formData.intendedSubject,callback:function(t){e.$set(e.formData,"intendedSubject",t)},expression:"formData.intendedSubject"}})],1),e._v(" "),a("Col",{attrs:{span:8}},[e._v("意向班型 "),a("Input",{staticStyle:{width:"120px"},attrs:{maxlength:50},model:{value:e.formData.intendedClassType,callback:function(t){e.$set(e.formData,"intendedClassType",t)},expression:"formData.intendedClassType"}})],1)],1),e._v(" "),a("Row",{staticStyle:{"margin-top":"10px"}},[a("Col",{attrs:{span:8}},[e._v("意向时间 "),a("Input",{staticStyle:{width:"120px"},attrs:{maxlength:50},model:{value:e.formData.intendedTime,callback:function(t){e.$set(e.formData,"intendedTime",t)},expression:"formData.intendedTime"}})],1),e._v(" "),a("Col",{attrs:{span:8}},[e._v("意向教师 "),a("Input",{staticStyle:{width:"120px"},attrs:{maxlength:50},model:{value:e.formData.intendedTeacher,callback:function(t){e.$set(e.formData,"intendedTeacher",t)},expression:"formData.intendedTeacher"}})],1),e._v(" "),a("Col",{attrs:{span:8}},[e._v("意向教学点 "),a("Input",{staticStyle:{width:"120px"},attrs:{maxlength:50},model:{value:e.formData.intendedTeachingPoint,callback:function(t){e.$set(e.formData,"intendedTeachingPoint",t)},expression:"formData.intendedTeachingPoint"}})],1)],1)],1),e._v(" "),a("FormItem",{attrs:{label:"不参诊原因",prop:"noDiagnosisReason"}},[a("Select",{staticStyle:{width:"120px"},attrs:{clearable:""},on:{"on-change":e.diagnosisReasonChange},model:{value:e.formData.noDiagnosisReason,callback:function(t){e.$set(e.formData,"noDiagnosisReason",t)},expression:"formData.noDiagnosisReason"}},e._l(e.data.followRecordNoDiagnosisReason,(function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"100"===e.formData.noDiagnosisReason,expression:"formData.noDiagnosisReason === '100'"}]},[a("FormItem",{staticStyle:{"margin-bottom":"3px"},attrs:{label:"",prop:"noDiagnosisReasonExtra"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},maxlength:300,placeholder:"请输入其他不参诊原因"},model:{value:e.formData.noDiagnosisReasonExtra,callback:function(t){e.$set(e.formData,"noDiagnosisReasonExtra",t)},expression:"formData.noDiagnosisReasonExtra"}})],1),e._v(" "),a("div",{staticClass:"text-num"},[e._v(e._s(e.formData.noIntentionReasonExtra.length)+"/300")])],1)]:e._e(),e._v(" "),a("FormItem",{attrs:{label:"维护预约",prop:"isAppointmentFollow"}},[a("RadioGroup",{on:{"on-change":e.changeStatus},model:{value:e.formData.isAppointmentFollow,callback:function(t){e.$set(e.formData,"isAppointmentFollow",t)},expression:"formData.isAppointmentFollow"}},[a("Radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("Radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.formData.isAppointmentFollow,expression:"formData.isAppointmentFollow === 1"}]},[a("FormItem",{attrs:{label:"维护时间",prop:"timeValue"}},[a("DatePicker",{attrs:{type:"datetime",placeholder:"选择时间",format:"yyyy-MM-dd HH:mm:ss",editable:!1},on:{"on-change":e.changeTime},model:{value:e.formData.timeValue,callback:function(t){e.$set(e.formData,"timeValue",t)},expression:"formData.timeValue"}})],1),e._v(" "),a("FormItem",{staticStyle:{"margin-bottom":"3px"},attrs:{label:"预约内容",prop:"appointmentContent"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},maxlength:300,placeholder:"请输入预约内容"},model:{value:e.formData.appointmentContent,callback:function(t){e.$set(e.formData,"appointmentContent",t)},expression:"formData.appointmentContent"}})],1),e._v(" "),a("div",{staticClass:"text-num"},[e._v(e._s(e.formData.appointmentContent.length)+"/300")])],1)],2),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("div",{staticStyle:{"text-align":"center"}},[a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.saveConfirm}},[e._v("提交")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"10px"},on:{click:e.tempSave}},[e._v("保存")]),e._v(" "),a("Button",{on:{click:e.clear}},[e._v("清空")])],1)])],1)}),[],!1,null,null,null);t.a=l.exports},"05e5":function(e,t,a){"use strict";var n=a("522dc");a.n(n).a},"05fd":function(e,t,a){"use strict";var n=a("0e89");a.n(n).a},"0d3d":function(e,t,a){},"0d3f":function(e,t,a){"use strict";var n=a("e5ed");a.n(n).a},"0e89":function(e,t,a){},1800:function(e,t,a){},1859:function(e,t,a){},"1ad0":function(e,t,a){},"1bad":function(e,t,a){"use strict";var n=a("d8e7");a.n(n).a},"1c08c":function(e,t,a){"use strict";a.r(t);a("8e6e"),a("ac6a"),a("cadf"),a("456d"),a("96cf");var n=a("3b8d"),r=a("bd86"),i=(a("7f7f"),a("2b0e")),s=a("d4be"),o=a("2f62");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u,d={name:"classRoster",mixins:[a("0ef6").a],data:function(){var e=this;return{loading:!1,tabelList:[],dic:{ifKol:{1:"否",0:"是"},preAt:{1:"在读",0:"未在读"}},columns:[{key:"id",title:"序号",align:"center"},{title:"学员",key:"name",render:function(t,a){var n=a.row;return t("a",{on:{click:function(){var t={card:n.card,cityCode:e.userInfo.cityCode};e.goCustomerDetail(t)}}},n.name||"--")}},{title:"手机号",key:"tel",width:150,render:function(e,t){var a=t.row;t.columns,t.index;return e("tal-decode-text",{props:{encodeText:a.tel,type:"phone",uid:a.id}})}},{title:"注册日期",key:"regDate",width:180,render:function(e,t){return e("span",t.row.regDate||"--")}},{title:"是否KOL",key:"ifKol",render:function(t,a){var n=a.row;return t("span",e.dic.ifKol[n.ifKol]||"--")}},{title:"当期在读",key:"currAt",align:"right",render:function(t,a){var n=a.row;return t("span",e.dic.ifKol[n.currAt]||"--")}},{title:"上期在读",key:"preAt",align:"right",render:function(t,a){var n=a.row;return t("span",e.dic.preAt[n.preAt]||"--")}},{title:"上上期在读",key:"prePreAt",align:"right",render:function(t,a){var n=a.row;return t("span",e.dic.preAt[n.prePreAt]||"--")}},{title:"累计老带新量",key:"total",align:"right",render:function(e,t){return e("span",t.row.total||"--")}}]}},computed:c(c({},Object(o.e)("resource",["classRoster","classRosterSearch","classRosteLoading"])),Object(o.e)("roleRelativeData",["userInfo"])),methods:c(c({},Object(o.b)("resource",["queryClassRoster"])),{},{changePage:function(e){var t=c(c({},this.classRosterSearch),{},{pageNum:e});this.queryClassRoster(t)},toggleMobile:(u=Object(n.a)(regeneratorRuntime.mark((function e(t,a){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isNotFullPhone=!t.isNotFullPhone,t.tel){e.next=3;break}return e.abrupt("return");case 3:return n={uid:t.id,encodePhone:t.tel},e.prev=4,e.next=7,Object(s.a)(n);case 7:r=e.sent,i.default.set(this.classRoster.records,a,c(c({},t),{},{fullTel:r})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),this.$Message.error({content:"手机号解码失败:"+e.t0.message,duration:5});case 14:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e,t){return u.apply(this,arguments)})}),watch:{$route:{handler:function(e){if("classRoster"===e.name){var t=e.query,a=t.areaCode,n={pageSize:10,pageNo:1,schoolId:t.schoolId,classOrder:t.classOrder,areaCode:a,gradeId:t.gradeId,cityCode:this.userInfo.cityCode};this.queryClassRoster(n)}},immediate:!0}}},p=(a("52d8"),a("2877")),m={name:"classRoster",components:{ClassRosterTable:Object(p.a)(d,(function(){var e=this.$createElement,t=this._self._c||e;return t("Layout",{attrs:{id:"class-roster-table"}},[t("Row",[t("Table",{staticClass:"tableStyle",attrs:{columns:this.columns,data:this.classRoster.records,loading:this.classRosteLoading}})],1),this._v(" "),t("Row",{attrs:{type:"flex",justify:"end"}},[t("Page",{attrs:{total:this.classRoster.totalCount,current:this.classRoster.pageNo,"show-total":"","show-elevator":""},on:{"on-change":this.changePage}})],1)],1)}),[],!1,null,null,null).exports},data:function(){return{}},methods:{}},f=(a("d473"),Object(p.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dic-wrapper"},[a("div",{staticClass:"search-wrapper"},[a("h2",[a("span",[e._v("\n        "+e._s(e.$route.query.schoolName)+"\n      ")]),e._v(" "),a("span",[e._v(e._s(e.$route.query.grageName+e.$route.query.schoolClassName))]),e._v(" "),a("span",[e._v("班级名册")])]),e._v(" "),a("h3",[a("span",[e._v(e._s("班级人数："+(e.$route.query.totalPeople||"暂无")))]),e._v(" "),a("span",[e._v(e._s("线索人数：暂无"))]),e._v(" "),a("span",[e._v(e._s("注册人数："+(e.$route.query.registerTotalPeople||"暂无")))]),e._v(" "),a("span",[e._v(e._s("在读人数："+(e.$route.query.atSchoolTotalPeople||"暂无")))])])]),e._v(" "),a("ClassRosterTable")],1)}),[],!1,null,"30ee8c53",null));t.default=f.exports},"1c43":function(e,t,a){},"1c69":function(e,t,a){},"1f2b":function(e,t,a){e.exports=a.p+"img/edit-black.0817392e.svg"},"210e":function(e,t,a){"use strict";var n=a("f5af");a.n(n).a},2162:function(e,t,a){"use strict";a("c5f6");var n={name:"sex",props:{sex:Number}},r=(a("c89e"),a("2877")),i=Object(r.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"avatar",class:1===this.sex?"boy":"girl"},[t("div",{staticClass:"sex-name",class:1===this.sex?"boy":"girl"})])}),[],!1,null,"756a5cc5",null);t.a=i.exports},2635:function(e,t,a){"use strict";var n=a("a289");a.n(n).a},2989:function(e,t,a){"use strict";a("097d"),a("c5f6");var n=a("7e65"),r=a("6167"),i={name:"relatedStu",components:{Sex:a("2162").a},props:{cityCode:String,uid:Number,studentId:String},data:function(){return{stuList:[],bindStuParams:{},isBinding:!1}},methods:{getRelatedStu:function(){var e=this;Object(n.s)({areaCode:this.cityCode,pyUid:this.uid,studentId:this.studentId}).then((function(t){e.stuList=t})).catch((function(t){e.$Message.error("查询关联学员错误："+t.message)}))},toStuArchives:function(e){this.$router&&(this.$router.push({name:"applyStuArchivesForMulti",params:{id:e.stuLoginName},query:{card:e.stuLoginName,cityCode:e.areaCode}}),this.$emit("close"))},bind:function(e){var t=this;Object(r.s)({uid:e.pyUid,cityCode:e.areaCode}).then((function(a){a.bindingStatus?(t.bindStuParams=a,t.isBinding=!0,Object(r.f)(t.bindStuParams).then((function(){e.bindStatus=2,t.$Message.success({content:"绑定成功",duration:5}),t.$emit("close")})).catch((function(e){t.$Message.error({content:"绑定失败："+e.message,duration:5})})).finally((function(){t.isBinding=!1}))):t.$Message.warning({content:"查询绑定状态错误：judgeDispatchStudentToSelf返回不可绑定",duration:5})})).catch((function(e){t.$Message.error({content:"查询绑定失败："+e.message,duration:5})}))}},mounted:function(){this.getRelatedStu()}},s=(a("ef29"),a("2877")),o=Object(s.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"related-wrapper"},e._l(e.stuList,(function(t,n){return a("div",{key:t.stuLoginName,staticClass:"item",class:n?"mt10":""},[a("div",{staticClass:"stu-info"},[a("Sex",{attrs:{sex:t.sex}}),e._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[e._v("\n          "+e._s(t.stuRealName||"--")+"  | "+e._s(t.cityName||"--")+" | "+e._s(0===t.readStatus?"未在读":"在读")+"\n        ")]),e._v(" "),a("div",{staticClass:"no"},[e._v("\n          学员编号： "+e._s(t.stuLoginName)+"\n        ")])])],1),e._v(" "),a("div",{staticClass:"option"},[1===t.bindStatus&&e.$store.state.roleRelativeData.userInfo.cityCode===t.areaCode?a("Button",{staticStyle:{"margin-right":"10px"},attrs:{loading:e.isBinding},on:{click:function(a){return e.bind(t)}}},[e._v("绑定")]):e._e(),e._v(" "),e.$store.state.roleRelativeData.userInfo.cityCode===t.areaCode?a("Button",{on:{click:function(a){return e.toStuArchives(t)}}},[e._v("学员档案")]):e._e()],1)])})),0)}),[],!1,null,"21fe435c",null);t.a=o.exports},"2dc58":function(e,t,a){"use strict";var n=a("f068");a.n(n).a},"328a":function(e,t,a){},"33ad":function(e,t,a){"use strict";a.r(t);var n=a("6167"),r={name:"ResourceConfig",data:function(){var e=this;return{cityCode:"",cityList:[{cityName:"南京",cityCode:"025"},{cityName:"郑州",cityCode:"0371"},{cityName:"成都",cityCode:"028"},{cityName:"西安",cityCode:"029"},{cityName:"悦享读",cityCode:"02501"}],advLevelCols:[{title:"顾问等级",key:"level",align:"center"},{title:"服务上限",key:"resourceLimit",align:"center",render:function(t,a){var n=e.advLevelData[a.index];return n.editing?t("InputNumber",{style:{width:"80px"},props:{value:n.resourceLimit},on:{"on-change":function(t){/^[+]?(\d+)$/.test(t)?n.resourceLimit=t:e.$Message.warning({content:"请输入正整数",duration:5})}}}):t("span",n.resourceLimit)}},{title:"分配资源比例",key:"ratio",align:"center",render:function(t,a){var n=e.advLevelData[a.index];return n.editing?t("InputNumber",{style:{width:"80px"},props:{value:n.ratio,autofocus:!0},on:{"on-change":function(t){t>=0&&t<=1?n.ratio=t:e.$Message.warning({content:"请输入0到1之前的数字",duration:5})}}}):t("span",n.ratio)}},{title:"操作",align:"center",render:function(t,a){var r=e.advLevelData[a.index];return t("Button",{props:{type:r.editing?"primary":"warning",size:"small"},on:{click:function(){r.editing?Object(n.T)(r).then((function(){e.$Message.success("更新分校顾问配置成功"),e.$set(r,"editing",!1)})).catch((function(t){e.$Message.error({content:"更新分校顾问配置失败:"+t.message,duration:5})})):e.$set(r,"editing",!0)}}},r.editing?"保存":"编辑")}}],advLevelData:[],advCols:[{title:"顾问姓名",key:"userName",align:"center"},{title:"员工编号",key:"empNo",align:"center"},{title:"等级",key:"level",align:"center",render:function(t,a){var n=e.advData[a.index];return n.editing?t("Select",{style:{width:"80px"},props:{value:n.level,transfer:!0},on:{"on-change":function(e){n.level=e}}},e.levelList.map((function(e){return t("Option",{props:{value:e}},e)}))):t("span",n.level)}},{title:"操作",align:"center",render:function(t,a){var r=e.advData[a.index];return t("Button",{props:{type:r.editing?"primary":"warning",size:"small"},on:{click:function(){r.editing?(r.identityId=void 0,Object(n.U)(r).then((function(){e.$Message.success("更新顾问级别成功"),e.$set(r,"editing",!1)})).catch((function(t){e.$Message.error({content:"更新顾问级别失败:"+t.message,duration:5})}))):e.$set(r,"editing",!0)}}},r.editing?"保存":"编辑")}}],advData:[],levelList:["S","A","B","C","D"]}},methods:{queryAdvLevelConfig:function(){var e=this;Object(n.B)({areaCode:this.cityCode}).then((function(t){e.advLevelData=t})).catch((function(t){e.$Message.error({content:"查询分校顾问配置失败:"+t.message,duration:5})}))},queryAdvConfig:function(){var e=this;Object(n.r)({areaCode:this.cityCode}).then((function(t){e.advData=t})).catch((function(t){e.$Message.error({content:"查询顾问级别列表失败:"+t.message,duration:5})}))},cityChange:function(){this.queryAdvLevelConfig(),this.queryAdvConfig()}},mounted:function(){this.cityCode=this.cityList[0].cityCode,this.cityChange()}},i=a("2877"),s=Object(i.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"10px",width:"100%"}},[a("Row",{staticStyle:{"margin-bottom":"10px"}},[e._v("\n    城市：\n    "),a("Select",{staticStyle:{width:"200px"},on:{"on-change":e.cityChange},model:{value:e.cityCode,callback:function(t){e.cityCode=t},expression:"cityCode"}},e._l(e.cityList,(function(t){return a("Option",{key:t.cityCode,attrs:{value:t.cityCode}},[e._v(e._s(t.cityName))])})),1)],1),e._v(" "),a("Table",{staticStyle:{"margin-bottom":"10px"},attrs:{columns:e.advLevelCols,data:e.advLevelData}}),e._v(" "),a("Table",{attrs:{columns:e.advCols,data:e.advData}})],1)}),[],!1,null,"1d22eafb",null);t.default=s.exports},3482:function(e,t,a){"use strict";var n=a("93bd");a.n(n).a},"34a7":function(e,t,a){"use strict";var n=a("e1db");a.n(n).a},3631:function(e,t,a){"use strict";var n=a("8d8d");a.n(n).a},"3c7c":function(e,t,a){e.exports=a.p+"img/sliver.8489a17f.png"},"3ce3":function(e,t,a){"use strict";a("0d6d");var n=a("7014"),r=a("2801"),i=a("fa7d"),s={name:"classTable",mixins:[n.a,r.a],props:{tableData:{type:Array,default:function(){return[]}},studentDetail:{type:Object,default:function(){return{}}}},data:function(){return{classTypeMap:{1:"在线",2:"双师",4:"面授"},tableColumns:Object.freeze([{title:"报名ID",width:150},{title:"班级名称",width:150},{title:"授课类型"},{title:"学科"},{title:"主讲教师"},{title:"辅导教师"},{title:"上课时间"},{title:"服务中心"},{title:"教室"},{title:"上课进度"},{title:"变动记录"},{title:"总金额"},{title:"书籍费缴费状态",isHk:!0,width:150},{title:"分期类型"},{title:"开课日期"},{title:"结课日期"},{title:"分期课次"},{title:"实缴金额"},{title:"发票状态"}])}},methods:{copy:function(e){Object(i.b)(e)},showColumn:function(e){return!e.isHk||"00852"===this.studentDetail.cityCode},getClasstimeNames:function(e){return e&&e.length>30?e.substring(0,30)+"...":e},getClassChangeName:function(e){return e&&e.length>30?e.substring(0,30)+"...":e},getOperateByStatus:function(e){switch(e){case 0:return{label:"未开发票",view:!1,check:!0};case 1:return{label:"部分已开",view:!0,check:!0};case 2:return{label:"已开发票",view:!0,check:!1};default:return{}}}}},o=a("2877"),l=Object(o.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ivu-table ivu-table-default ivu-table-border relative"},[a("div",{staticClass:"ivu-table-body ivu-table-overflowX"},[a("table",{staticStyle:{width:"100%"},attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[a("thead",[a("tr",{staticClass:"ivu-table-row"},[e._l(e.tableColumns,(function(t,n){return[e.showColumn(t)?a("th",{key:n,staticClass:"ivu-table-column-center",attrs:{width:t.width}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.title))])]):e._e()]}))],2)]),e._v(" "),a("tbody",{staticClass:"ivu-table-tbody"},[e._l(e.tableData,(function(t){return[t.stageList&&t.stageList.length?e._l(t.stageList,(function(n,r){return a("tr",{key:n.id,staticClass:"ivu-table-row"},[0===r?[a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{size:"small",type:"primary",ghost:""},on:{click:function(a){return e.copy(t.registId)}}},[e._v("复制")]),e._v(" "),a("span",[e._v(e._s(t.registId))])],1)]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[a("a",{on:{click:function(a){return e.showClassDetail(t.classId)}}},[e._v(e._s(t.className))]),e._v(" "),1===t.businessType?a("div",{staticStyle:{"text-align":"right",display:"inline-block"}},[a("Tag",{attrs:{color:"green"}},[e._v("全国班")])],1):e._e(),e._v(" "),3==t.orderType?a("div",{staticStyle:{"text-align":"right",display:"inline-block"}},[a("Tag",{attrs:{type:"border",color:"warning"}},[e._v("拼团")])],1):e._e()])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(e.classTypeMap[t.classType]))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.subjectNames))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._l(t.teacherNames.split(","),(function(n,r){return[a("a",{key:n,on:{click:function(a){e.showTeacherDetail(e.studentDetail.bindingCode,t.teacherIds.split(",")[r])}}},[e._v(e._s(n))]),e._v(" "),r!=t.teacherNames.split(",").length-1?[e._v("\n                      ,\n                      "),a("br",{key:r})]:e._e()]}))],2)]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.tutorRealName))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[a("Poptip",{attrs:{trigger:"hover",width:"300","word-wrap":"",content:t.classtimeNames,transfer:""}},[e._v(e._s(e.getClasstimeNames(t.classtimeNames)))])],1)]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.serviceCenterName))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.classroomName))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.passedCount+"/"+t.classCount))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[1!=t.businessType?a("div",{staticClass:"ivu-table-cell"},[a("Poptip",{attrs:{trigger:"hover",width:"300","word-wrap":"",content:t.classChangeName,transfer:""}},[e._v(e._s(e.getClassChangeName(t.classChangeName)))])],1):e._e(),e._v(" "),1==t.businessType?a("div",{staticClass:"ivu-table-cell"},[e._v("——")]):e._e()]),e._v(" "),a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.price))])]),e._v(" "),"00852"===e.studentDetail.cityCode?a("td",{staticClass:"ivu-table-column-center",attrs:{rowspan:t.stageList.length}},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(e.getClassPayStatus(t.bookFeePayStatus)))])]):e._e()]:e._e(),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(n.stagesName))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(n.startCurriculumTime))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(n.endCurriculumTime))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[n.startCurriculumNum&&n.endCurriculumNum?a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(n.startCurriculumNum+"-"+n.endCurriculumNum))]):e._e()]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(n.paidAmount))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[a("span",[e._v(e._s(e.getOperateByStatus(n.invoiceStatus).label))])])])],2)})):e._e()]}))],2)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.tableData.length,expression:"!tableData.length"}]},[e._m(0)]),e._v(" "),a("tal-class-detail",{attrs:{"class-id":e.classDetail.id,show:e.classDetail.show},on:{close:function(t){e.classDetail.show=!1}}}),e._v(" "),a("tal-teacher-details",{ref:"teacherRef",attrs:{schoolCode:e.teacherDetail.cityCode,teacherId:e.teacherDetail.id,type:e.teacherDetail.type,stuId:e.studentDetail.studentId,stuSchoolCode:e.studentDetail.cityCode,creatorEmpNo:e.teacherDetail.empNo}})],1)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticStyle:{"text-align":"center","line-height":"50px",width:"100%"}},[t("span",[this._v("暂无数据")])])}],!1,null,"8cd4a31a",null);t.a=l.exports},"3d11":function(e,t,a){"use strict";a.r(t);var n,r,i,s,o=a("75fc"),l=(a("f751"),a("ac6a"),a("96cf"),a("3b8d")),c=(a("0d6d"),a("d4be")),u=a("7e65"),d=a("49e5"),p={name:"incompleteInfoUsers",data:function(){return{tableColumns:Object.freeze([{title:"电话号码",width:"25%"},{title:"注册时间",width:200},{title:"分配时间",width:200},{title:"操作",width:200},{title:"checkbox",isCheckBox:!0,width:150}]),tableData:[],checkAllGroup:[],allItem:[],checkAll:!1,pageTotal:0,currentPageSize:10,currentPageNum:1,status:1,tableLoading:!1,addStudentModal:!1,addStudentForm:{}}},mounted:function(){this.allItem=[123,456,789],this.getTableData()},methods:{changePage:function(e){this.currentPageNum=e,this.getTableData()},pageSizeChange:function(e){this.currentPageNum=1,this.currentPageSize=e,this.getTableData()},getTableData:(s=Object(l.a)(regeneratorRuntime.mark((function e(){var t,a,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tableLoading=!0,this.tableData=[],this.checkAllGroup=[],this.checkAll=!1,t={pageNo:this.currentPageNum,pageSize:this.currentPageSize,status:this.status},e.prev=5,e.next=8,Object(u.r)(t);case 8:a=e.sent,n=[],a.records.forEach((function(e){r.getOperateByStatus(e.status).select&&n.push(e.uid),e.label=e.uid,e.isFullPhone=!1,e.fullPhone=""})),this.tableData=a.records,this.allItem=Object.freeze(n),this.pageTotal=a.totalCount,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),this.tableData=[],this.$Message.error({content:"获取数据失败:"+e.t0.message,duration:5});case 20:this.tableLoading=!1;case 21:case"end":return e.stop()}}),e,this,[[5,16]])}))),function(){return s.apply(this,arguments)}),toggleMobile:(i=Object(l.a)(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isFullPhone=!t.isFullPhone,!t.fullPhone){e.next=3;break}return e.abrupt("return");case 3:return a={uid:t.uid,encodePhone:t.phone},e.prev=4,e.next=7,Object(c.a)(a);case 7:n=e.sent,t.fullPhone=n,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),this.$Message.error({content:"手机号解码失败:"+e.t0.message,duration:5});case 14:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e){return i.apply(this,arguments)}),getStudentForm:function(){return{realName:"测试宁宁",callCenterEmpNo:"",name:"",sex:1,gradeId:"",gradeTypeId:"",areaCode:"010",birthday:"",provinceId:"110000",provinceName:"北京市",cityId:"110100",cityName:"北京",cityCode:"010",uid:"2347796",attentionReqList:[{tel:"15631778927",typeId:7,typeName:"本人"}],recipientReqList:[]}},onCompleteSuccess:function(){this.addStudentModal=!1,this.$Message.success({content:"完善信息成功",duration:5}),this.getTableData()},updateStudentInfo:(r=Object(l.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.c)({uid:t});case 3:if((a=e.sent).isComplete){e.next=7;break}return e.abrupt("return",this.$Message.warning({content:"该学员已完善信息",duration:5}));case 7:this.addStudentForm=Object.assign({},a,{cityCode:a.cityId}),this.addStudentModal=!0,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.$Message.error({content:"获取学员信息失败:"+e.t0.message,duration:5});case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e){return r.apply(this,arguments)}),checkAllHandler:function(){this.checkAll=!this.checkAll,this.checkAll?this.checkAllGroup=Object(o.a)(this.allItem):this.checkAllGroup=[]},handleCheckGroupChange:function(){this.checkAllGroup.length===this.allItem.length?this.checkAll=!0:this.checkAll=!1},quiteFollow:function(){var e=this;if(!this.checkAllGroup.length)return this.$Message.warning({content:"请先选择数据",duration:5});this.$Modal.confirm({title:"确认放弃跟进已选学员？",content:"",onOk:function(){e.giveUpFollowUp()}})},giveUpFollowUp:(n=Object(l.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.checkAllGroup.join(","),e.prev=1,e.next=4,Object(u.p)({pyUids:t});case 4:this.$Message.success({content:"已放弃跟进",duration:5}),this.getTableData(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.$Message.error({content:"放弃跟进失败："+e.t0.message,duration:5});case 11:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(){return n.apply(this,arguments)}),getOperateByStatus:function(e){switch(e){case 0:return{complete:!1,select:!1};case 1:case 2:return{complete:!0,select:!0};case 3:return{complete:!0,select:!1};default:return{complete:!0,select:!0}}}}},m=(a("000d"),a("2877")),f=Object(m.a)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"20px",width:"100%"}},[a("Button",{staticStyle:{float:"right"},on:{click:e.quiteFollow}},[e._v("放弃跟进")]),e._v(" "),a("div",{staticClass:"ivu-table ivu-table-default ivu-table-border relative",staticStyle:{"margin-top":"20px"}},[e.tableLoading?a("Spin",{attrs:{size:"large",fix:""}}):e._e(),e._v(" "),a("CheckboxGroup",{staticStyle:{"font-size":"12px"},on:{"on-change":e.handleCheckGroupChange},model:{value:e.checkAllGroup,callback:function(t){e.checkAllGroup=t},expression:"checkAllGroup"}},[a("table",{staticStyle:{width:"100%"},attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[a("thead",[a("tr",{staticClass:"ivu-table-row"},e._l(e.tableColumns,(function(t,n){return a("th",{key:n,staticClass:"ivu-table-column-center",attrs:{width:t.width}},[t.isCheckBox?[a("label",{staticClass:"tal-ipt-checkbox",staticStyle:{"margin-left":"0"}},[a("input",{staticClass:"ivu-checkbox-inner",staticStyle:{"margin-left":"-9px"},attrs:{type:"checkbox"},domProps:{checked:e.checkAll},on:{click:e.checkAllHandler}}),e._v(" "),a("span")])]:a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.title))])],2)})),0)]),e._v(" "),a("tbody",{staticClass:"ivu-table-tbody"},e._l(e.tableData,(function(t,n){return a("tr",{key:n,staticClass:"ivu-table-row"},[a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[a("span",{staticStyle:{display:"inline-block",width:"90px"}},[e._v(e._s(t.isFullPhone?t.fullPhone:t.phone))]),e._v(" "),t.isFullPhone?a("Icon",{staticStyle:{"margin-left":"20px"},attrs:{type:"md-eye-off"},on:{click:function(a){return e.toggleMobile(t)}}}):a("Icon",{staticStyle:{"margin-left":"20px"},attrs:{type:"md-eye"},on:{click:function(a){return e.toggleMobile(t)}}})],1)]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.addTime))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.createTime))])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[e.getOperateByStatus(t.status).complete?a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(a){return e.updateStudentInfo(t.uid)}}},[e._v("完善信息")]):e._e()])]),e._v(" "),a("td",{staticClass:"ivu-table-column-center"},[a("div",{staticClass:"ivu-table-cell"},[e.getOperateByStatus(t.status).select?a("Checkbox",{attrs:{label:t.label}},[e._v(e._s(""))]):e._e()],1)])])})),0)])]),e._v(" "),e.tableData.length?e._e():a("p",{staticStyle:{"text-align":"center"}},[e._v("暂无数据")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.tableLoading,expression:"!tableLoading"}],class:{"page-fix":e.tableData.length<3},staticStyle:{margin:"10px"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.pageTotal,"page-size":e.currentPageSize,current:e.currentPageNum,"page-size-opts":[10,20],"show-elevator":"","show-sizer":"","show-total":""},on:{"on-page-size-change":e.pageSizeChange,"on-change":e.changePage}})],1)])],1),e._v(" "),a("Modal",{staticClass:"modal-height1",attrs:{"mask-closable":!1,"footer-hide":!0,title:"完善信息",width:"960px"},model:{value:e.addStudentModal,callback:function(t){e.addStudentModal=t},expression:"addStudentModal"}},[e.addStudentModal?a("tal-student-complete",{attrs:{formData:e.addStudentForm},on:{close:function(t){e.addStudentModal=!1},success:e.onCompleteSuccess}}):e._e()],1)],1)}),[],!1,null,"77d65350",null);t.default=f.exports},4089:function(e,t,a){"use strict";a.r(t);a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("7f7f"),a("0d6d"),a("f751"),a("96cf");var n,r,i=a("3b8d"),s=(a("386d"),a("ac6a"),a("c5f6"),a("6b54"),a("6167")),o={props:{hasAll:{type:Boolean,default:!1},initValue:{type:String,default:""}},data:function(){return{typeList:[],grade:""}},watch:{initValue:function(e){this.grade=e}},mounted:function(){this.getTypeList()},methods:{changTaskType:function(e){this.$emit("getTaskType",e)},getTypeList:(n=Object(i.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.d)();case 2:(t=e.sent)&&t.length>0&&this.hasAll&&(t=[{typeId:"",typeName:"全部"}].concat(t)),this.typeList=Object.freeze(t)||[];case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}},l=a("2877"),c=Object(l.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{size:"small",placeholder:"请选择"},on:{change:e.changTaskType},model:{value:e.grade,callback:function(t){e.grade=t},expression:"grade"}},e._l(e.typeList,(function(e){return a("el-option",{key:e.typeId,attrs:{label:e.typeName,value:String(e.typeId)}})})),1)}),[],!1,null,"7db92506",null).exports,u=a("867e"),d={props:{hasAll:{type:Boolean,default:!1},initValue:{type:String,default:""}},data:function(){return{gradeList:[],grade:""}},watch:{initValue:function(e){this.grade=e}},mounted:function(){this.getGradeList()},methods:{changGrade:function(e){this.$emit("getGrade",e)},getGradeList:(r=Object(i.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(u.u)();case 3:(t=e.sent)&&t.length>0&&this.hasAll&&(t=[{id:"",name:"全部"}].concat(t)),this.gradeList=Object.freeze(t)||[],e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$Message.error({content:"获取权限列表失败："+e.t0.message});case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return r.apply(this,arguments)})}},p=Object(l.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{size:"small",placeholder:"请选择"},on:{change:e.changGrade},model:{value:e.grade,callback:function(t){e.grade=t},expression:"grade"}},e._l(e.gradeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:String(e.id)}})})),1)}),[],!1,null,"2bdc95c6",null).exports,m=a("0ef6"),f={mixins:[m.a],props:{tableData:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:function(){return!1}}},data:function(){return{}},methods:{}},h=Object(l.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"stuLoginName",label:"学员编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.goCustomerDetail(t.row)}}},[e._v(e._s(t.row.stuRealName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"stuGradeName",label:"当前年级",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"closeTaskCount",label:"关闭任务数",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"allTask",label:"任务类型",width:"230",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e._v("\n        "+e._s(t.row.allTask)+"\n      ")]),e._v(" "),a("div"),e._v(" "),1===t.row.isStudentDiagnosis?a("Button",{attrs:{type:"primary",ghost:"",size:"small"},on:{click:function(a){return e.emitClickHandle("diagnosis",t.row.taskList)}}},[e._v("诊断报告")]):e._e(),e._v(" "),1===t.row.isStuHasReg?a("Button",{attrs:{type:"primary",ghost:"",size:"small"},on:{click:function(a){return e.emitClickHandle("class-info",t.row)}}},[e._v("报班信息")]):e._e(),e._v(" "),1===t.row.isStuHasWait?a("Button",{attrs:{type:"primary",ghost:"",size:"small"},on:{click:function(a){return e.emitClickHandle("backup-record",t.row)}}},[e._v("候补记录")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"firstStartTimeStr",label:"开始计时时间",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTimeStr",label:"维护时间",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"avgReactionCostStr",label:"响应时长",align:"center"}})],1)}),[],!1,null,null,null).exports,g={mixins:[m.a],props:{tableData:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:function(){return!1}}},data:function(){return{}},methods:{}},v=Object(l.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"stuLoginName",label:"学员编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.goCustomerDetail(t.row)}}},[e._v(e._s(t.row.stuRealName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"stuGradeName",label:"当前年级",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"planContent",label:"预约维护内容",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"planTimeStr",label:"预约时间",width:"200",align:"center"}})],1)}),[],!1,null,null,null).exports,b=a("3ce3"),y=a("2989"),w={mixins:[m.a],components:{ClassTable:b.a,RelatedAccount:y.a},props:{tableData:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:function(){return!1}}},data:function(){return{studentDetail:{},keyActionModal:!1,actionData:{},cubeCols:[{title:"活动名称",align:"center",key:"activityName"},{title:"活动类型",align:"center",key:"type"},{title:"活动URL",align:"center",slot:"url"}],cubeData:[],row:{},showRelatedStu:!1}},methods:{showKeyAction:function(e){var t=this;this.studentDetail.cityCode=e.areaCode,this.studentDetail.studentId=e.studentId,Object(s.N)({studentId:e.studentId,pyUid:e.stuUid,uid:e.stuUid,mode:4,cityCode:e.areaCode}).then((function(e){t.actionData=e,t.keyActionModal=!0})).catch((function(e){t.$Message.error("查询关键行为错误："+e.message)}))},openRelatedStu:function(e){this.row=e,this.showRelatedStu=!0}}},k=Object(l.a)(w,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"stuLoginName",label:"学员编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.goCustomerDetail(t.row)}}},[e._v(e._s(t.row.stuRealName))]),e._v(" "),1===Number(t.row.isRelateAccount)?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.openRelatedStu(t.row)}}},[e._v("其他关联账号")]):e._e(),e._v(" "),1===Number(t.row.activityStatus)?a("el-tag",{attrs:{type:"warning",size:"small"}},[e._v("老带新")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"渠道",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.stuRegistName)+" ")]),e._v(" "),t.row.sceneMessage?a("span",[e._v(e._s(t.row.sceneMessage.sceneType)+" / "+e._s(t.row.sceneMessage.secondaryType)+" / "+e._s(t.row.sceneMessage.activityName))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"stuGradeName",label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.diagnosisTaskContains?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return e.emitClickHandle("follow-diagnosis",t.row)}}},[e._v("散诊任务跟进")]):e._e(),e._v(" "),1===t.row.auditionsTaskContains?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return e.emitClickHandle("follow-audition",t.row)}}},[e._v("试听任务跟进")]):e._e(),e._v(" "),1===t.row.isStudentDiagnosis?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return e.emitClickHandle("diagnosis",t.row.taskList)}}},[e._v("诊断报告")]):e._e(),e._v(" "),1===t.row.isStuHasReg?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return e.emitClickHandle("class-info",t.row)}}},[e._v("报班信息")]):e._e(),e._v(" "),1===t.row.isStuHasWait?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return e.emitClickHandle("backup-record",t.row)}}},[e._v("候补记录")]):e._e(),e._v(" "),1===t.row.isStuFollowUp?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return e.showKeyAction(t.row)}}},[e._v("关键行为")]):e._e(),e._v(" "),1===t.row.auditionApplyFollow?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return e.emitClickHandle("apply",t.row)}}},[e._v("试听申请跟进")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"stuGradeName",label:"当前年级",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"registCity",label:"注册城市",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"allTask",label:"任务类型",width:"230",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"taskNum",label:"待维护任务数",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"followNum",label:"维护次数",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"earlistPopTime",label:"最早任务弹出时间",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"reactionStartTime",label:"任务开始计时时间",align:"center"}})],1),e._v(" "),a("Modal",{attrs:{title:"关键信息",width:"80%","mask-closable":!1,"footer-hide":!0},model:{value:e.keyActionModal,callback:function(t){e.keyActionModal=t},expression:"keyActionModal"}},[e.actionData.activityClassList&&e.actionData.activityClassList.length?a("div",[a("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("活动类")]),e._v(" "),a("class-table",{attrs:{"student-detail":e.studentDetail,"table-data":e.actionData.activityClassList}})],1):e._e(),e._v(" "),e.actionData.shortTermClassList&&e.actionData.shortTermClassList.length?a("div",[a("h3",{staticStyle:{margin:"10px 0"}},[e._v("短期班")]),e._v(" "),a("class-table",{attrs:{"student-detail":e.studentDetail,"table-data":e.actionData.shortTermClassList}})],1):e._e(),e._v(" "),e.actionData.mofangActivityList&&e.actionData.mofangActivityList.length?a("div",[a("h3",{staticStyle:{margin:"10px 0"}},[e._v("魔方活动")]),e._v(" "),a("Table",{attrs:{columns:e.cubeCols,data:e.actionData.mofangActivityList},scopedSlots:e._u([{key:"url",fn:function(t){var n=t.row;return[a("a",{attrs:{href:n.url,target:"_blank"}},[e._v(e._s(n.url))])]}}],null,!1,2361283530)})],1):e._e()]),e._v(" "),a("Modal",{attrs:{"mask-closable":!1,title:"与用户注册手机号关联的其他账号",width:"560","footer-hide":!0},model:{value:e.showRelatedStu,callback:function(t){e.showRelatedStu=t},expression:"showRelatedStu"}},[e.showRelatedStu?a("RelatedAccount",{attrs:{"city-code":e.row.areaCode,uid:e.row.stuUid,"student-id":e.row.studentId},on:{close:function(t){e.showRelatedStu=!1}}}):e._e()],1)],1)}),[],!1,null,null,null).exports,_={mixins:[m.a],name:"giftTask",props:{tableData:Array,loading:{type:Boolean,default:function(){return!1}}},methods:{pickGift:function(e,t){var a=this;2!==t||0!==e.firstGiftReceived?3!==t||0!==e.secondGiftReceived?this.$Modal.confirm({title:"领取确认",content:"是否确认领取？",onOk:function(){Object(s.S)({id:e.id,firstGiftReceived:1===t?1:0,secondGiftReceived:2===t?1:0,thirdGiftReceived:3===t?1:0}).then((function(e){1===e?(a.$Message.success({content:"领取成功",duration:5}),a.$emit("pickGiftSuccess")):a.$Message.error({content:"领取失败",duration:5})})).catch((function(e){a.$Message.error({content:"领取失败："+e.message,duration:5})}))}}):this.$Message.warning({content:"请先领取二重礼品",duration:5}):this.$Message.warning({content:"请先领取一重礼品",duration:5})}}},D=Object(l.a)(_,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"stuLoginName",label:"学员编号",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"学员姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.goCustomerDetail(t.row)}}},[e._v(e._s(t.row.stuName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"电话号码",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("TalDecodeText",{attrs:{type:"phone",uid:e.row.pyUid,encodeText:e.row.phone}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"isNew",label:"用户类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n      "+e._s(t.row.isNew?"新":"老")+"学员\n    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"attendTime",label:"扫码时间",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"一重礼品",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.firstGiftReceived?a("el-button",{attrs:{type:"primary",size:"mini",disabled:""}},[e._v("已领取")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.pickGift(t.row,1)}}},[e._v("待领取")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"二重礼品",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.secondGiftReceived?a("el-button",{attrs:{type:"primary",size:"mini",disabled:""}},[e._v("已领取")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.pickGift(t.row,2)}}},[e._v("待领取")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"三重礼品",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.thirdGiftReceived?a("el-button",{attrs:{type:"primary",size:"mini",disabled:""}},[e._v("已领取")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.pickGift(t.row,3)}}},[e._v("待领取")])]}}])})],1)}),[],!1,null,"882c20f6",null).exports,C=a("46a8"),S=a("733e"),x=a("49e5"),T=a("7665"),I=a("c3a7"),N=a("c7d4"),O=a("efbf"),L=a("7f4db"),R=a("a78e"),j=a.n(R);function M(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $(e,t)}(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var A=function(e){return(e=e.toString())[1]?e:"0"+e},P=function(e,t){return e?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",a=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),s=e.getMinutes(),o=e.getSeconds();return[a,n,r].map(A).join(t)+" "+[i,s,o].map(A).join(":")}(new Date(Number(1e3*e)),t):""},F=function(e){var t=parseInt(e),a=0,n=0;t>60&&(a=parseInt(t/60),t=parseInt(t%60),a>60&&(n=parseInt(a/60),a=parseInt(a%60)));var r=parseInt(t)+"秒";return a>0&&(r=parseInt(a)+"分"+r),n>0&&(r=parseInt(n)+"小时"+r),r};function z(e,t){if(1===Number(t)){var a,n=M(e);try{var r=function(){var e=a.value,t="",n=0,r=0,i=0;e.taskList&&e.taskList.forEach((function(e,a){t+=e.taskName+",",n++,(0===r||r>e.createTime)&&(r=e.createTime),(0===i||i>e.reactionStartTime)&&(i=e.reactionStartTime)})),e.allTask=t.substr(0,t.length-1),e.taskNum=n,e.earlistPopTime=P(r,"-"),e.reactionStartTime=P(i,"-")};for(n.s();!(a=n.n()).done;)r()}catch(e){n.e(e)}finally{n.f()}}else if(2===Number(t)){var i,s=M(e);try{for(s.s();!(i=s.n()).done;){var o=i.value;o.planTimeStr=P(o.planTime,"-")}}catch(e){s.e(e)}finally{s.f()}}else if(3===Number(t)){var l,c=M(e);try{for(c.s();!(l=c.n()).done;){var u=l.value,d="";u.taskList&&u.taskList.forEach((function(e,t){d+=e.taskName+","})),u.allTask=d.substr(0,d.length-1),u.firstStartTimeStr=P(u.firstStartTime,"-"),u.createTimeStr=P(u.createTime,"-"),u.avgReactionCostStr=F(u.avgReactionCost)}}catch(e){c.e(e)}finally{c.f()}}return e}var E,H,B,q,W,V,U,G={name:"consultstask",components:{radioTaskType:c,radioGrade:p,toFollowTaskTable:k,followRecordTable:h,bookTaskTable:v,FllowDiagnosisRecord:C.a,FollowRecord:O.a,GiftTaskTable:D,AuditionFollowRecord:L.a},data:function(){return{input:"",activeName:"0",tableListZero:[],tableListOne:[],tableListTwo:[],tableListThree:[],pageNo:1,select:"stuMobile",pageSize:40,totalArr:{0:0,1:0,2:0,3:0},params:{type:1,taskType:"",stuGradeId:"",stuLoginName:"",stuMobile:"",stuRealName:"",pageSize:40,pageNo:1},searching:!1,diagnosisModal:!1,diagnosisColumns:[{type:"index",width:30,align:"center"},{title:"城市",key:"cityName",align:"center"},{title:"年级",key:"gradeName",align:"center"},{title:"学科",key:"subjectName",align:"center"},{title:"学期",key:"termName",align:"center"},{title:"学员编号",key:"stuCode",align:"center",width:100},{title:"学员姓名",key:"stuName",align:"center"},{title:"分数",key:"score",align:"center"},{title:"班次级别",key:"levelDegreeName",align:"center"},{title:"班次名称",key:"levelName",align:"center"},{title:"报告URL",slot:"reportUrl",align:"center",width:130},{title:"成绩来源",key:"sourceTypeName",align:"center"},{title:"班次生效时间",key:"effectiveClaLevelTime",align:"center"},{title:"成绩是否有效",slot:"isValid",align:"center"},{title:"成绩是否用于报班",slot:"forRegist",align:"center"},{title:"作答时间",key:"answerDateTime",align:"center",width:130}],diagnosisData:[],stuInfo:{studentId:"",cityCode:"",bindingCode:""},showBackupRecordModal:!1,showNoPaymentModal:!1,showDiagnosisFllowModal:!1,showAuditionFollowModal:!1,showAuditionApplyFollowModal:!1,stuDetail:{},followDiagnosisArr:[],followAuditionArr:[],followApplyArr:[],activeTabId:""}},mounted:function(){this.search()},methods:{handleFollowAuditionRecordSuccess:function(e){this.$refs[e][0].refresh()},handleFollowAuditionTabsClick:function(e){this.followAuditionArr.forEach((function(t){t.id===e&&(t.init=!0)}))},followAuditionHandle:(U=Object(i.a)(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stuDetail={realName:t.stuRealName,gradeName:t.stuGradeName,card:t.stuLoginName,cityCode:t.areaCode,areaCode:t.areaCode,uid:t.stuUid},e.prev=1,e.next=4,Object(I.c)({pyUid:t.stuUid,operationType:1});case 4:if((a=(a=e.sent).map((function(e,t){return 0===t?(n.activeTabId=e.id,Object.assign(e,{init:!0})):Object.assign(e,{init:!1})})))&&0!==a.length){e.next=9;break}return this.$Message.info({content:"试听任务已全部处理"}),e.abrupt("return");case 9:this.followAuditionArr=a,this.showAuditionFollowModal=!0,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),this.$Message.error({content:e.t0.message,duration:5});case 16:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e){return U.apply(this,arguments)}),handleFollowApplyTabsClick:function(e){this.followApplyArr.forEach((function(t){t.id===e&&(t.init=!0)}))},auditionApplyHandle:(V=Object(i.a)(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(N.c)({pyUid:t.stuUid,empNo:JSON.parse(j.a.get("columbusUserInfo")).id});case 3:if((a=(a=e.sent).appointmentList.map((function(e,t){return 0===t?(n.activeTabId=e.id,Object.assign(e,{init:!0})):Object.assign(e,{init:!1})})))&&0!==a.length){e.next=8;break}return this.$Message.info({content:"试听任务已全部处理"}),e.abrupt("return");case 8:this.followApplyArr=a,this.showAuditionApplyFollowModal=!0,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.$Message.error({content:e.t0.message,duration:5});case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return V.apply(this,arguments)}),handleFollowDiagnosisRecordSuccess:function(e){this.$refs[e][0].refresh()},handleFollowDiagnosisTabsClick:function(e){this.followDiagnosisArr.forEach((function(t){t.id===e&&(t.init=!0)}))},followDiagnosisHandle:(W=Object(i.a)(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stuDetail={realName:t.stuRealName,gradeName:t.stuGradeName,card:t.stuLoginName,cityCode:t.areaCode,areaCode:t.areaCode,uid:t.stuUid},e.prev=1,e.next=4,Object(T.h)({pyUid:t.stuUid});case 4:(a=e.sent).forEach((function(e,t){0===t?(n.activeTabId=e.id,e.init=!0):e.init=!1})),this.followDiagnosisArr=a,this.showDiagnosisFllowModal=!0,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),this.$Message.error({content:e.t0.message,duration:5});case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return W.apply(this,arguments)}),classInfoHandle:function(e){var t=this,a={cityCode:e.areaCode,uid:e.stuUid};Object(x.b)(a).then((function(a){t.stuInfo={cityCode:e.cityCode,studentId:a.studentId,bindingCode:a.bindingCode},t.showNoPaymentModal=!0})).catch((function(e){t.$Message.error({content:"获取学员信息失败: "+e.message,duration:5})}))},backupRecordHandle:function(e){var t=this,a={cityCode:e.areaCode,uid:e.stuUid};Object(x.b)(a).then((function(a){t.stuInfo={cityCode:e.cityCode,studentId:a.studentId,bindingCode:a.bindingCode},t.showBackupRecordModal=!0})).catch((function(e){t.$Message.error({content:"获取学员信息失败: "+e.message,duration:5})}))},search:function(){this.searching=!0,this.params.stuMobile="",this.params.stuRealName="",this.params.stuLoginName="",this.params[this.select]=this.input,"0"===this.activeName?this.queryGiftActivityListHandler(this.params):"1"===this.activeName?(this.params.type=1,this.advisorTaskListHandler(this.params)):"2"===this.activeName?(this.params.type=2,this.advisorPlanListHandler(this.params)):"3"===this.activeName&&(this.params.type=3,this.advisorFollowDetailListHandler(this.params))},queryGiftActivityListHandler:(q=Object(i.a)(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=this.$store.state.roleRelativeData.userInfo,t.stuName=t.stuRealName,t.areaCode=a.cityCode,t.deptCode=a.baseDataId,e.next=7,Object(s.G)(t);case 7:n=e.sent,this.tableListZero=Object.freeze(n.records)||[],this.totalArr[0]=n.totalCount,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.$Message.error({content:"获取新店礼品任务失败："+e.t0.message});case 15:return e.prev=15,this.searching=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[0,12,15,18]])}))),function(e){return q.apply(this,arguments)}),advisorTaskListHandler:(B=Object(i.a)(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s.c)(t);case 3:a=e.sent,this.tableListOne=Object.freeze(z(a.list,this.params.type))||[],this.totalArr[1]=a.total,n=parseInt(Date.now()/1e3),r={mytaskNewstudent:n,mytaskConsultstask:n},S.a.set("lastVisitedTime",r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.$Message.error({content:"获取待维护列表失败："+e.t0.message});case 14:return e.prev=14,this.searching=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[0,11,14,17]])}))),function(e){return B.apply(this,arguments)}),advisorPlanListHandler:(H=Object(i.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s.b)(t);case 3:a=e.sent,this.tableListTwo=Object.freeze(z(a.list,this.params.type))||[],this.totalArr[2]=a.total,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$Message.error({content:"获取预约任务列表失败："+e.t0.message});case 11:return e.prev=11,this.searching=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,8,11,14]])}))),function(e){return H.apply(this,arguments)}),advisorFollowDetailListHandler:(E=Object(i.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s.a)(t);case 3:a=e.sent,this.tableListThree=Object.freeze(z(a.list,this.params.type))||[],this.totalArr[3]=a.total,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$Message.error({content:"获取维护记录列表失败："+e.t0.message});case 11:return e.prev=11,this.searching=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,8,11,14]])}))),function(e){return E.apply(this,arguments)}),getTaskType:function(e){this.params.taskType=e},getGrade:function(e){this.params.stuGradeId=e},selectTab:function(e){for(var t in this.pageNo=1,this.pageSize=40,this.totalArr)this.totalArr[t]=0;this.tableListOne=[],this.tableListTwo=[],this.tableListThree=[],this.params.pageNo=1,this.params.pageSize=40,this.params.taskType="",this.params.stuGradeId="",this.params.type=parseInt(e),this.input="",this.select="stuMobile",this.search()},handleSizeChange:function(e){this.params.pageSize=e,this.params.pageNo=1,this.pageSize=e,this.pageNo=1,this.search()},handleCurrentChange:function(e){this.params.pageNo=e,this.pageNo=e,this.search()},diagnosisHandle:function(e){var t=this;try{var a=[];e.forEach((function(e){a.push(e.taskId)})),this.diagnosisData=[],this.$nextTick(Object(i.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.L)(a);case 2:n=e.sent,t.diagnosisData=Object.freeze(n),t.diagnosisModal=!0;case 5:case"end":return e.stop()}}),e)}))))}catch(e){this.$Message.error({content:"获取诊断报告失败："+e.message})}}}},K=(a("0d3f"),Object(l.a)(G,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",{staticClass:"content-data mytask-consultstask"},[a("div",{staticClass:"content-data-card"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"快速搜索:"}},[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"240px"},attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("el-select",{staticStyle:{width:"110px"},attrs:{slot:"append",size:"small",placeholder:"请选择"},slot:"append",model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},[a("el-option",{attrs:{label:"手机号",value:"stuMobile"}}),e._v(" "),a("el-option",{attrs:{label:"姓名",value:"stuRealName"}}),e._v(" "),a("el-option",{attrs:{label:"学员编号",value:"stuLoginName"}})],1)],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"0"!==e.activeName,expression:"activeName !== '0'"}],attrs:{label:"当前年级:"}},[a("radioGrade",{staticClass:"radio-grade",attrs:{"has-all":!0,"init-value":String(e.params.stuGradeId)},on:{getGrade:e.getGrade}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"1"===e.activeName,expression:"activeName === '1'"}],attrs:{label:"任务类型:"}},[a("radioTaskType",{staticClass:"radio-city",attrs:{"has-all":!0,"init-value":String(e.params.taskType)},on:{getTaskType:e.getTaskType}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",disabled:e.searching},on:{click:e.search}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"noticeTooltip"},[a("Alert",{attrs:{type:"warning","show-icon":""}},[e._v("“任务管理功能”即将下线，后续请前往“资源管理 - 任务工作台”菜单下维护任务，避免“任务时长”统计异常")])],1)],1),e._v(" "),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.selectTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"0",label:"到店领礼品任务"}},[a("GiftTaskTable",{attrs:{loading:e.searching,"table-data":e.tableListZero},on:{pickGiftSuccess:e.search}})],1),e._v(" "),a("el-tab-pane",{attrs:{name:"1",label:"待维护任务"}},[a("toFollowTaskTable",{attrs:{loading:e.searching,"table-data":e.tableListOne},on:{diagnosis:e.diagnosisHandle,"class-info":e.classInfoHandle,"backup-record":e.backupRecordHandle,"follow-diagnosis":e.followDiagnosisHandle,"follow-audition":e.followAuditionHandle,apply:e.auditionApplyHandle}})],1),e._v(" "),a("el-tab-pane",{attrs:{name:"2",label:"预约任务"}},[a("bookTaskTable",{attrs:{loading:e.searching,"table-data":e.tableListTwo}})],1),e._v(" "),a("el-tab-pane",{attrs:{name:"3",label:"维护记录"}},[a("followRecordTable",{attrs:{loading:e.searching,"table-data":e.tableListThree},on:{diagnosis:e.diagnosisHandle,"class-info":e.classInfoHandle,"backup-record":e.backupRecordHandle,apply:e.auditionApplyHandle}})],1)],1),e._v(" "),a("div",{staticClass:"pagination-basic"},[a("el-pagination",{attrs:{"current-page":e.pageNo,"page-sizes":[10,20,30,40],"page-size":e.pageSize,total:e.totalArr[e.activeName],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("Modal",{attrs:{"mask-closable":!1,"footer-hide":!0,title:"诊断报告",width:"1060px"},model:{value:e.diagnosisModal,callback:function(t){e.diagnosisModal=t},expression:"diagnosisModal"}},[a("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:e.diagnosisColumns,data:e.diagnosisData},scopedSlots:e._u([{key:"isValid",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(1===n.isValid?"有效":"无效"))])]}},{key:"forRegist",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(1===n.forRegist?"是":"否"))])]}},{key:"reportUrl",fn:function(t){var n=t.row;return[a("Button",{attrs:{ghost:"",type:"primary",size:"small",to:n.reportUrl,target:"_blank"}},[e._v("点击查看")])]}}])})],1),e._v(" "),a("Modal",{attrs:{title:"报名未缴费记录",width:"80%","mask-closable":!1,"footer-hide":!0},model:{value:e.showNoPaymentModal,callback:function(t){e.showNoPaymentModal=t},expression:"showNoPaymentModal"}},[e.showNoPaymentModal?a("TalNotPaymentModal",{attrs:{studentDetail:e.stuInfo,isTaskMode:!0},on:{close:function(t){e.showNoPaymentModal=!1}}}):e._e()],1),e._v(" "),a("Modal",{attrs:{title:"候补记录",width:"80%","mask-closable":!1,"footer-hide":!0},model:{value:e.showBackupRecordModal,callback:function(t){e.showBackupRecordModal=t},expression:"showBackupRecordModal"}},[e.showBackupRecordModal?a("TalBackupRecordsModal",{attrs:{studentDetail:e.stuInfo,isTaskMode:!0},on:{close:function(t){e.showBackupRecordModal=!1}}}):e._e()],1),e._v(" "),a("Modal",{attrs:{title:"散诊任务跟进",width:"760","mask-closable":!1,"footer-hide":!0},model:{value:e.showDiagnosisFllowModal,callback:function(t){e.showDiagnosisFllowModal=t},expression:"showDiagnosisFllowModal"}},[e.showDiagnosisFllowModal?a("Tabs",{attrs:{animated:!1},on:{"on-click":e.handleFollowDiagnosisTabsClick},model:{value:e.activeTabId,callback:function(t){e.activeTabId=t},expression:"activeTabId"}},e._l(e.followDiagnosisArr,(function(t,n){return a("TabPane",{key:n,attrs:{label:"预约记录"+(n+1),name:t.id,index:n}},[t.init?a("FllowDiagnosisRecord",{ref:t.id,refInFor:!0,attrs:{diagnosisRecordId:t.id,studentDetail:e.stuDetail},on:{success:function(a){return e.handleFollowDiagnosisRecordSuccess(t.id)},close:function(t){e.showDiagnosisFllowModal=!1}}}):e._e()],1)})),1):e._e()],1),e._v(" "),a("Modal",{attrs:{title:"试听任务跟进",width:"760","mask-closable":!1,"footer-hide":!0},model:{value:e.showAuditionFollowModal,callback:function(t){e.showAuditionFollowModal=t},expression:"showAuditionFollowModal"}},[e.showAuditionFollowModal?a("Tabs",{attrs:{animated:!1},on:{"on-click":e.handleFollowAuditionTabsClick},model:{value:e.activeTabId,callback:function(t){e.activeTabId=t},expression:"activeTabId"}},e._l(e.followAuditionArr,(function(t,n){return a("TabPane",{key:n,attrs:{label:"预约记录"+(n+1),name:t.id,index:n}},[t.init?a("FollowRecord",{ref:t.id,refInFor:!0,attrs:{appointmentApplyId:t.appointmentApplyId,appointmentId:t.id,operationType:1,studentDetail:e.stuDetail},on:{success:function(a){return e.handleFollowAuditionRecordSuccess(t.id)},close:function(t){e.showAuditionFollowModal=!1}}}):e._e()],1)})),1):e._e()],1),e._v(" "),a("Modal",{attrs:{title:"试听申请任务跟进",width:"760","mask-closable":!1,"footer-hide":!0},model:{value:e.showAuditionApplyFollowModal,callback:function(t){e.showAuditionApplyFollowModal=t},expression:"showAuditionApplyFollowModal"}},[e.showAuditionApplyFollowModal?a("Tabs",{attrs:{animated:!1},on:{"on-click":e.handleFollowApplyTabsClick},model:{value:e.activeTabId,callback:function(t){e.activeTabId=t},expression:"activeTabId"}},e._l(e.followApplyArr,(function(t,n){return a("TabPane",{key:n,attrs:{label:"试听申请"+(n+1),name:t.id,index:n}},[t.init?a("AuditionFollowRecord",{ref:t.id,refInFor:!0,attrs:{appointmentApplyId:t.appointmentApplyId,appointmentId:t.id,operationType:1,studentDetail:e.stuDetail,appointmentList:t},on:{success:e.handleFollowAuditionRecordSuccess}}):e._e()],1)})),1):e._e()],1)],1)}),[],!1,null,"32babd42",null));t.default=K.exports},"409f":function(e,t,a){},"41e1":function(e,t,a){},"47cc":function(e,t,a){},"4f20":function(e,t,a){"use strict";var n=a("e457");a.n(n).a},5091:function(e,t,a){"use strict";var n=a("7e66");a.n(n).a},"522dc":function(e,t,a){},"52d8":function(e,t,a){"use strict";var n=a("9a2f");a.n(n).a},"610c":function(e,t,a){"use strict";a.r(t);a("8e6e"),a("ac6a"),a("cadf"),a("456d"),a("28a5");var n=a("bd86"),r=(a("0d6d"),a("96cf"),a("3b8d")),i=(a("7f7f"),a("386d"),a("c5f6"),{mixins:[a("0ef6").a],props:{tableData:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:function(){return!1}},flagShow:{type:Boolean,default:function(){return!1}},crmRoleId:{type:Number,default:function(){return-1}},roleName:{type:String,default:function(){return""}}},data:function(){return{multipleSelection:[]}},methods:{handleSelectionChange:function(e){this.multipleSelection=e},showDialog:function(e,t){if(this.$emit("search"),t){var a=null,n="";"part"===t?(a="15-5128",n="资源列表选中分配"):"all"===t&&(a="15-5129",n="资源列表全部分配"),XesAnalytics.track(a,{button_name:n})}this.$store.commit("resource/setIdentity",e),this.$store.commit("resource/setmultipleSelection",this.multipleSelection.map((function(e){return e.uid})))},sortChange:function(e){this.$emit("sortchange",e)}}}),s=(a("2635"),a("2877")),o=Object(s.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{padding:"5px 10px"}},[a("el-button",{attrs:{size:"small",disabled:0===e.multipleSelection.length},on:{click:function(t){return e.showDialog("consult","part")}}},[e._v("选中分配")]),e._v(" "),a("el-button",{attrs:{size:"small",disabled:0!==e.multipleSelection.length||0===e.tableData.length},on:{click:function(t){return e.showDialog("consult","all")}}},[e._v("全部分配")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.showDialog("records")}}},[e._v("\n      资源分配记录查询\n    ")]),e._v(" "),5===e.crmRoleId?[a("router-link",{staticClass:"el-button--small",attrs:{tag:"el-button",to:"/pushmsg/apppushmsg"}},[e._v("创建群发")]),e._v(" "),a("router-link",{staticClass:"el-button--small",attrs:{tag:"el-button",to:"/pushmsg/pushmsglist"}},[e._v("群发历史")])]:e._e(),e._v(" "),a("Alert",{staticStyle:{display:"inline-block",marginLeft:"10px"},attrs:{type:"warning","show-icon":""}},[e._v("\n      新“资源分层列表”功能上线了，后续请前往“资源分层列表”进行资源维护和筛选操作\n    ")])],2),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{fixed:"",type:"selection",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"card",label:"学员编号",width:"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",label:"学员姓名",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.goCustomerDetail(t.row)}}},[e._v(e._s(t.row.stuRealName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"",label:"用户标签",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.repeatTagName||"无")+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"gradeName",label:"当前年级",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cityName",label:"注册城市",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"readStatusName",label:"在读状态",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"consultant",label:"绑定人",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bindStatusName",label:"绑定状态",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"activeStatusName",label:"客户状态",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"belongDeptTypeName",label:"归属类型",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"belongDeptName",label:"归属",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"attendClassCount",label:"在读班级数",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"payTotalCount",label:"总缴费次数",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"followNum",label:"维护次数",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"registeredDate",label:"注册时间","min-width":"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"belongFromDate",label:"最后分配时间","min-width":"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"followLastestDate",label:"最后维护时间","min-width":"180",align:"center"}})],1)],1)}),[],!1,null,null,null).exports,l=(a("f751"),a("6167")),c=a("2f62");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p,m={props:{deptid:{type:String,default:function(){return""}},formData:Object,totalNum:Number},data:function(){return{statusMap:{1:"处理中",2:"分配成功",3:"分配失败"},addForm:{cityId:"",areaId:"",centerId:"",adviserId:""},areaList:[],cityList:[],serverList:[],submitSuccess:!1,adviserList:[],activeName:"first",tableData:{},detailModal:!1,detailList:[],searchData:{pageNo:1,pageSize:10},operateSearch:{pageNo:1,pageSize:10}}},computed:d(d({},Object(c.e)("roleRelativeData",["userInfo"])),{},{dialogVisible:function(){return"consult"===this.$store.state.resource.identity},multipleSelection:function(){return this.$store.state.resource.multipleSelection},selectedNum:function(){return this.$store.state.resource.multipleSelection.length||this.totalNum},areaCode:function(){var e=this,t=this.cityList.find((function(t){return String(t.id)===e.addForm.cityId}));return t?t.deptCode:""},empNo:function(){return this.$store.state.user.userInfo.empNo},confirmHtml:function(){var e=this,t=[],a=this.cityList.find((function(t){return String(t.id)===e.addForm.cityId}));a&&t.push(a.deptName);var n=this.areaList.find((function(t){return String(t.id)===e.addForm.areaId}));n&&t.push(n.deptName);var r=this.serverList.find((function(t){return String(t.id)===e.addForm.centerId}));r&&t.push(r.deptName);var i=this.adviserList.find((function(t){return String(t.identityId)===e.addForm.adviserId}));return i&&t.push(i.userName),'<p><span>已勾选：</span><span style="color: #2D8cF0"> '.concat(this.selectedNum,'人</span></p>\n              <p>\n                <span>接收方：</span>\n                <span style="color: #2D8cF0">\n                    ').concat(t.join(" - "),"\n                 </span>\n              </p>\n              <p>确认分配后将无法撤销，请谨慎处理！</p>")}}),watch:{dialogVisible:function(){var e=this;this.activeName="first",Object(l.D)({departId:Number(this.deptid),departType:""}).then((function(t){e.cityList=t.filter((function(e){return 10!==e.deptType}))})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})})),this.submitSuccess=!1}},methods:{handleClick:function(e){"second"===e.name&&this.queryLogs()},queryLogs:function(){var e=this;Object(l.j)(d({empNo:this.empNo,areaCode:this.userInfo.cityCode,cityCode:this.userInfo.cityCode},this.operateSearch)).then((function(t){e.tableData=t})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},getDispatchDetail:function(e){this.currentDispatchId=e,this.queryDetailInfo()},queryDetailInfo:function(){var e=this;Object(l.i)(d(d({dispatchId:this.currentDispatchId},this.searchData),{},{cityCode:this.cityCode})).then((function(t){e.detailList=t,e.detailModal=!0})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},alloc:(p=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.selectedNum){e.next=3;break}return this.$message({type:"warning",message:"当前条件下未找到需要分配的学员"}),e.abrupt("return");case 3:if(""!==this.addForm.cityId){e.next=6;break}return this.$message({type:"warning",message:"请选择所要分配的城市"}),e.abrupt("return");case 6:if(""===this.addForm.areaId||""!==this.addForm.centerId){e.next=9;break}return this.$message({type:"warning",message:"不能分配到区域，请选择所要分配的服务中心"}),e.abrupt("return");case 9:this.$confirm(this.confirmHtml,"重要提示",{confirmButtonText:"确认执行分配",cancelButtonText:"修改后再提交",type:"warning",dangerouslyUseHTMLString:!0,showClose:!1}).then(Object(r.a)(regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submitSuccess=!0,a=t.addForm.cityId,n=1,t.addForm.adviserId?(a=t.addForm.adviserId,n=3):t.addForm.centerId&&(a=t.addForm.centerId,n=2),delete(r=Object.assign({},t.formData,{areaCode:t.areaCode,type:n,targetId:a,pyUidList:t.multipleSelection,operateEmpNo:t.empNo,cityCode:t.userInfo.cityCode,belongIdentityId:t.formData.belongIdentityIdByPerson||t.formData.belongIdentityIdByStop,targetList:[{targetId:a,type:n,dispatchCount:t.multipleSelection.length||t.selectedNum}]})).pageNo,delete r.pageSize,console.log("params",r),e.prev=8,e.next=11,Object(l.e)(r);case 11:t.$message({type:"success",message:"成功分配"}),t.closeDialog(),t.$emit("refresh"),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),t.$Message.error({content:"分配失败："+e.t0.message});case 19:return e.prev=19,t.submitSuccess=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[8,16,19,22]])})))).catch((function(){t.$message({type:"info",message:"已取消"})}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)}),getAreaList:function(){var e=this;Object(l.D)({departId:this.addForm.cityId,departType:""}).then((function(t){e.areaList=t,e.addForm.areaId="",e.addForm.centerId=""})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},getCenterList:function(){var e=this;Object(l.D)({departId:this.addForm.areaId,departType:""}).then((function(t){e.serverList=t,e.addForm.centerId=""})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},getAdviserList:function(){var e=this;Object(l.r)({areaCode:this.areaCode,roleId:5,deptId:this.addForm.centerId}).then((function(t){e.adviserList=t.filter((function(t){return t.empNo!==e.empNo})),e.addForm.adviserId=""})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},closeDialog:function(){this.clearForm(),this.$store.commit("resource/setIdentity",""),this.$store.commit("resource/setDialogType",""),this.$store.commit("resource/setmultipleSelection",[])},clearForm:function(){this.addForm={cityId:"",areaId:"",centerId:"",adviserId:""},this.belongDeptId=""},handleClose:function(e){this.closeDialog(),e()},handleSizeChange:function(e){this.searchData.pageSize=e,this.queryDetailInfo()},handleCurrentChange:function(e){this.searchData.pageNo=e,this.queryDetailInfo()},handleSizeChangeOpr:function(e){this.operateSearch.pageSize=e,this.queryLogs()},handleCurrentChangeOpr:function(e){this.operateSearch.pageNo=e,this.queryLogs()},closeDia:function(e){this.searchData={pageNo:1,pageSize:10},this.operateSearch={pageNo:1,pageSize:10},e()}}},f=(a("76ca"),Object(s.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.dialogVisible?a("el-dialog",{attrs:{visible:e.dialogVisible,"before-close":e.handleClose,title:"资源分配",width:"60%"},on:{close:e.closeDialog}},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"资源分配",name:"first"}},[a("p",{staticClass:"selected-info"},[a("i",{staticClass:"icon el-icon-info"}),e._v("\n          已选择"),a("span",{staticClass:"stress"},[e._v(e._s(e.selectedNum)+"人")])]),e._v(" "),a("el-form",{staticClass:"form",attrs:{model:e.addForm,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"城市："}},[a("el-select",{attrs:{filterable:""},on:{change:e.getAreaList},model:{value:e.addForm.cityId,callback:function(t){e.$set(e.addForm,"cityId",t)},expression:"addForm.cityId"}},e._l(e.cityList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.deptName,value:String(e.id)}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"区域："}},[a("el-select",{attrs:{filterable:""},on:{change:e.getCenterList},model:{value:e.addForm.areaId,callback:function(t){e.$set(e.addForm,"areaId",t)},expression:"addForm.areaId"}},[a("el-option",{attrs:{label:"不限",value:""}}),e._v(" "),e._l(e.areaList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.deptName,value:String(e.id)}})}))],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"服务中心："}},[a("el-select",{attrs:{filterable:""},on:{change:e.getAdviserList},model:{value:e.addForm.centerId,callback:function(t){e.$set(e.addForm,"centerId",t)},expression:"addForm.centerId"}},[a("el-option",{attrs:{label:"不限",value:""}}),e._v(" "),e._l(e.serverList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.deptName,value:String(e.id)}})}))],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"顾问："}},[a("el-select",{attrs:{filterable:""},model:{value:e.addForm.adviserId,callback:function(t){e.$set(e.addForm,"adviserId",t)},expression:"addForm.adviserId"}},[a("el-option",{attrs:{label:"不限",value:""}}),e._v(" "),e._l(e.adviserList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.userName,value:String(e.identityId)}})}))],2)],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{disabled:e.submitSuccess,type:"primary"},on:{click:e.alloc}},[e._v("确 定")])],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"分配记录",name:"second"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData.records}},[a("el-table-column",{attrs:{prop:"createDate",label:"操作时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v("\n                "+e._s(""+(n.createDate?n.createDate:"--"))+"\n              ")])]}}],null,!1,2546303111)}),e._v(" "),a("el-table-column",{attrs:{prop:"typeName",label:"接收方",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"分配状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(2===t.row.status?"处理完成":"处理中"))]),e._v(" "),a("a",{on:{click:function(a){return e.getDispatchDetail(t.row.id)}}},[e._v("查看明细")])]),e._v(" "),a("div",[e._v("\n                "+e._s("（成功"+t.row.successNum+"人，失败"+t.row.failNum+"人）")+"\n              ")])]}}],null,!1,726457413)})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.tableData.pageNo,"page-sizes":[10,20],"page-size":e.tableData.pageSize,total:e.tableData.totalCount,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChangeOpr,"current-change":e.handleCurrentChangeOpr}}),e._v(" "),a("el-dialog",{attrs:{title:"分配明细",visible:e.detailModal,"append-to-body":"","before-close":e.closeDia,width:"60%"},on:{"update:visible":function(t){e.detailModal=t}}},[e.detailList&&e.detailList.records&&e.detailList.records.length>0?a("div",[a("el-timeline",{attrs:{reverse:!0}},e._l(e.detailList.records,(function(t,n){return a("el-timeline-item",{key:n,attrs:{timestamp:t.createDate}},[a("div",[e._v(e._s(e.statusMap[t.status]))]),e._v(" "),a("div",[e._v(e._s(t.studentName))])])})),1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.detailList.pageNo,"page-sizes":[10,20],"page-size":e.detailList.pageSize,total:e.detailList.totalCount,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):a("div",{staticClass:"noText"},[e._v("暂无数据")])])],1)],1)],1):e._e()],1)}),[],!1,null,"27c08e3f",null).exports);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v={props:{deptid:{type:String,default:function(){return""}},formData:Object,totalNum:Number},data:function(){return{statusMap:{1:"处理中",2:"分配成功",3:"分配失败"},addForm:{operateEmpNo:null},tableData:[],detailModal:!1,detailList:[],searchData:{pageNo:1,pageSize:10},operateSearch:{pageNo:1,pageSize:10},detailForm:{status:null,name:""},operateUserList:[],tableLoading:!1,splitStatus:{1:"处理中",2:"处理完成",3:"处理失败"}}},computed:g(g({},Object(c.e)("roleRelativeData",["userInfo"])),{},{dialogVisible:function(){return"records"===this.$store.state.resource.identity},empNo:function(){return this.$store.state.user.userInfo.empNo},getRole:function(){return function(e){return(e.operateCityName?e.operateCityName+"-":"")+(e.operateAreaName?e.operateAreaName:"")+(e.operateServiceCenterName?e.operateServiceCenterName+"-":"")+(e.operateRoleName?e.operateRoleName:"")}}}),watch:{dialogVisible:function(){this.getAreaList(null,1)}},methods:{queryOperation:function(e){var t=this;if(e){var a={cityCode:this.userInfo.cityCode};Object(l.o)(a).then((function(e){t.operateUserList=e})).catch((function(e){t.$Message.error(e.message)}))}},getDispatchDetail:function(e){this.currentDispatchId=e,this.queryDetailInfo()},queryDetailInfo:function(){var e=this;Object(l.i)(g(g(g({},this.detailForm),this.searchData),{},{dispatchId:this.currentDispatchId,cityCode:this.userInfo.cityCode})).then((function(t){e.detailList=t,e.detailModal=!0})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},getAreaList:function(e,t){var a=this;1===t&&(this.operateSearch={pageNo:1,pageSize:10});var n=g({empNo:this.empNo,operateEmpNo:e,areaCode:this.userInfo.cityCode,cityCode:this.userInfo.cityCode},this.operateSearch);this.tableLoading=!0,Object(l.j)(n).then((function(e){a.tableData=e,a.tableLoading=!1})).catch((function(e){a.tableLoading=!1,a.$Message.error({content:"获取数据失败："+e.message})}))},closeDialog:function(){this.clearForm(),this.$store.commit("resource/setIdentity",""),this.$store.commit("resource/setDialogType",""),this.$store.commit("resource/setmultipleSelection",[])},clearForm:function(){this.addForm={operateEmpNo:null}},handleClose:function(e){this.closeDialog(),e()},handleSizeChange:function(e){this.searchData.pageSize=e,this.queryDetailInfo()},handleCurrentChange:function(e){this.searchData.pageNo=e,this.queryDetailInfo()},handleSizeChangeOpr:function(e){this.operateSearch.pageSize=e,this.getAreaList(this.addForm.operateEmpNo)},handleCurrentChangeOpr:function(e){this.operateSearch.pageNo=e,this.getAreaList(this.addForm.operateEmpNo)},closeDia:function(e){this.searchData={pageNo:1,pageSize:10},this.operateSearch={pageNo:1,pageSize:10},this.$refs.detailFormref.resetFields(),this.$refs.addFormref.resetFields(),this.detailForm.status=null,this.addForm.operateEmpNo=null,e()},searchDetail:function(){this.queryDetailInfo()}}},b=(a("fc85"),Object(s.a)(v,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.dialogVisible?a("el-dialog",{attrs:{visible:e.dialogVisible,"before-close":e.handleClose,title:"资源分配记录查询",width:"60%"},on:{close:e.closeDialog}},[a("el-form",{ref:"addFormref",staticClass:"form",attrs:{model:e.addForm,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"操作人："}},[a("el-select",{attrs:{size:"small",filterable:""},on:{change:function(t){return e.getAreaList(t,1)},"visible-change":e.queryOperation},model:{value:e.addForm.operateEmpNo,callback:function(t){e.$set(e.addForm,"operateEmpNo",t)},expression:"addForm.operateEmpNo"}},[a("el-option",{attrs:{value:null,label:"全部"}}),e._v(" "),e._l(e.operateUserList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.operateName,value:String(e.operateEmpNo)}})}))],2)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData.records}},[a("el-table-column",{attrs:{prop:"createDate",label:"发起时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v("\n            "+e._s(""+(n.createDate?n.createDate:"--"))+"\n          ")])]}}],null,!1,2158054791)}),e._v(" "),a("el-table-column",{attrs:{label:"操作人",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v("\n            "+e._s(""+(n.operateName?n.operateName:"--"))+"\n          ")]),e._v(" "),a("p",[e._v(e._s("("+e.getRole(n)+")"))])]}}],null,!1,3390240903)}),e._v(" "),a("el-table-column",{attrs:{prop:"typeName",width:"180",label:"接收方",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"分配状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(2===t.row.status?"处理完成":"处理中"))]),e._v(" "),a("a",{on:{click:function(a){return e.getDispatchDetail(t.row.id)}}},[e._v("查看明细")])]),e._v(" "),a("div",[e._v("\n            "+e._s("（成功"+t.row.successNum+"人，失败"+t.row.failNum+"人）")+"\n          ")])]}}],null,!1,811907141)}),e._v(" "),a("el-table-column",{attrs:{prop:"completeTime",label:"完成时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v("\n            "+e._s(""+(n.completeTime?n.completeTime:"--"))+"\n          ")])]}}],null,!1,1391101575)})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.tableData.pageNo,"page-sizes":[10,20],"page-size":e.tableData.pageSize,total:e.tableData.totalCount,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChangeOpr,"current-change":e.handleCurrentChangeOpr}}),e._v(" "),a("el-dialog",{attrs:{title:"分配明细",visible:e.detailModal,"append-to-body":"","before-close":e.closeDia,width:"60%"},on:{"update:visible":function(t){e.detailModal=t}}},[a("el-form",{ref:"detailFormref",attrs:{inline:!0,model:e.detailForm,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"分配状态："}},[a("el-select",{model:{value:e.detailForm.status,callback:function(t){e.$set(e.detailForm,"status",t)},expression:"detailForm.status"}},[a("el-option",{attrs:{value:null,label:"全部"}}),e._v(" "),e._l(Object.keys(e.splitStatus),(function(t,n){return a("el-option",{key:n,attrs:{label:e.splitStatus[t],value:String(t)}})}))],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名："}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.detailForm.name,callback:function(t){e.$set(e.detailForm,"name",t)},expression:"detailForm.name"}})],1),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.searchDetail}},[e._v("查询")])],1),e._v(" "),a("br"),e._v(" "),e.detailList&&e.detailList.records&&e.detailList.records.length>0?a("div",[a("el-timeline",{attrs:{reverse:!0}},e._l(e.detailList.records,(function(t,n){return a("el-timeline-item",{key:n,attrs:{timestamp:t.createDate}},[a("div",[e._v(e._s(e.statusMap[t.status]))]),e._v(" "),a("div",[e._v(e._s(t.studentName))])])})),1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.detailList.pageNo,"page-sizes":[10,20],"page-size":e.detailList.pageSize,total:e.detailList.totalCount,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):a("div",{staticClass:"noText"},[e._v("暂无数据")])],1)],1):e._e()],1)}),[],!1,null,"0ceceffc",null).exports),y=a("0644"),w=a.n(y);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var D,C,S,x,T,I={name:"resourceList",components:{resourceTable:o,DispatchDialog:f,ResourceRecordSearchDialog:b},data:function(){return{pickerOption:{disabledDate:function(e){return e.getTime()>Date.now()}},tableData:[],overallStat:{},consultantLoading:!1,consultantLoaded:!1,resignIdentityLoading:!1,resignIdentityLoaded:!1,condition:{belongStatusList:[],belongTypeList:[],customActiveStatusList:[],distributeStatusList:[],readStatusList:[],gradeList:[],consultantList:[],deptList:[],resignIdentity:[]},channel:"",curriculumTime:[],form:{startTime:"",endTime:"",activeStatus:"",allotStatus:"",followStatus:"",belongIdentityId:"",readStatus:"",areaCode:"",gradeId:"",tagId:"",belongStatus:"",bindStatus:"",belongDeptType:"",belongDeptId:"",userTag:"",pageNo:1,pageSize:20,belongIdentityIdByStop:"",belongIdentityIdByPerson:"",resourceWarning:""},fastSearchType:"stuMobile",fastSearch:"",deptList:[],registerTime:"",pageSize:20,pageNo:1,total:0,flag:"",loading:!1,tags:[],bindConsults:[],flagShow:!1,disShow:!1,disPersonShow:!1,resourceWarningList:[]}},computed:{identityInfo:function(){return this.$store.state.roleRelativeData.userInfo},crmRoleId:function(){return this.identityInfo.crmRoleId},roleName:function(){return this.identityInfo.roleName},departId:function(){return this.identityInfo.crmDeptId},departName:function(){return this.identityInfo.crmDepartName},roleInfo:function(){return this.$store.state.roleRelativeData.roleInfo},userInfo:function(){return this.$store.state.roleRelativeData.userInfo}},watch:{fastSearch:function(e,t){this.form[this.fastSearchType]=e},fastSearchType:function(e,t){this.form[t]="",this.form[e]=this.fastSearch},departId:function(){this.flagShow=this.ifShow()}},mounted:function(){this.search(),this.queryResourceConditionHandler()},beforeRouteLeave:function(e,t,a){var n=null,r="";"apppushmsg"===e.name?(n="15-5127",r="资源列表创建群发按钮"):"pushmsglist"===e.name&&(n="15-5126",r="资源列表群发历史"),n&&XesAnalytics.track(n,{button_name:r}),a()},methods:{searchTrack:function(e){XesAnalytics.track("15-5020",{query_json:e})},queryHandler:(T=Object(r.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.disPersonShow=!0,!t||this.consultantLoaded){e.next=15;break}return e.prev=2,this.consultantLoading=!0,e.next=6,Object(l.C)();case 6:a=e.sent,this.condition.consultantList=Object.freeze(a)||[],this.consultantLoaded=!0,this.consultantLoading=!1,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),this.$Message.error({content:"获取绑定人失败："+e.t0.message});case 15:case"end":return e.stop()}}),e,this,[[2,12]])}))),function(e){return T.apply(this,arguments)}),changeStatus:function(e){""===e&&(this.disShow=!1,this.disPersonShow=!1)},queryResignIdentity:(x=Object(r.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.disShow=!0,!t||this.resignIdentityLoaded){e.next=15;break}return e.prev=2,this.resignIdentitying=!0,e.next=6,Object(l.H)();case 6:a=e.sent,this.condition.resignIdentity=Object.freeze(a.map((function(e){return _(_({},e),{},{userName:e.userName+"(已停用)"})})))||[],this.resignIdentityLoaded=!0,this.resignIdentityLoading=!1,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),this.$Message.error({content:"获取停用/离职顾问失败："+e.t0.message});case 15:case"end":return e.stop()}}),e,this,[[2,12]])}))),function(e){return x.apply(this,arguments)}),queryResourceConditionHandler:(S=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.I)({});case 3:t=e.sent,this.condition.belongStatusList=Object.freeze(t.belongStatusList)||[],this.condition.belongTypeList=Object.freeze(t.belongTypeList)||[],this.condition.customActiveStatusList=Object.freeze(t.customActiveStatusList)||[],this.condition.distributeStatusList=Object.freeze(t.distributeStatusList)||[],this.condition.readStatusList=Object.freeze(t.readStatusList)||[],this.condition.gradeList=Object.freeze(t.gradeList)||[],this.condition.userTagList=Object.freeze(t.userTagList)||[],e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),this.$Message.error({content:"获取筛选条件失败："+e.t0.message});case 16:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(){return S.apply(this,arguments)}),handleSizeChange:function(e){this.pageSize=e,this.pageNo=1,this.form.pageSize=e,this.form.pageNo=1,this.getResourceList()},handleCurrentChange:function(e){this.pageNo=e,this.form.pageNo=e,this.getResourceList()},search:function(){this.pageNo=1;var e=w()(this.form);e.startTime=this.registerTime&&this.registerTime[0]?this.registerTime[0]/1e3:"",e.endTime=this.registerTime&&this.registerTime[1]?this.registerTime[1]/1e3+86399:"",this.flagShow&&(e.channel=this.channel,e.curriculumTime=this.curriculumTime),e.stuMobile="",e.stuRealName="",e.card="",e[this.fastSearchType]=this.fastSearch,e.pageNo=this.pageNo,e.pageSize=this.pageSize,e.isDeactivate=1===e.belongDeptId?1:0,e.belongIdentityId=this.disShow?e.belongIdentityIdByStop:e.belongIdentityIdByPerson,e.resourceWarningType=e.resourceWarning.split("-")[0],e.resourceWarningId=e.resourceWarning.split("-")[1],e.crmRoleId=this.identityInfo.crmRoleId,e.crmDeptId=this.identityInfo.crmDeptId,e.baseDataId=this.identityInfo.baseDataId,this.form=_({},e),delete e.belongIdentityIdByStop,delete e.belongIdentityIdByPerson,this.getResourceList(e),this.searchTrack(e)},getResourceList:(C=Object(r.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t=this.form),this.loading=!0,e.prev=2,e.next=5,Object(l.k)(t);case 5:a=e.sent,this.tableData=Object.freeze(a.crmStudentRespList)||[],this.total=a.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),this.$Message.error({content:"获取资源列表失败："+e.t0.message});case 13:return e.prev=13,this.loading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,10,13,16]])}))),function(e){return C.apply(this,arguments)}),getDepartList:(D=Object(r.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.form.belongDeptId="",""!==this.form.belongDeptType&&0!==this.form.belongDeptType){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,Object(l.F)({type:this.form.belongDeptType});case 6:t=e.sent,a=t&&t.map((function(e){return 2===e.status?_(_({},e),{},{deptName:e.deptName+" (已停用)"}):e})),this.condition.deptList=a,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),this.$Message.error({content:"获取归属失败："+e.t0.message});case 14:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(){return D.apply(this,arguments)}),sortchange:function(e){this.form[e.prop]=e.order,this.form.pageNo=1,this.getResourceList()},runEnv:function(){if(window){var e=window.location.hostname;return e.indexOf(".dev.")>-1?707:e.indexOf(".qa.")>-1?2343523:937}},ifShow:function(){return this.departId===this.runEnv()}}},N=(a("3482"),Object(s.a)(I,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",{staticClass:"container"},[a("div",{staticClass:"container-card"},[e.resourceWarningList.length>0?a("RadioGroup",{staticStyle:{padding:"24px"},attrs:{type:"button","button-style":"solid"},model:{value:e.form.resourceWarning,callback:function(t){e.$set(e.form,"resourceWarning",t)},expression:"form.resourceWarning"}},e._l(e.resourceWarningList,(function(t,n){return a("Radio",{key:n,attrs:{label:t.label,border:""}},[e._v(e._s(t.name))])})),1):e._e(),e._v(" "),a("div",{staticClass:"container-filterform"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"注册日期"}},[a("el-date-picker",{staticStyle:{width:"333px"},attrs:{size:"small","picker-options":e.pickerOption,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户状态"}},[a("span",{staticClass:"active-status"},[a("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"请输入"},model:{value:e.form.activeStatus,callback:function(t){e.$set(e.form,"activeStatus",t)},expression:"form.activeStatus"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),e._l(e.condition.customActiveStatusList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"分配状态"}},[a("span",{staticClass:"active-status"},[a("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"请输入"},model:{value:e.form.belongStatus,callback:function(t){e.$set(e.form,"belongStatus",t)},expression:"form.belongStatus"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),e._l(e.condition.distributeStatusList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"绑定状态"}},[a("span",{staticClass:"bindstatus-select"},[a("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"请输入"},model:{value:e.form.bindStatus,callback:function(t){e.$set(e.form,"bindStatus",t)},expression:"form.bindStatus"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),e._l(e.condition.belongStatusList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"绑定人"}},[a("span",{staticClass:"bindstatus-select"},[a("el-select",{staticClass:"w120",attrs:{loading:e.consultantLoading,size:"small",filterable:"",clearable:"",placeholder:"请输入",disabled:1===e.form.bindStatus||e.disShow},on:{change:e.changeStatus,"visible-change":e.queryHandler},model:{value:e.form.belongIdentityIdByPerson,callback:function(t){e.$set(e.form,"belongIdentityIdByPerson",t)},expression:"form.belongIdentityIdByPerson"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),e._l(e.condition.consultantList,(function(e){return a("el-option",{key:e.identityId,attrs:{label:e.userName,value:e.identityId}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"停用/离职顾问"}},[a("span",{staticClass:"bindstatus-select"},[a("el-select",{staticClass:"w120",attrs:{loading:e.resignIdentityLoading,size:"small",clearable:"",filterable:"",placeholder:"请输入",disabled:1===e.form.bindStatus||e.disPersonShow},on:{change:e.changeStatus,"visible-change":e.queryResignIdentity},model:{value:e.form.belongIdentityIdByStop,callback:function(t){e.$set(e.form,"belongIdentityIdByStop",t)},expression:"form.belongIdentityIdByStop"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),e._l(e.condition.resignIdentity,(function(e){return a("el-option",{key:e.identityId,attrs:{label:e.userName,value:e.identityId}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"归属类型"}},[a("span",{staticClass:"belongtype-select"},[a("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"请输入"},on:{change:e.getDepartList},model:{value:e.form.belongDeptType,callback:function(t){e.$set(e.form,"belongDeptType",t)},expression:"form.belongDeptType"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),e._l(e.condition.belongTypeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)]),e._v(" "),a("el-form-item",{key:"a",attrs:{label:"归属"}},[a("span",{staticClass:"belong-select"},[a("el-select",{staticClass:"w120",attrs:{size:"small",disabled:!e.form.belongDeptType,filterable:"",placeholder:"请输入"},model:{value:e.form.belongDeptId,callback:function(t){e.$set(e.form,"belongDeptId",t)},expression:"form.belongDeptId"}},[11!==Number(e.form.belongDeptType)?a("el-option",{attrs:{value:"",label:"全部"}}):e._e(),e._v(" "),e._l(e.condition.deptList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.deptName,value:e.id}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"在读状态"}},[a("span",{staticClass:"bindstatus-select"},[a("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"请输入"},model:{value:e.form.readStatus,callback:function(t){e.$set(e.form,"readStatus",t)},expression:"form.readStatus"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),e._l(e.condition.readStatusList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"用户标签"}},[a("span",{staticClass:"grade-select"},[a("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"请输入"},model:{value:e.form.userTag,callback:function(t){e.$set(e.form,"userTag",t)},expression:"form.userTag"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),a("el-option",{attrs:{value:0,label:"无"}}),e._v(" "),e._l(e.condition.userTagList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"当前年级"}},[a("span",{staticClass:"grade-select"},[a("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"请输入"},model:{value:e.form.gradeId,callback:function(t){e.$set(e.form,"gradeId",t)},expression:"form.gradeId"}},[a("el-option",{attrs:{value:"",label:"全部"}}),e._v(" "),a("el-option",{attrs:{value:99,label:"未填写"}}),e._v(" "),e._l(e.condition.gradeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"快速搜索:"}},[a("el-input",{staticClass:"input-with-select",attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.fastSearch,callback:function(t){e.fastSearch=t},expression:"fastSearch"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{slot:"append",size:"small",placeholder:"请选择"},slot:"append",model:{value:e.fastSearchType,callback:function(t){e.fastSearchType=t},expression:"fastSearchType"}},[a("el-option",{attrs:{label:"手机号",value:"stuMobile"}}),e._v(" "),a("el-option",{attrs:{label:"姓名",value:"stuRealName"}}),e._v(" "),a("el-option",{attrs:{label:"学员编号",value:"card"}})],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"w90",attrs:{size:"small",type:"primary",disabled:e.loading},on:{click:e.search}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("resourceTable",{attrs:{"table-data":e.tableData,loading:e.loading,"crm-role-id":e.crmRoleId,"role-name":e.roleName,"flag-show":e.flagShow},on:{search:e.search,sortchange:e.sortchange}}),e._v(" "),a("div",{staticClass:"pagination-basic"},[a("el-pagination",{attrs:{"current-page":e.pageNo,"page-sizes":[10,20],"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("DispatchDialog",{attrs:{deptid:"10",formData:e.form,totalNum:e.total>1e4?1e4:e.total},on:{refresh:e.getResourceList}}),e._v(" "),a("ResourceRecordSearchDialog")],1)}),[],!1,null,"d3eee090",null));t.default=N.exports},6350:function(e,t,a){"use strict";var n=a("94fc");a.n(n).a},"66bf":function(e,t,a){"use strict";var n=a("f79b");a.n(n).a},"66fa":function(e,t,a){"use strict";a.r(t);a("8e6e"),a("ac6a"),a("cadf"),a("456d"),a("0d6d"),a("96cf");var n=a("3b8d"),r=(a("386d"),a("f751"),a("28a5"),a("bd86")),i=(a("7f7f"),{name:"PhoneCardNameSearch",props:{value:{type:Array,default:function(){return[]}}},watch:{value:{deep:!0,immediate:!0,handler:function(e){this.inputValue=e[1]||"",this.selectValue=e[0]||"stuMobile"}},inputValue:function(){this.$emit("input",[this.selectValue,this.inputValue]),this.$emit("on-change",[this.selectValue,this.inputValue])},selectValue:function(){this.$emit("input",[this.selectValue,this.inputValue]),this.$emit("on-change",[this.selectValue,this.inputValue])}},data:function(){return{inputValue:"",selectValue:"stuMobile",localHistoryList:localStorage.localHistoryList?JSON.parse(localStorage.localHistoryList):{},showHistory:!1,historyList:[]}},mounted:function(){window.addEventListener("click",this.historyListVisibleEvent),this.setHistoryListShow()},beforeDestroy:function(){window.removeEventListener("click",this.historyListVisibleEvent)},methods:{setHistoryListShow:function(){this.historyList=this.localHistoryList[this.selectValue]||[]},handleSelectValueChange:function(){this.setHistoryListShow()},historyListVisibleEvent:function(){this.showHistory=!1},handleHistorySelect:function(e){this.inputValue=e.name,this.showHistory=!1,e.isHover=!1,this.$emit("input",[this.selectValue,this.inputValue]),this.$emit("on-change",[this.selectValue,this.inputValue])},handleHistoryDel:function(e){this.localHistoryList[this.selectValue]=this.localHistoryList[this.selectValue].filter((function(t){return t.id!==e.id})),localStorage.localHistoryList=JSON.stringify(this.localHistoryList),this.setHistoryListShow()},handleValueConfirm:function(){var e=this;this.localHistoryList[this.selectValue]||(this.localHistoryList[this.selectValue]=[]),this.localHistoryList[this.selectValue]=this.historyList.filter((function(t){return t.name!==e.inputValue.trim()})),this.inputValue.trim()&&(10===this.historyList.length&&this.localHistoryList[this.selectValue].pop(),this.localHistoryList[this.selectValue].unshift({name:this.inputValue,isHover:!1,id:Date.now()}),localStorage.localHistoryList=JSON.stringify(this.localHistoryList),this.setHistoryListShow()),this.historyList.forEach((function(e){return e.isHover=!1}))}}}),s=(a("a264"),a("2877")),o=Object(s.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{on:{click:function(e){e.stopPropagation()}}},[a("Input",{staticClass:"fast-search",staticStyle:{width:"240px"},attrs:{placeholder:"请输入关键词搜索",clearable:""},on:{"on-clear":function(t){return e.handleHistorySelect({name:""})},"on-keyup":function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleValueConfirm(t)},"on-focus":function(t){e.showHistory=!0}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}},[a("Select",{staticStyle:{width:"86px"},attrs:{slot:"prepend"},on:{"on-change":e.handleSelectValueChange},slot:"prepend",model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}},[a("Option",{attrs:{value:"stuMobile"}},[e._v("手机号码")]),e._v(" "),a("Option",{attrs:{value:"stuRealName"}},[e._v("学员姓名")]),e._v(" "),a("Option",{attrs:{value:"stuLoginName"}},[e._v("学员编号")])],1)],1),e._v(" "),e.showHistory&&e.historyList&&e.historyList.length?a("div",{staticClass:"search-history-list"},e._l(e.historyList,(function(t,n){return a("div",{key:n,staticClass:"search-history-item",on:{click:function(a){return e.handleHistorySelect(t)},mouseover:function(e){t.isHover=!0},mouseleave:function(e){t.isHover=!1}}},[a("span",[e._v(e._s(t.name))]),e._v(" "),t.isHover?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return a.stopPropagation(),e.handleHistoryDel(t)}}},[e._v("删除")]):a("span",{staticClass:"gray"},[e._v("历史")])])})),0):e._e()],1)}),[],!1,null,"47a9d34c",null).exports,l=(a("097d"),a("c5f6"),a("867e")),c=a("6167"),u=a("3a27");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m,f,h,g={name:"TreeTransfer",props:{sourceLabel:{type:String,default:"Source"},targetLabel:{type:String,default:"Target"},maxLength:{type:Number,default:10},groupList:{type:Array,default:function(){return[]}},defaultSelected:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{selectedTree:[],treeData:[]}},methods:{textChange:(h=Object(n.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target,e.next=3,this.init();case 3:a.value&&(this.treeData=this.treeData.filter((function(e){return-1!==e.title.indexOf(a.value)||e.children.find((function(e){return-1!==e.title.indexOf(a.value)}))})).map((function(e){return e.children=e.children.filter((function(e){return-1!==e.title.indexOf(a.value)})),e.expanded=!0,e})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)}),nodeClickHandle:(f=Object(n.a)(regeneratorRuntime.mark((function e(t,a,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("level1"!==a){e.next=5;break}r=this.treeData.map((function(e){return e.key===t.key&&(e.expanded=!e.expanded),e})),this.treeData=r,e.next=10;break;case 5:if("level2"!==a){e.next=10;break}if(!t.checked){e.next=8;break}return e.abrupt("return");case 8:this.treeData[n].children=this.level2BuildHandle(t,n),this.emitSelTreeHandle();case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return f.apply(this,arguments)}),level2BuildHandle:function(e,t){var a=this;return this.treeData[t].children.map((function(n){if(n.key===e.key){var r=p(p({},e),{},{checked:!e.checked,parentKey:a.treeData[t].key});if(a.selectedTree.length<a.maxLength)return e.checked?a.selectedTree=a.selectedTree.filter((function(t){return t.key!==e.key})):a.selectedTree.push(r),r;if(a.selectedTree.length>=a.maxLength){if(a.selectedTree.filter((function(t){return t.key===e.key})).length>0)return a.selectedTree=a.selectedTree.filter((function(t){return t.key!==e.key})),r;a.$Message.warning("最多添加".concat(a.maxLength,"条"))}return e}return n}))},removeSelTreeHandle:function(e){if(e.disableCancel)return this.$Message.warning("不允许取消");var t=this.treeData.findIndex((function(t){return t.key===e.parentKey})),a=this.treeData[t].children.findIndex((function(t){return t.key===e.key}));this.treeData[t].children[a]=p(p({},this.treeData[t].children[a]),{},{checked:!1}),this.selectedTree=this.selectedTree.filter((function(t){return t.key!==e.key})),this.emitSelTreeHandle()},emitSelTreeHandle:function(){this.$emit("links",this.selectedTree)},init:(m=Object(n.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.$nextTick((function(){t.treeData=Object(u.a)(t.groupList),t.treeData[0].expanded=!0,t.selectedTree.length||(t.selectedTree=Object(u.a)(t.defaultSelected)),t.selectedTree.forEach((function(e){var a=t.treeData.findIndex((function(t){return t.key===e.parentKey})),n=t.treeData[a].children.findIndex((function(t){return t.key===e.key}));t.treeData[a].children[n]=p(p({},t.treeData[a].children[n]),{},{checked:!0})})),e()}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return m.apply(this,arguments)}),confirm:function(){this.$emit("update:loading",!0),this.$emit("ok",this.selectedTree)}},mounted:function(){this.init()}},v=(a("b6fa"),Object(s.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("section",{staticClass:"trees"},[a("section",{staticClass:"tree-left"},[a("h3",[e._v(e._s(e.sourceLabel))]),e._v(" "),a("section",{staticClass:"tree"},[a("div",{staticClass:"input-wrapper"},[a("Input",{attrs:{suffix:"ios-search"},on:{"on-change":e.textChange}})],1),e._v(" "),a("ul",{staticClass:"level-1"},e._l(e.treeData,(function(t,n){return a("li",{key:t.key},[a("span",{staticClass:"hover pointer item caret",class:{expanded:t.expanded},on:{click:function(a){return e.nodeClickHandle(t,"level1")}}},[e._v(e._s(t.title))]),e._v(" "),a("ul",{staticClass:"level-2"},e._l(t.children,(function(t){return a("li",{key:t.key,staticClass:"hover-bg"},[a("span",{staticClass:"hover pointer checkbox item",class:{sel:t.checked},on:{click:function(a){return e.nodeClickHandle(t,"level2",n)}}},[e._v(e._s(t.title))])])})),0)])})),0)])]),e._v(" "),a("section",{staticClass:"tree-arrow"}),e._v(" "),a("section",{staticClass:"tree-right"},[a("h3",[e._v(e._s(e.targetLabel)+"（"+e._s(e.selectedTree.length)+"/ "+e._s(e.maxLength)+"）")]),e._v(" "),a("section",{staticClass:"tree"},[a("ul",e._l(e.selectedTree,(function(t){return a("li",{key:t.key,staticClass:"hover pointer hover-bg",class:{disable:t.disableCancel}},[a("div",[e._v(e._s(t.title))]),e._v(" "),t.disableCancel?e._e():a("div",{staticClass:"icon-close",on:{click:function(a){return e.removeSelTreeHandle(t)}}})])})),0)])])]),e._v(" "),a("div",{staticStyle:{"margin-top":"16px","text-align":"right"}},[a("Button",{on:{click:function(t){return e.$emit("cancel")}}},[e._v("取  消")]),e._v(" "),a("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirm}},[e._v("确  定")])],1)])}),[],!1,null,"a4d6f448",null).exports),b=a("e61f"),y=a("2f62");function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var k={props:["row","tabIndex"],computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(y.e)("roleRelativeData",["userInfo"])),data:function(){return{activeTabName:"activeLine",activeLineColumns:[{title:"时间",key:"actionDate",width:210},{title:"活动轨迹",key:"action",width:160},{title:"标签状态",key:"actionLabel",slot:"actionLabel",width:150},{title:"活跃详情",key:"actionDetail"}],activeLineData:[],talkRecordsColumns:[{title:"时间",key:"createTime",width:210},{title:"沟通主题",key:"taskNames",width:160},{title:"标签状态",key:"labelStatus",slot:"labelStatus",width:300},{title:"意向记录",key:"suggRecords",slot:"suggRecords"},{title:"沟通内容",key:"content"}],talkRecordsData:[],activeLineColorMap:{"活跃行为":"green","预警行为":"red"},talkRecordsColorMap:{0:"green",1:"red"},talkRecordsTextMap:{0:"有效沟通",1:"客户分级A"},errText:{activeLine:"学员活动轨迹",talkRecords:"顾问沟通记录"},activeLine:[],talkRecords:[]}},created:function(){},mounted:function(){this.queryActionTableData()},methods:{handleTabClick:function(e){"activeLine"===e?this.queryActionTableData():this.queryTalkTableData()},queryActionTableData:function(){var e=this,t=this.userInfo.cityCode,a={uid:this.row.uid,areaCode:t,cityCode:t};Object(c.K)(a).then((function(t){e.activeLineData=t})).catch((function(t){e.$Message.error({content:"获取".concat(e.errText[e.activeTabName],":").concat(t.message)})}));var n="";switch(this.tabIndex){case 1:n="纯新学员";break;case 2:n="仅体验学员";break;case 3:n="历史在读学员";break;case 4:n="首缴在读学员";break;case 5:n="多期在读学员"}Object(b.a)("click_6AGxVIVp",{tab_name:n,subtab_name:"行为轨迹"})},queryTalkTableData:function(){var e=this,t=this.getDate(),a=this.userInfo.cityCode,n={pyUid:this.row.uid,cityCode:a,startTime:t[0],endTime:t[1]};Object(c.h)(n).then((function(t){e.talkRecordsData=t})).catch((function(t){e.$Message.error({content:"获取".concat(e.errText[e.activeTabName],":").concat(t.message)})}));var r="";switch(this.tabIndex){case 1:r="纯新学员";break;case 2:r="仅体验学员";break;case 3:r="历史在读学员";break;case 4:r="首缴在读学员";break;case 5:r="多期在读学员"}Object(b.a)("click_6AGxVIVp",{tab_name:r,subtab_name:"沟通记录"})},getDate:function(){var e=new Date,t=new Date(e.getTime()),a=t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds()),n=new Date(e.getTime()-6048e5);return[n.getFullYear()+"-"+(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"-"+(n.getDate()<10?"0"+n.getDate():n.getDate())+" "+(n.getHours()<10?"0"+n.getHours():n.getHours())+":"+(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes())+":"+(n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds()),a]}}},_=(a("a866"),Object(s.a)(k,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content_box"},[a("Tabs",{staticClass:"tabs-list",attrs:{animated:!1,name:"resource"},on:{"on-click":e.handleTabClick},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[a("TabPane",{attrs:{label:"学员活动轨迹",name:"activeLine"}},[a("Table",{attrs:{border:"",height:e.activeLineData&&e.activeLineData.length>0?"290":"100",columns:e.activeLineColumns,data:e.activeLineData},scopedSlots:e._u([{key:"actionLabel",fn:function(t){var n=t.row;return[a("div",[a("Tag",{staticClass:"tagStyle",attrs:{color:e.activeLineColorMap[n.actionLabel]}},[e._v(" "+e._s(n.actionLabel))])],1)]}}])})],1),e._v(" "),a("TabPane",{attrs:{label:"顾问沟通记录",name:"talkRecords"}},[a("Table",{attrs:{border:"",height:e.talkRecordsData&&e.talkRecordsData.length>0?"290":"100",columns:e.talkRecordsColumns,data:e.talkRecordsData},scopedSlots:e._u([{key:"labelStatus",fn:function(t){var n=t.row;return[a("div",[1==n.isEffectiveCommunication?a("Tag",{staticClass:"tagStyle",attrs:{color:"green"}},[e._v("有效沟通")]):e._e(),e._v(" "),n.followTypeName?a("Tag",{staticClass:"tagStyle",attrs:{color:"blue"}},[e._v(e._s(n.followTypeName))]):e._e(),e._v(" "),a("Tag",{staticClass:"tagStyle",attrs:{color:"red"}},[e._v(" "+e._s("客户分级"+n.customerLevel))])],1)]}},{key:"suggRecords",fn:function(t){var n=t.row;return[a("div",[a("span",[e._v(e._s("意向教师:"+(n.intentedTeacher?n.intentedTeacher:"")+";意向学科:"+(n.intendedSubject?n.intendedSubject:"")+";意向班级:"+(n.intendedClassType?n.intendedClassType:"")))])])]}}])})],1)],1)],1)}),[],!1,null,"26f5c9c4",null).exports);function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S,x={props:{deptid:{type:String,default:function(){return""}},formData:Object,totalNum:Number},data:function(){return{statusMap:{1:"处理中",2:"分配成功",3:"分配失败"},addForm:{operateEmpNo:null},tableData:[],detailModal:!1,detailList:[],searchData:{pageNo:1,pageSize:10},operateSearch:{pageNo:1,pageSize:10},detailForm:{status:null,name:""},operateUserList:[],tableLoading:!1,splitStatus:{1:"处理中",2:"处理完成",3:"处理失败"}}},computed:C(C({},Object(y.e)("roleRelativeData",["userInfo"])),{},{dialogVisible:function(){return"records"===this.$store.state.resource.identity},empNo:function(){return this.$store.state.user.userInfo.empNo},getRole:function(){return function(e){return(e.operateCityName?e.operateCityName+"-":"")+(e.operateAreaName?e.operateAreaName:"")+(e.operateServiceCenterName?e.operateServiceCenterName+"-":"")+(e.operateRoleName?e.operateRoleName:"")}}}),methods:{queryOperation:function(e){var t=this;if(e){var a={cityCode:this.userInfo.cityCode};Object(c.o)(a).then((function(e){t.operateUserList=e})).catch((function(e){t.$Message.error(e.message)}))}},getDispatchDetail:function(e){this.currentDispatchId=e,this.detailForm={status:null,name:""},this.queryDetailInfo()},queryDetailInfo:function(){var e=this;Object(c.i)(C(C(C({},this.detailForm),this.searchData),{},{dispatchId:this.currentDispatchId,cityCode:this.userInfo.cityCode})).then((function(t){e.detailList=t,e.detailModal=!0})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},getLogList:function(e,t){var a=this;1===t&&(this.operateSearch={pageNo:1,pageSize:10});var n=C({empNo:this.empNo,operateEmpNo:e,areaCode:this.userInfo.cityCode,cityCode:this.userInfo.cityCode},this.operateSearch);this.tableLoading=!0,Object(c.j)(n).then((function(e){a.tableData=e,a.tableLoading=!1})).catch((function(e){a.tableLoading=!1,a.$Message.error({content:"获取数据失败："+e.message})}))},closeDialog:function(){this.$store.commit("resource/setIdentity",""),this.$store.commit("resource/setDialogType",""),this.$store.commit("resource/setmultipleSelection",[])},clearForm:function(){this.addForm={operateEmpNo:null}},handleClose:function(e){this.closeDialog(),e()},handleSizeChange:function(e){this.searchData.pageSize=e,this.queryDetailInfo()},handleCurrentChange:function(e){this.searchData.pageNo=e,this.queryDetailInfo()},handleSizeChangeOpr:function(e){this.operateSearch.pageSize=e,this.getLogList(this.addForm.operateEmpNo)},handleCurrentChangeOpr:function(e){this.operateSearch.pageNo=e,this.getLogList(this.addForm.operateEmpNo)},closeDia:function(e){this.searchData={pageNo:1,pageSize:10},this.operateSearch={pageNo:1,pageSize:10},this.$refs.detailFormref.resetFields(),this.detailForm.status=null,e()},searchDetail:function(){this.queryDetailInfo()}}},T=(a("4f20"),Object(s.a)(x,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData.records}},[a("el-table-column",{attrs:{prop:"createDate",label:"发起时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v("\n            "+e._s(""+(n.createDate?n.createDate:"--"))+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作人",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v("\n            "+e._s(""+(n.operateName?n.operateName:"--"))+"\n          ")]),e._v(" "),a("p",[e._v(e._s("("+e.getRole(n)+")"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"typeName",width:"180",label:"接收方",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"分配状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"margin-right":"10px"}},[a("span",{class:3===Number(t.row.status)?"icon_status red":"icon_status green"}),e._v("\n              "+e._s(2===t.row.status?"处理完成":3===t.row.status?"处理失败":"处理中"))]),e._v(" "),a("a",{on:{click:function(a){return e.getDispatchDetail(t.row.id)}}},[e._v("查看明细")])]),e._v(" "),a("div",[e._v("\n            "+e._s("（成功"+t.row.successNum+"人，失败"+t.row.failNum+"人）")+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"completeTime",label:"完成时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v("\n            "+e._s(""+(n.completeTime?n.completeTime:"--"))+"\n          ")])]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{"current-page":e.tableData.pageNo,"page-sizes":[10,20],"page-size":e.tableData.pageSize,total:e.tableData.totalCount,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChangeOpr,"current-change":e.handleCurrentChangeOpr}}),e._v(" "),a("el-dialog",{attrs:{title:"分配明细",visible:e.detailModal,"append-to-body":"","before-close":e.closeDia,width:"60%"},on:{"update:visible":function(t){e.detailModal=t}}},[a("el-form",{ref:"detailFormref",attrs:{inline:!0,model:e.detailForm,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"分配状态："}},[a("el-select",{model:{value:e.detailForm.status,callback:function(t){e.$set(e.detailForm,"status",t)},expression:"detailForm.status"}},[a("el-option",{attrs:{value:null,label:"全部"}}),e._v(" "),e._l(Object.keys(e.splitStatus),(function(t,n){return a("el-option",{key:n,attrs:{label:e.splitStatus[t],value:String(t)}})}))],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名："}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.detailForm.name,callback:function(t){e.$set(e.detailForm,"name",t)},expression:"detailForm.name"}})],1),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.searchDetail}},[e._v("查询")])],1),e._v(" "),a("br"),e._v(" "),e.detailList&&e.detailList.records&&e.detailList.records.length>0?a("div",{staticStyle:{"justify-content":"flex-end",display:"flex","flex-direction":"column","align-items":"flex-end"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.detailList.records}},[a("el-table-column",{attrs:{prop:"pyUid",label:"学员编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"studentName",label:"学员姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"分配状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.statusMap[t.row.status]))]),e._v(" "),t.row.failMsg?a("span",[e._v("- "+e._s(t.row.failMsg))]):e._e()]}}],null,!1,1518361907)}),e._v(" "),a("el-table-column",{attrs:{prop:"createDate",label:"实际分配时间"}})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.detailList.pageNo,"page-sizes":[10,20],"page-size":e.detailList.pageSize,total:e.detailList.totalCount,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):a("div",{staticClass:"noText"},[e._v("暂无数据")])],1)],1)}),[],!1,null,"288a4192",null).exports),I={inject:["parent"],props:{distributeType:{type:Number,default:1},acceptType:{type:Number,default:0},isLast:Boolean,leftNum:Number},computed:{cityName:function(){var e=this,t=this.cityList.filter((function(t){return t.id===e.formData.cityId}))[0];return t?t.deptName:""},centerName:function(){var e=this,t=this.serverList.filter((function(t){return t.id===e.formData.centerId}))[0];return t?t.deptName:""},adviserName:function(){var e=this,t=this.adviserList.filter((function(t){return t.identityId===e.formData.adviserId}))[0];return t?t.userName:""}},data:function(){return{formData:{cityId:null,areaId:null,centerId:null,adviserId:null,num:null},rules:{cityId:[{required:!0,message:"内容不能为空"}],areaId:[{required:!0,message:"内容不能为空"}],centerId:[{required:!0,message:"内容不能为空"}],adviserId:[{required:!0,message:"内容不能为空"}],num:[{required:!0,message:"内容不能为空",trigger:"blur",type:"number"},{validator:this.leftNumValidator,trigger:"blur"}]},cityList:[],areaList:[],serverList:[],adviserList:[]}},mounted:function(){this.getCityList()},methods:{leftNumValidator:function(e,t,a){var n=this.parent.getLeftNum(this.distributeType);return t>n&&this.isLast?a(new Error("数量超出限额")):t<n&&this.isLast&&a(new Error("资源未分配完")),!0},validateField:function(){this.formData.num>0&&this.$refs.form.validateField("num")},validate:(S=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.form.validate();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)}),getAreaCodeByCityCode:function(e){var t=this.cityList.filter((function(t){return t.id===e}))[0];if(t)return t.deptCode},getCityList:function(){var e=this;Object(c.D)({departId:Number(10),departType:""}).then((function(t){e.cityList=t.filter((function(e){return 10!==e.deptType}))})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},getAreaList:function(e){var t=this;Object(c.D)({departId:e,departType:""}).then((function(e){t.areaList=e,t.adviserList=[],t.serverList=[]})).catch((function(e){t.$Message.error({content:"获取数据失败："+e.message})}))},getAdviserList:function(){var e=this;Object(c.r)({areaCode:this.getAreaCodeByCityCode(this.formData.cityId),roleId:5,deptId:this.formData.centerId}).then((function(t){e.adviserList=t.filter((function(t){return t.empNo!==e.empNo}))})).catch((function(t){e.$Message.error({content:"获取数据失败："+t.message})}))},getCenterList:function(e){var t=this;Object(c.D)({departId:e,departType:""}).then((function(e){t.serverList=e,t.adviserList=[]})).catch((function(e){t.$Message.error({content:"获取数据失败："+e.message})}))}}};a("2dc58");function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L,R,j={name:"resourceDistributeModal",components:{ResourceRecordSearch:T,ResourceDistributeForm:Object(s.a)(I,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Form",{ref:"form",staticClass:"detail_form",attrs:{model:e.formData,inline:"",rules:e.rules}},[a("div",{staticClass:"dist_detail_item"},[a("span",{staticStyle:{"margin-right":"16px"}},[e._v("接收方")]),e._v(" "),a("FormItem",{attrs:{prop:"cityId"}},[a("Select",{attrs:{filterable:"",placeholder:"城市："},on:{"on-change":e.getAreaList},model:{value:e.formData.cityId,callback:function(t){e.$set(e.formData,"cityId",t)},expression:"formData.cityId"}},e._l(e.cityList,(function(e,t){return a("Option",{key:t,attrs:{label:e.deptName,value:e.id}})})),1)],1),e._v(" "),1!==e.acceptType?a("FormItem",{attrs:{prop:"areaId"}},[a("Select",{attrs:{filterable:"",placeholder:"区域："},on:{"on-change":e.getCenterList},model:{value:e.formData.areaId,callback:function(t){e.$set(e.formData,"areaId",t)},expression:"formData.areaId"}},e._l(e.areaList,(function(e,t){return a("Option",{key:t,attrs:{label:e.deptName,value:e.id}})})),1)],1):a("FormItem"),e._v(" "),1!==e.acceptType?a("FormItem",{attrs:{prop:"centerId"}},[a("Select",{attrs:{filterable:"",placeholder:"服务中心："},on:{"on-change":e.getAdviserList},model:{value:e.formData.centerId,callback:function(t){e.$set(e.formData,"centerId",t)},expression:"formData.centerId"}},e._l(e.serverList,(function(e,t){return a("Option",{key:t,attrs:{label:e.deptName,value:e.id}})})),1)],1):a("FormItem"),e._v(" "),3===e.acceptType?a("FormItem",{attrs:{prop:"adviserId"}},[a("Select",{attrs:{filterable:"",placeholder:"顾问："},model:{value:e.formData.adviserId,callback:function(t){e.$set(e.formData,"adviserId",t)},expression:"formData.adviserId"}},e._l(e.adviserList,(function(e,t){return a("Option",{key:t,attrs:{label:e.userName,value:e.identityId}})})),1)],1):a("FormItem",{staticStyle:{width:"110px"}}),e._v(" "),a("span",{staticStyle:{"margin-right":"16px","margin-left":"40px"}},[e._v(e._s(1===e.distributeType?"资源数量":"资源百分比"))]),e._v(" "),a("FormItem",{staticStyle:{width:"80px"},attrs:{prop:"num"}},[0===e.distributeType?a("InputNumber",{staticStyle:{width:"80px"},attrs:{precision:0,placeholder:e.leftNum+"",max:100},on:{input:function(t){return e.$emit("change")}},model:{value:e.formData.num,callback:function(t){e.$set(e.formData,"num",t)},expression:"formData.num"}}):a("InputNumber",{staticStyle:{width:"80px"},attrs:{precision:0,placeholder:e.leftNum+"",max:e.leftNum},on:{input:function(t){return e.$emit("change")}},model:{value:e.formData.num,callback:function(t){e.$set(e.formData,"num",t)},expression:"formData.num"}})],1),e._v(" "),a("span",{staticStyle:{"margin-right":"30px"}},[e._v(e._s(0===e.distributeType?"%":"人"))]),e._v(" "),a("Icon",{staticClass:"icon_delete",attrs:{type:"ios-trash-outline"},on:{click:function(t){return e.$emit("delete")}}})],1)])}),[],!1,null,"18f3f2df",null).exports},provide:function(){return{parent:this}},props:{pyUids:{type:Array,default:function(){return[]}},searchParams:{type:Object,default:function(){return{}}},tabIndex:{type:Number,default:0},fullNum:{type:Number,default:0}},watch:{"formData.modal":{deep:!0,handler:function(){var e=this;this.handleNumChange(),this.addForm.forEach((function(t){e.$refs[t.ref]&&(e.$refs[t.ref][0].formData.num=null,t.leftNum="0"===e.formData.modal?100:e.pyUids.length||e.fullNum)}))}},activeTabName:function(e){"distributeRecords"===e&&this.$refs.rrs.getLogList(null,1)}},data:function(){return{activeTabName:"resourceDistr",formData:{modal:"1"},detailForm:!1,areaList:[],cityList:[],serverList:[],adviserList:[],dialogVisible:!1,addForm:[],resetNum:100,currentIndex:"",comfirmDist:!1,isDistributeOver:!1,loading:!1,confirmParams:[],tipText:'"百分比分配"模式下，计算数据向上取整，可能会造成最后接收方，接收数量比预期少。例如：总计 5个学员待分配，分别为：50%，25%，25%，分配三个接收方，则三个接收方，接收资源数，分别为：3，2，0个资源。',isSuccess:!1}},computed:O(O({},Object(y.e)("roleRelativeData",["userInfo"])),{},{areaCode:function(){return function(e){var t=this.cityList.find((function(t){return String(t.id)===e}));return t?t.deptCode:""}}}),methods:{distributeOver:function(){var e=this,t=0;t="0"===this.formData.modal?100:this.pyUids.length||this.fullNum,this.addForm.forEach((function(a){e.$refs[a.ref]&&(t-=e.$refs[a.ref][0].formData.num)})),console.log("left 判断是佛超出限制",this.formData.modal,this.pyUids.length,t),this.isDistributeOver=t<=0},handleNumChange:function(){this.distributeOver();var e=this.getLeftNum();if(this.addForm.length){this.addForm[this.addForm.length-1].leftNum=e>0?e:0;var t=this.addForm[this.addForm.length-1];this.$refs[t.ref][0].validateField()}},getLeftNum:function(e){var t=this,a=0;return a="0"===this.formData.modal||"0"===e?100:this.pyUids.length||this.fullNum,this.addForm.forEach((function(e,n){n!==t.addForm.length-1&&(a-=t.$refs[e.ref][0].formData.num)})),a<0?0:a},handleDistributeDetail:function(e){this.addForm.push({acceptType:Number(e),leftNum:this.getLeftNum(),ref:"ref"+Date.now()})},handleDelete:function(e){this.addForm.splice(e,1),this.distributeOver()},handleConfirm:(R=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.formData.crmRoleId=this.userInfo.crmRoleId,this.formData.crmDeptId=this.userInfo.crmDeptId,this.formData.baseDataId=this.userInfo.baseDataId,(t=Object.assign({},this.searchParams,this.formData,{card:this.searchParams.stuLoginName})).belongIdentityId=t.belongIdentityIdByStop||t.belongIdentityIdByPerson,a="",e.t0=this.tabIndex,e.next=1===e.t0?10:2===e.t0?12:3===e.t0?14:4===e.t0?16:5===e.t0?18:20;break;case 10:return a="纯新学员",e.abrupt("break",20);case 12:return a="仅体验学员",e.abrupt("break",20);case 14:return a="历史在读学员",e.abrupt("break",20);case 16:return a="首缴在读学员",e.abrupt("break",20);case 18:return a="多期在读学员",e.abrupt("break",20);case 20:return t.stuLevel=a,this.loading=!0,n=O({targetList:this.confirmParams,cityCode:this.userInfo.cityCode,areaCode:this.userInfo.cityCode,operateEmpNo:this.userInfo.empNo,pyUidList:this.pyUids},t),e.next=25,Object(c.e)(n);case 25:this.$Message.success("分配成功"),this.$emit("success"),this.isSuccess=!0,this.activeTabName="distributeRecords",e.next=34;break;case 31:e.prev=31,e.t1=e.catch(0),this.$Message.error({content:"资源分配失败: "+e.t1.message,duration:5});case 34:this.loading=!1,Object(b.a)("click_eDGdU5nk",{num:this.addForm.length,module_name:"0"===this.formData.modal?"百分比":"数量",tab_name:stuLevel,user_num:this.pyUids.length,button_type:this.pyUids.length?0:1});case 36:case"end":return e.stop()}}),e,this,[[0,31]])}))),function(){return R.apply(this,arguments)}),handleSubmit:(L=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a,n,r,i,s,o,l,u,d,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,a=[],n=0;case 3:if(!(n<this.addForm.length)){e.next=26;break}return r=this.addForm[n],i=this.$refs[r.ref][0],e.next=8,i.validate();case 8:(s=e.sent)||(t=s),o=i.acceptType,l=i.formData.num,u=void 0,e.t0=o,e.next=3===e.t0?16:2===e.t0?18:1===e.t0?20:22;break;case 16:return u=i.formData.adviserId,e.abrupt("break",22);case 18:return u=i.formData.centerId,e.abrupt("break",22);case 20:return u=i.formData.cityId,e.abrupt("break",22);case 22:1===i.distributeType?a.push({targetId:u,dispatchCount:l,type:o,distributeType:i.distributeType,cityName:i.cityName,centerName:i.centerName,adviserName:i.adviserName}):a.push({targetId:u,rate:(l/100).toFixed(2),type:o,distributeType:i.distributeType,cityName:i.cityName,centerName:i.centerName,adviserName:i.adviserName});case 23:n++,e.next=3;break;case 26:if(!t){e.next=39;break}return d={targetList:a,cityCode:this.userInfo.cityCode,areaCode:this.userInfo.cityCode,operateEmpNo:this.userInfo.empNo,pyUidList:this.pyUids},e.prev=28,e.next=31,Object(c.R)(d);case 31:p=e.sent,this.comfirmDist=!0,this.confirmParams=p.targetList,e.next=39;break;case 36:e.prev=36,e.t1=e.catch(28),this.$Message.error({content:"分配失败: "+e.t1.message,duration:5});case 39:case"end":return e.stop()}}),e,this,[[28,36]])}))),function(){return L.apply(this,arguments)}),changeNum:function(e,t,a){this.currentIndex=a},open:function(){this.dialogVisible=!0,this.isSuccess=!1,this.isDistributeOver=!1},handleClose:function(){this.addForm=[],this.dialogVisible=!1,this.isSuccess&&this.$emit("close"),Object.assign(this.$data,this.$options.data())}}},M=(a("05e5"),Object(s.a)(j,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Modal",{staticClass:"resource-distribute",attrs:{title:"资源分配",closable:!1,"mask-closable":!1,width:"960"},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}},[a("Tabs",{staticClass:"tabs_list",attrs:{animated:!1,name:"resource"},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[a("TabPane",{attrs:{label:"资源分配",name:"resourceDistr"}},[a("Form",{staticClass:"form-container",attrs:{model:e.formData,"label-width":90}},[a("FormItem",{attrs:{label:"资源人数",prop:"gender"}},[a("span",{staticStyle:{transform:"translate(0, 5px)"}},[e._v(e._s(e.pyUids.length||e.fullNum)+" 人")])]),e._v(" "),a("FormItem",{attrs:{label:"分配模式",prop:"gender"}},[a("RadioGroup",{model:{value:e.formData.modal,callback:function(t){e.$set(e.formData,"modal",t)},expression:"formData.modal"}},[a("Tooltip",{attrs:{transfer:!0,placement:"top","max-width":"250",content:e.tipText}},[a("Radio",{attrs:{label:"0"}},[e._v("百分比分配")])],1),e._v(" "),a("Radio",{attrs:{label:"1"}},[e._v("数量分配")])],1)],1),e._v(" "),a("FormItem",{attrs:{label:"分配详情",prop:"gender"}},[a("div",{staticClass:"dist_detail"},[a("div",{staticClass:"table_header"},[a("div",e._l(e.addForm,(function(t,n){return a("ResourceDistributeForm",{key:n,ref:t.ref,refInFor:!0,attrs:{distributeType:Number(e.formData.modal),acceptType:t.acceptType,isLast:n===e.addForm.length-1,leftNum:t.leftNum},on:{delete:function(t){return e.handleDelete(n)},change:e.handleNumChange}})})),1),e._v(" "),!e.isDistributeOver&&e.addForm.length<10?a("div",[a("Dropdown",{attrs:{trigger:"click",transfer:""},on:{"on-click":e.handleDistributeDetail}},[a("Button",{attrs:{type:"primary",ghost:"",icon:"md-add"}},[e._v("添加")]),e._v(" "),a("DropdownMenu",{attrs:{slot:"list",transfer:""},slot:"list"},[a("DropdownItem",{attrs:{name:"1"}},[e._v("城市")]),e._v(" "),a("DropdownItem",{attrs:{name:"2"}},[e._v("服务中心")]),e._v(" "),a("DropdownItem",{attrs:{name:"3"}},[e._v("顾问")])],1)],1)],1):e._e()])])]),e._v(" "),a("Alert",{attrs:{type:"warning","show-icon":""}},[e._v("确定分配后，操作无法撤销，请仔细检查分配信息")])],1)],1),e._v(" "),a("TabPane",{attrs:{label:"分配记录",name:"distributeRecords"}},[a("ResourceRecordSearch",{ref:"rrs"})],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{loading:e.loading},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:"resourceDistr"===e.activeTabName,expression:"activeTabName === 'resourceDistr'"}],attrs:{type:"primary",disabled:0===e.addForm.length,loading:e.loading},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1),e._v(" "),a("Modal",{attrs:{title:"确认分配",closable:!1,"ok-text":"确认分配"},on:{"on-ok":e.handleConfirm},model:{value:e.comfirmDist,callback:function(t){e.comfirmDist=t},expression:"comfirmDist"}},e._l(e.confirmParams,(function(t,n){return a("Row",{key:n,staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex",align:"middle"}},[a("Col",{staticClass:"f-14",attrs:{span:3}},[e._v("接收方：")]),e._v(" "),1===t.type?a("Col",{attrs:{span:8}},[e._v(e._s(t.cityName))]):e._e(),e._v(" "),2===t.type?a("Col",{attrs:{span:8}},[e._v(e._s(t.centerName))]):e._e(),e._v(" "),3===t.type?a("Col",{attrs:{span:8}},[e._v(e._s(t.adviserName))]):e._e(),e._v(" "),"0"===e.formData.modal?a("Col",{attrs:{span:3}},[e._v(e._s(100*t.rate)+"%")]):e._e(),e._v(" "),a("Col",{attrs:{span:3}},[e._v(e._s(t.dispatchCount)+"人")])],1)})),1)],1)}),[],!1,null,"3fcf8936",null).exports);function $(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var A,P={name:"ResourceTable",components:{GroupTransfer:v,ResourceDstributeModal:M},mixins:[a("0ef6").a],props:{tabIndex:{type:Number,default:0},resourceCondition:{type:Object,default:function(){return{}}},searchParams:{type:Object,default:function(){return{}}}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(y.e)("roleRelativeData",["userInfo"])),watch:{tabIndex:function(){this.resetTableConfig(),this.initTableHeaders(),this.search()},userInfo:function(e){e.cityCode&&(this.getSubjectList(),this.getTableData())},resourceCondition:function(e){if(e&&e.gradeList){var t=[{value:99,label:"未填写"}].concat(e.gradeList.map((function(e){return{value:e.id,label:e.name}})));this.columnTemp.find((function(e){return"gradeName"===e.key})).filters=t}e&&e.userTagList&&(this.columnTemp.find((function(e){return"repeatTagName"===e.key})).filters=e.userTagList.map((function(e){return{value:e.id,label:e.name}}))),e&&e.readStatusList&&(this.columnTemp.find((function(e){return"readStatusName"===e.key})).filters=e.readStatusList.map((function(e){return{value:e.id,label:e.name}}))),e&&e.customActiveStatusList&&(this.columnTemp.find((function(e){return"activeStatusName"===e.key})).filters=e.customActiveStatusList.map((function(e){return{value:e.id,label:e.name}}))),e&&e.customLevel&&(this.columnTemp.find((function(e){return"customerLevel"===e.key})).filters=e.customLevel.map((function(e){return{value:e.name,label:e.name}}))),e&&e.inviteStatus&&(this.columnTemp.find((function(e){return"yearIsInvite"===e.key})).filters=e.inviteStatus.map((function(e){return{value:e.name,label:e.name}}))),e&&e.userCurrentState&&(this.columnTemp.find((function(e){return"userCurrentState"===e.key})).filters=e.userCurrentState.map((function(e){return{value:e.name,label:e.name}}))),e&&e.userNextState&&(this.columnTemp.find((function(e){return"userNextState"===e.key})).filters=e.userNextState.map((function(e){return{value:e.name,label:e.name}}))),e&&e.userNextNextState&&(this.columnTemp.find((function(e){return"userNextNextState"===e.key})).filters=e.userNextNextState.map((function(e){return{value:e.name,label:e.name}}))),e&&e.distributeStatusList&&(this.columnTemp.find((function(e){return"belongStatus"===e.key})).filters=e.distributeStatusList.map((function(e){return{value:e.id,label:e.name}}))),this.userInfo.empNo&&this.initTableHeaders()}},data:function(){var e=this;return{selectedCols:[],customHeaderShow:!1,formData:{pageSize:50,pageNo:1,gradeId:"",yearIsInvite:"",userTag:"",readStatus:"",activeStatus:"",customLevel:"",payFirstSubId:"",readSubLastYearIds:[],payLastTermName:"",curReadSubIds:[],stuLevel:"",userCurrentState:"",userNextState:"",userNextNextstate:""},tableData:[],totalCount:0,columnTemp:[{title:"学员编码",key:"card",width:140,disableCancel:!0,parentKey:0},{title:"学员姓名",key:"stuRealName",disableCancel:!0,parentKey:0,render:function(t,a){return t("a",{on:{click:function(){e.goCustomerDetail(a.row);var t="全部资源";switch(e.tabIndex){case 1:t="纯新学员";break;case 2:t="仅体验学员";break;case 3:t="历史在读学员";break;case 4:t="首缴在读学员";break;case 5:t="多期在读学员"}Object(b.a)("click_fAwibDLZ",{tab_name:t})}}},a.row.stuRealName||"--")}},{title:"联系电话",key:"stuMobile",width:140,parentKey:0,render:function(e,t){return e("TalDecodeText",{props:{uid:t.row.uid,encodeText:t.row.stuMobile,type:"phone"}})}},{title:"当前年级",key:"gradeName",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.gradeId=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:0},{title:"加微状态",key:"weixinAddStatus",parentKey:0,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"被任意顾问添加微信即为已添加",transfer:!0}},"加微状态")},render:function(e,t){var a=[e("div",{style:{width:"6px",height:"6px",borderRadius:"50%",marginRight:"8px",background:"已添加"===t.row.weixinAddStatus?"#32C730":"#EB4244"}},""),e("div",{},t.row.weixinAddStatus)];return e("div",{style:{display:"flex",alignItems:"center"}},a)}},{title:"在读学校",key:"readSchool",parentKey:0,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"当前就读学校",transfer:!0}},"在读学校")}},{title:"班级情况",key:"classTypeName",parentKey:0},{title:"注册渠道",key:"regWay",parentKey:0},{title:"注册时间",key:"registeredDate",width:155,sortable:"custom",parentKey:0},{title:"注册分校",key:"cityName",parentKey:0},{title:"绑定状态",key:"bindStatusName",parentKey:3,filterMultiple:!1,filterRemote:function(t,a){e.formData.bindStatus=t[0],e.formData.pageNo=1,e.getTableData()},render:function(e,t){var a=[e("div",{style:{width:"6px",height:"6px",borderRadius:"50%",marginRight:"8px",background:2===t.row.bindStatus?"#32C730":"#EB4244"}},""),e("div",{},t.row.bindStatusName)];return e("div",{style:{display:"flex",alignItems:"center"}},a)}},{title:"近一年老带新次数",key:"inviteCount",align:"right",sortable:"custom",parentKey:0},{title:"近一年是否老带新",key:"yearIsInvite",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.yearIsInvite=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:0,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"近一年内在老带新产品的邀请关系中是被邀请人身份",transfer:!0}},"近一年是否老带新")}},{title:"用户标签",key:"repeatTagName",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.userTag=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:0,render:function(t,a){var n=a.row.repeatTagName?a.row.repeatTagName.map((function(a,n){return t("Tag",{props:{color:e.colors[n]}},a)})):"";return t("div",{},n)}},{title:"在读状态",key:"readStatusName",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.readStatus=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:1},{title:"绑定人",key:"consultant",parentKey:3},{title:"客户状态",key:"activeStatusName",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.activeStatus=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:0},{title:"归属类型",key:"belongDeptTypeName",parentKey:3},{title:"归属",key:"belongDeptName",parentKey:3},{title:"当期报名学科数",key:"curRegCount",align:"right",sortable:"custom",parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"当前学期学员报名长期班的科目总数",transfer:!0}},"当期报名学科数")}},{title:"长期班总缴费次数",key:"longTermPayCount",align:"right",sortable:"custom",parentKey:1},{title:"维护次数",key:"followNum",align:"right",sortable:"custom",parentKey:3},{title:"最后分配时间",key:"belongFromDate",sortable:"custom",parentKey:3},{title:"最后维护内容",key:"content",parentKey:3},{title:"最后维护时间",key:"followLastestDate",sortable:"custom",parentKey:3},{title:"客户分级",key:"customerLevel",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.customLevel=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:0},{title:"首次净缴日期",key:"payFirstTermDate",sortable:"custom",parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"首次长期班净缴费日期",transfer:!0}},"首次净缴日期")}},{title:"首次净缴学科",key:"payFirstSubName",parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"首次长期班净缴费学科",transfer:!0}},"首次净缴学科")}},{title:"首次净缴学期",key:"payFirstTermName",parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"首次长期班净缴费学期",transfer:!0}},"首次净缴学期")}},{title:"近一年在读学科",key:"lastYearReadSubNames",filters:[],filterRemote:function(t,a){e.formData.readSubLastYearIds=t,e.formData.pageNo=1,e.getTableData()},parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"最近一年在读过的长期班学科",transfer:!0}},"近一年在读学科")},render:function(t,a){var n=a.row.lastYearReadSubNames?a.row.lastYearReadSubNames.map((function(a,n){return t("Tag",{props:{color:e.colors[n]}},a)})):"";return t("div",{},n)}},{title:"长期班报名次数",key:"longTermRegCount",align:"right",sortable:"custom",parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"累计报名长期班总次数",transfer:!0}},"长期班报名次数")}},{title:"培优微信群数量",key:"pyGroupCount",align:"right",sortable:"custom",parentKey:2},{title:"近一年平均出勤率",key:"attendanceRate",align:"right",sortable:"custom",parentKey:4,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"近一年内平均长期班出勤率（出勤次数/总课次）",transfer:!0}},"近一年平均出勤率")}},{title:"近30日体验行为",key:"expBehaviorThirty",parentKey:2,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"近30日有出勤过的体验课类别。包括诊断、试听、体验课、短期班",transfer:!0}},"近30日体验行为")},render:function(t,a){var n=a.row.expBehaviorThirty?a.row.expBehaviorThirty.map((function(a,n){return t("Tag",{props:{color:e.colors[n]}},a)})):"";return t("div",{},n)}},{title:"近7日活跃行为",key:"activeBehaviorSeven",parentKey:2,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"近7日有出现过的活跃行为",transfer:!0}},"近7日活跃行为")},render:function(t,a){var n=a.row.activeBehaviorSeven?a.row.activeBehaviorSeven.map((function(a,n){return t("Tag",{props:{color:e.colors[n]}},a)})):"";return t("div",{},n)}},{title:"最近一次缴费学期",key:"payLastTermName",parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"最近一次报名并缴费长期班的所属学期",transfer:!0}},"最近一次缴费学期")}},{title:"累计报名学科数",key:"regSubAddSum",align:"right",sortable:"custom",parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"累计报名长期班科目数总数",transfer:!0}},"累计报名学科数")}},{title:"当期在读学科",key:"curReadSubNames",filters:[],filterRemote:function(t,a){e.formData.curReadSubIds=t,e.formData.pageNo=1,e.getTableData()},parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"长期班当期在读的学科",transfer:!0}},"当期在读学科")},render:function(t,a){var n=a.row.curReadSubNames?a.row.curReadSubNames.map((function(a,n){return t("Tag",{props:{color:e.colors[n]}},a)})):"";return t("div",{},n)}},{title:"累计退费次数",key:"refundAddSum",align:"right",sortable:"custom",parentKey:1,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"用户累计长期班退费次数",transfer:!0}},"累计退费次数")}},{title:"用户分层",key:"stuLevel",parentKey:5},{title:"最近一次浏览长期班日期",key:"browseLongTermdate",parentKey:0,renderHeader:function(e){return e("Tooltip",{props:{placement:"bottom",maxWidth:"200",content:"用户在APP、小程序最近一次浏览长期详情页的日期",transfer:!0}},"最近一次浏览长期班日期")}},{title:"当期用户状态",key:"userCurrentState",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.userCurrentState=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:5},{title:"下期用户状态",key:"userNextState",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.userNextState=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:5},{title:"下下期用户状态",key:"userNextNextState",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.userNextNextState=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:5},{title:"绑定时间",key:"belongIdentityFromDate",sortable:"custom",parentKey:0},{title:"分配状态",key:"belongStatus",filters:[],filterMultiple:!1,filterRemote:function(t,a){e.formData.belongStatus=t[0],e.formData.pageNo=1,e.getTableData()},parentKey:0,render:function(e,t){var a=[e("div",{style:{width:"6px",height:"6px",borderRadius:"50%",marginRight:"8px",background:"2"===String(t.row.belongStatus)?"#32C730":"#EB4244"}},""),e("div",{},"2"===String(t.row.belongStatus)?"已分配":"未分配")];return e("div",{style:{display:"flex",alignItems:"center"}},a)}}],defaultColumns:[],columns:[],preColumns:[{type:"selection",width:60,align:"center"},{type:"expand",width:50,render:function(t,a){return t(_,{props:{row:a.row,tabIndex:e.tabIndex}})}}],columnTempList:[[{title:"学员编码",key:"card"},{title:"学员姓名",key:"stuRealName"},{title:"联系电话",key:"stuMobile"},{title:"当前年级",key:"gradeName"},{title:"注册渠道",key:"regWay"},{title:"加微状态",key:"weixinAddStatus"},{title:"客户分级",key:"customerLevel"},{title:"绑定状态",key:"bindStatusName"},{title:"分配状态",key:"belongStatus"},{title:"绑定人",key:"consultant"},{title:"最后维护时间",key:"followLastestDate"}],[{title:"学员编码",key:"card"},{title:"学员姓名",key:"stuRealName"},{title:"联系电话",key:"stuMobile"},{title:"当前年级",key:"gradeName"},{title:"注册时间",key:"registeredDate"},{title:"注册渠道",key:"regWay"},{title:"加微状态",key:"weixinAddStatus"},{title:"注册分校",key:"cityName"},{title:"最后维护时间",key:"followLastestDate"},{title:"维护次数",key:"followNum"}],[{title:"学员编码",key:"card"},{title:"学员姓名",key:"stuRealName"},{title:"联系电话",key:"stuMobile"},{title:"当前年级",key:"gradeName"},{title:"注册时间",key:"registeredDate"},{title:"近7日活跃行为",key:"activeBehaviorSeven"},{title:"近30日体验行为",key:"expBehaviorThirty"},{title:"最后维护时间",key:"followLastestDate"},{title:"维护次数",key:"followNum"}],[{title:"学员编码",key:"card"},{title:"学员姓名",key:"stuRealName"},{title:"联系电话",key:"stuMobile"},{title:"当前年级",key:"gradeName"},{title:"近一年在读学科",key:"lastYearReadSubNames"},{title:"最近一次缴费学期",key:"payLastTermName"},{title:"近7日活跃行为",key:"activeBehaviorSeven"},{title:"维护次数",key:"followNum"},{title:"累计报名学科数",key:"regSubAddSum"},{title:"最后维护时间",key:"followLastestDate"}],[{title:"学员编码",key:"card"},{title:"学员姓名",key:"stuRealName"},{title:"联系电话",key:"stuMobile"},{title:"当前年级",key:"gradeName"},{title:"首次净缴日期",key:"payFirstTermDate"},{title:"培优微信群数量",key:"pyGroupCount"},{title:"首次净缴学科",key:"payFirstSubName"},{title:"当期报名学科数",key:"curRegCount"},{title:"近一年平均出勤率",key:"attendanceRate"},{title:"最后维护时间",key:"followLastestDate"}],[{title:"学员编码",key:"card"},{title:"学员姓名",key:"stuRealName"},{title:"联系电话",key:"stuMobile"},{title:"当前年级",key:"gradeName"},{title:"最近一次缴费学期",key:"payLastTermName"},{title:"老带新次数",key:"inviteCount"},{title:"累计报名学科数",key:"regSubAddSum"},{title:"近一年在读学科",key:"lastYearReadSubNames"},{title:"当期在读学科",key:"curReadSubNames"},{title:"最后维护时间",key:"followLastestDate"}],[{title:"学员编码",key:"card"},{title:"学员姓名",key:"stuRealName"},{title:"联系电话",key:"stuMobile"},{title:"当前年级",key:"gradeName"},{title:"注册渠道",key:"regWay"},{title:"加微状态",key:"weixinAddStatus"},{title:"客户分级",key:"customerLevel"},{title:"绑定状态",key:"bindStatusName"},{title:"分配状态",key:"belongStatus"},{title:"绑定人",key:"consultant"},{title:"最后维护时间",key:"followLastestDate"}]],groupHeaders:[{key:0,title:"基本信息"},{key:1,title:"报课信息"},{key:2,title:"活跃信息"},{key:3,title:"维护信息"},{key:4,title:"课中信息"},{key:5,title:"身份状态"}],colors:["blue","green","red","pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],transferLoading:!1,tableLoading:!1}},methods:{handleClickCustomHeader:function(){this.customHeaderShow=!0;var e="";switch(this.tabIndex){case 1:e="纯新学员";break;case 2:e="仅体验学员";break;case 3:e="历史在读学员";break;case 4:e="首缴在读学员";break;case 5:e="多期在读学员"}Object(b.a)("click_eo4KKSXy",{tab_name:e})},handleModalClose:function(){this.search(),this.selectedCols=[]},handleSelect:function(e){this.selectedCols=e.map((function(e){return e.uid}))},search:function(){this.formData.pageNo=1,this.getTableData()},resetTableConfig:function(){Object.assign(this.formData,this.$options.data().formData)},handleSortChange:function(e){for(var t in this.formData)-1!==t.indexOf("Order")&&this.formData[t]&&delete this.formData[t];this.formData[e.key+"Order"]="normal"===e.order?void 0:e.order,this.formData.pageNo=1,this.getTableData()},getSubjectList:(A=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.k)({cityCode:this.userInfo.cityCode});case 3:t=(t=e.sent).map((function(e){return{value:e.standardId,label:e.standardName}})),this.columnTemp.find((function(e){return"lastYearReadSubNames"===e.key})).filters=Object.freeze(t)||[],this.columnTemp.find((function(e){return"curReadSubNames"===e.key})).filters=Object.freeze(t)||[],e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.$Message.error({content:"获取学科列表失败: "+e.t0.message});case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return A.apply(this,arguments)}),initGroupHeaders:function(){var e=this;this.groupHeaders=this.groupHeaders.map((function(t){return t.children=e.columnTemp.filter((function(e){return e.parentKey===t.key})),t}))},initTableHeaders:function(){var e=this;Object(c.E)({empNo:this.userInfo.empNo,tabId:6===this.tabIndex?0:this.tabIndex}).then((function(t){if(t&&t.length)e.defaultColumns=t.map((function(t){return e.columnTemp.find((function(e){return e.key===t.id}))}));else{var a=6===e.tabIndex?0:e.tabIndex;e.defaultColumns=e.columnTempList[a].map((function(t){return e.columnTemp.find((function(e){return e.key===t.key}))}))}e.columns=e.preColumns.concat(e.defaultColumns)})).catch((function(t){e.$Message.error("查询表头设置失败："+t.message)}))},getTableData:function(){var e=this;this.formData.crmRoleId=this.userInfo.crmRoleId,this.formData.crmDeptId=this.userInfo.crmDeptId,this.formData.baseDataId=this.userInfo.baseDataId;var t=Object.assign({},this.searchParams,this.formData,{card:this.searchParams.stuLoginName});t.belongIdentityId=t.belongIdentityIdByStop||t.belongIdentityIdByPerson;var a="";switch(this.tabIndex){case 1:a="纯新学员";break;case 2:a="仅体验学员";break;case 3:a="历史在读学员";break;case 4:a="首缴在读学员";break;case 5:a="多期在读学员"}t.stuLevel=a,this.tableLoading=!0,Object(c.k)(t).then((function(t){e.tableData=t.crmStudentRespList||[],e.totalCount=t.totalCount})).catch((function(t){e.$Message.error("查询资源列表失败："+t.message)})).finally((function(){e.tableLoading=!1}))},changePage:function(e){this.formData.pageNo=e,this.getTableData()},pageSizeChange:function(e){this.formData.pageNo=1,this.formData.pageSize=e,this.getTableData()},confirmHeaderConfig:function(e){var t=this;if(e&&e.length){var a=e.map((function(e){return{id:e.key,name:e.title}}));Object(c.Q)({empNo:this.userInfo.empNo,tabId:this.tabIndex,idNameRespList:a}).then((function(){t.$Message.success("设置表头成功"),t.customHeaderShow=!1,t.transferLoading=!1,t.defaultColumns=a.map((function(e){return t.columnTemp.find((function(t){return t.key===e.id}))})),t.columns=t.preColumns.concat(t.defaultColumns)})).catch((function(e){t.$Message.error("设置表头失败："+e.message)}))}},handleDistr:function(e){var t="";switch(this.tabIndex){case 1:t="纯新学员";break;case 2:t="仅体验学员";break;case 3:t="历史在读学员";break;case 4:t="首缴在读学员";break;case 5:t="多期在读学员"}Object(b.a)("click_mzH4fJXt",{tab_name:t,button_type:e}),this.$refs.ResourceDstributeModalRef.open()}},mounted:function(){this.initGroupHeaders(),this.userInfo.cityCode&&(this.getSubjectList(),this.getTableData())}};a("34a7");function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E,H,B,q,W,V={name:"resourceList2",components:{PhoneCardNameSearch:o,ResourceTable:Object(s.a)(P,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-wrapper"},[a("div",{staticClass:"header"},[a("div",[a("span",{staticStyle:{"font-size":"14px"}},[e._v("共"+e._s(e.totalCount)+"项，已选择 "+e._s(e.selectedCols.length)+" 项")]),e._v(" "),a("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",disabled:0===e.selectedCols.length,"custom-icon":"iconfont icon-cluster"},on:{click:function(t){return e.handleDistr(0)}}},[e._v("选中分配")])],1),e._v(" "),a("div",[a("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",icon:"ios-cog-outline"},on:{click:function(t){return e.handleDistr(1)}}},[e._v("全部分配")]),e._v(" "),a("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"text","custom-icon":"iconfont icon-setting"},on:{click:e.handleClickCustomHeader}},[e._v("自定义表头")])],1)]),e._v(" "),a("Table",{staticStyle:{"font-size":"14px"},attrs:{columns:e.columns,data:e.tableData,border:"",loading:e.tableLoading},on:{"on-sort-change":e.handleSortChange,"on-selection-change":e.handleSelect}}),e._v(" "),a("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[a("Page",{attrs:{total:e.totalCount,"page-size":e.formData.pageSize,current:e.formData.pageNo,"show-elevator":"","show-sizer":"","page-size-opts":[50,100,150,200],transfer:""},on:{"update:current":function(t){return e.$set(e.formData,"pageNo",t)},"on-page-size-change":e.pageSizeChange,"on-change":e.changePage}})],1),e._v(" "),a("Modal",{attrs:{title:"自定义表头",width:600,"footer-hide":""},model:{value:e.customHeaderShow,callback:function(t){e.customHeaderShow=t},expression:"customHeaderShow"}},[e.customHeaderShow?a("GroupTransfer",{attrs:{"source-label":"全部表头","target-label":"已选常用表头","max-length":11,"default-selected":e.defaultColumns,"group-list":e.groupHeaders,loading:e.transferLoading},on:{"update:loading":function(t){e.transferLoading=t},ok:e.confirmHeaderConfig,cancel:function(t){e.customHeaderShow=!1}}}):e._e()],1),e._v(" "),a("ResourceDstributeModal",{ref:"ResourceDstributeModalRef",attrs:{searchParams:e.searchParams,fullNum:e.totalCount,tabIndex:e.tabIndex,pyUids:e.selectedCols},on:{close:e.handleModalClose}})],1)}),[],!1,null,"a6591130",null).exports,ResourceDistributeModal:M},data:function(){var e=this;return{levelDiscription:["全部资源","仅注册，未参与任何转化产品，并且从未净缴费长期班学员","参与过诊断、试听课、活动类、短期班、体验课，但是从未转化为长期班付费用户的学员","历史曾经在读过，但是所有在读科目均已结课","首次在学而思上课的在读学员","非首次在学而思上课的在读学员"],labelRender:[function(t){var a=e.tabs[0];return t("span",a.name+"（"+(a.count||0)+"）")},function(t){var a=e.tabs[1];return t("Tooltip",{props:{content:e.levelDiscription[a.id],placement:"bottom",maxWidth:"200",transfer:!0}},a.name+"（"+(a.count||0)+"）")},function(t){var a=e.tabs[2];return t("Tooltip",{props:{content:e.levelDiscription[a.id],placement:"bottom",maxWidth:"200",transfer:!0}},a.name+"（"+(a.count||0)+"）")},function(t){var a=e.tabs[3];return t("Tooltip",{props:{content:e.levelDiscription[a.id],placement:"bottom",maxWidth:"200",transfer:!0}},a.name+"（"+(a.count||0)+"）")},function(t){var a=e.tabs[4];return t("Tooltip",{props:{content:e.levelDiscription[a.id],placement:"bottom",maxWidth:"200",transfer:!0}},a.name+"（"+(a.count||0)+"）")},function(t){var a=e.tabs[5];return t("Tooltip",{props:{content:e.levelDiscription[a.id],placement:"bottom",maxWidth:"200",transfer:!0}},a.name+"（"+(a.count||0)+"）")}],resourceWarningName:"",activeTabName:"0",tabs:[],formData:{registDate:"",followDate:"",disDate:"",startTime:"",endTime:"",belongIdentityIdByStop:"",stuMobile:"",stuRealName:"",stuLoginName:"",belongStartTime:"",belongEndTime:"",followStartTime:"",followEndTime:"",content:"",weixinAddStatus:"",expBehaviorThirty:"",payFirstTermName:"",payFirstDate:"",resourceWarningType:"",resourceWarningId:"",stuLevel:"",bindStatus:"",belongIdentityIdByPerson:"",belongDeptType:"",belongDeptId:""},form:{startTime:"",endTime:"",activeStatus:"",allotStatus:"",followStatus:"",belongIdentityId:"",readStatus:"",areaCode:"",gradeId:"",tagId:"",belongStatus:"",bindStatus:"",belongDeptType:"",belongDeptId:"",userTag:"",pageNo:1,pageSize:20,belongIdentityIdByStop:"",belongIdentityIdByPerson:"",resourceWarning:""},fastSearchArray:["stuMobile",""],registDateOptions:{disabledDate:function(e){return e&&e.valueOf()>=Date.now()},shortcuts:[{text:"今日",value:function(){var e=new Date;return[e,e]}},{text:"昨日",value:function(){var e=new Date;return e.setTime(e.getTime()-864e5),[e,e]}},{text:"近7日",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:"近30日",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}}]},resourceCondition:{},condition:{resignIdentity:[],expBehaviorThirty:[],payFirstTermName:[],weixinAddStatus:[],belongStatusList:[],consultantList:[],belongTypeList:[],deptList:[]},followContentList:[]}},computed:z({},Object(y.e)("roleRelativeData",["userInfo"])),watch:{userInfo:function(e){e.crmRoleId&&this._queryTabInfo()},activeTabName:function(){"6"===this.activeTabName?(this.formData.resourceWarningType=this.resourceWarning.split("-")[0],this.formData.resourceWarningId=this.resourceWarning.split("-")[1]):(this.formData.resourceWarningType=null,this.formData.resourceWarningId=null)}},created:function(){var e=this.$route.query;this.setResourceWarningInfo(e)},mounted:function(){this._queryResourceCondition(),this._queryConsultantsByIdentity(),this._queryResignIdentity(),this.userInfo.crmRoleId&&this._queryTabInfo()},methods:{_followContentQuery:function(e){var t=this,a=e.target;Object(c.g)({crmDeptId:this.userInfo.crmDeptId,crmRoleId:this.userInfo.crmRoleId,baseDataId:this.userInfo.baseDataId,highlightPreTag:'<span style="color: red">',highlightPostTag:"</span>",pageNo:1,pageSize:10,content:a.value}).then((function(e){t.followContentList=e.classNameSuggestDTOList||[]}))},setResourceWarningInfo:function(e){e.type&&(this.resourceWarningName=e.typeName+"-"+e.name,this.resourceWarning="".concat(e.type,"-").concat(e.id),this.activeTabName="6",this.formData.resourceWarningType=this.resourceWarning.split("-")[0],this.formData.resourceWarningId=this.resourceWarning.split("-")[1])},handleReset:function(){Object.assign(this.formData,this.$options.data().formData),this.fastSearchArray=["stuMobile",""]},handleSearch:function(){this.$refs.resourceTable.search(),this.$refs.fastSearch.handleValueConfirm()},handleFastSearchChange:function(e){this.formData.stuLoginName="",this.formData.stuRealName="",this.formData.stuMobile="",this.formData[e[0]]=e[1]},_queryTabInfo:(W=Object(n.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(c.J)({crmDeptId:this.userInfo.crmDeptId,crmRoleId:this.userInfo.crmRoleId,baseDataId:this.userInfo.baseDataId}).then((function(e){t.tabs=e})).catch((function(e){t.$Message.error({content:"获取用户分层失败："+e.message})}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return W.apply(this,arguments)}),_queryResignIdentity:(q=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.resignIdentitying=!0,e.next=4,Object(c.H)();case 4:t=e.sent,this.condition.resignIdentity=Object.freeze(t.map((function(e){return z(z({},e),{},{userName:e.userName+"(已停用)"})})))||[],e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$Message.error({content:"获取停用/离职顾问失败："+e.t0.message});case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return q.apply(this,arguments)}),queryDeptList:(B=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.formData.belongDeptId="",void 0!==this.formData.belongDeptType&&0!==this.formData.belongDeptType){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,Object(c.F)({type:this.formData.belongDeptType});case 6:t=e.sent,a=t&&t.map((function(e){return 2===e.status?z(z({},e),{},{deptName:e.deptName+" (已停用)"}):e})),this.condition.deptList=a,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),this.$Message.error({content:"获取归属失败："+e.t0.message});case 14:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(){return B.apply(this,arguments)}),_queryResourceCondition:(H=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c.I)();case 3:t=this.resourceCondition=e.sent,this.condition.cityList=Object.freeze(t.cityList)||[],this.condition.expBehaviorThirty=Object.freeze(t.expBehaviorThirty)||[],this.condition.payFirstTermName=Object.freeze(t.payFirstTermName)||[],this.condition.weixinAddStatus=Object.freeze(t.weixinAddStatus)||[],this.condition.belongStatusList=Object.freeze(t.belongStatusList)||[],this.condition.belongTypeList=Object.freeze(t.belongTypeList)||[],e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.$Message.error({content:"获取筛选条件失败："+e.t0.message});case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(){return H.apply(this,arguments)}),_queryConsultantsByIdentity:(E=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c.C)();case 3:t=e.sent,this.condition.consultantList=Object.freeze(t)||[],e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.$Message.error({content:"获取绑定人失败："+e.t0.message});case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return E.apply(this,arguments)}),handleFollowDateChange:function(e){this.formData.followStartTime=new Date(e[0]+" 00:00:00").getTime()/1e3,this.formData.followEndTime=new Date(e[1]+" 00:00:00").getTime()/1e3+86399},handleAllocateDateChange:function(e){this.formData.belongStartTime=new Date(e[0]+" 00:00:00").getTime()/1e3,this.formData.belongEndTime=new Date(e[1]+" 00:00:00").getTime()/1e3+86399},handleRegistDateChange:function(e){this.formData.startTime=new Date(e[0]+" 00:00:00").getTime()/1e3,this.formData.endTime=new Date(e[1]+" 00:00:00").getTime()/1e3+86399},getFormItemVisible:function(e){switch(e){case"停用/离职顾问":case"分配时间":case"快速搜索":case"绑定状态":case"绑定人":case"归属类型":case"归属":if("0"===this.activeTabName||"6"===this.activeTabName)return!0;break;case"注册日期":if("0"===this.activeTabName||"6"===this.activeTabName||"1"===this.activeTabName||"2"===this.activeTabName)return!0;break;case"维护时间":if("0"===this.activeTabName||"6"===this.activeTabName||"1"===this.activeTabName||"3"===this.activeTabName||"4"===this.activeTabName||"2"===this.activeTabName||"5"===this.activeTabName)return!0;break;case"最后沟通内容":if("0"===this.activeTabName||"6"===this.activeTabName||"1"===this.activeTabName||"2"===this.activeTabName)return!0;break;case"加微状态":if("1"===this.activeTabName||"2"===this.activeTabName)return!0;break;case"近30日体检行为":if("2"===this.activeTabName)return!0;break;case"近7日活跃行为":if("3"===this.activeTabName)return!0;break;case"首次净缴学期":case"首次净缴日期":if("4"===this.activeTabName)return!0}},handleTabClick:function(e){this.handleReset()},handleClickItem:function(e){this.formData.content=e}}},U=(a("e61fc"),Object(s.a)(V,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layout"},[a("Tabs",{staticClass:"custom-tabs",attrs:{animated:!1,name:"resource"},on:{"on-click":e.handleTabClick},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[e._l(e.tabs,(function(t){return a("TabPane",{key:t.id,attrs:{label:e.labelRender[t.id],name:String(t.id)}})})),e._v(" "),e.resourceWarningName?a("TabPane",{attrs:{label:e.resourceWarningName,name:"6"}}):e._e()],2),e._v(" "),a("Form",{staticClass:"form-container",attrs:{model:e.formData,"label-width":64,inline:""}},[e.getFormItemVisible("注册日期")?a("FormItem",{attrs:{label:"注册日期"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",options:e.registDateOptions,placeholder:"   开始日期 -> 结束日期",clearable:""},on:{"on-change":e.handleRegistDateChange},model:{value:e.formData.registDate,callback:function(t){e.$set(e.formData,"registDate",t)},expression:"formData.registDate"}})],1):e._e(),e._v(" "),e.getFormItemVisible("维护时间")?a("FormItem",{attrs:{label:"维护时间"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",options:e.registDateOptions,placeholder:"   开始日期 -> 结束日期",clearable:""},on:{"on-change":e.handleFollowDateChange},model:{value:e.formData.followDate,callback:function(t){e.$set(e.formData,"followDate",t)},expression:"formData.followDate"}})],1):e._e(),e._v(" "),e.getFormItemVisible("分配时间")?a("FormItem",{attrs:{label:"分配时间"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",options:e.registDateOptions,placeholder:"   开始日期 -> 结束日期",clearable:""},on:{"on-change":e.handleAllocateDateChange},model:{value:e.formData.disDate,callback:function(t){e.$set(e.formData,"disDate",t)},expression:"formData.disDate"}})],1):e._e(),e._v(" "),e.getFormItemVisible("绑定状态")?a("FormItem",{attrs:{label:"绑定状态","label-width":64}},[a("Select",{staticStyle:{width:"120px"},attrs:{clearable:""},model:{value:e.formData.bindStatus,callback:function(t){e.$set(e.formData,"bindStatus",t)},expression:"formData.bindStatus"}},e._l(e.condition.belongStatusList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1):e._e(),e._v(" "),e.getFormItemVisible("绑定人")?a("FormItem",{attrs:{label:"绑定人","label-width":50}},[a("Select",{staticStyle:{width:"120px"},attrs:{disabled:1===e.formData.bindStatus||!!e.formData.belongIdentityIdByStop,clearable:"",filterable:""},model:{value:e.formData.belongIdentityIdByPerson,callback:function(t){e.$set(e.formData,"belongIdentityIdByPerson",t)},expression:"formData.belongIdentityIdByPerson"}},e._l(e.condition.consultantList,(function(t){return a("Option",{key:t.identityId,attrs:{value:t.identityId}},[e._v(e._s(t.userName))])})),1)],1):e._e(),e._v(" "),e.getFormItemVisible("停用/离职顾问")?a("FormItem",{attrs:{label:"停用/离职顾问","label-width":99}},[a("Select",{staticStyle:{width:"120px"},attrs:{disabled:1===e.formData.bindStatus||!!e.formData.belongIdentityIdByPerson,clearable:"",filterable:""},model:{value:e.formData.belongIdentityIdByStop,callback:function(t){e.$set(e.formData,"belongIdentityIdByStop",t)},expression:"formData.belongIdentityIdByStop"}},e._l(e.condition.resignIdentity,(function(t){return a("Option",{key:t.identityId,attrs:{value:t.identityId}},[e._v(e._s(t.userName))])})),1)],1):e._e(),e._v(" "),e.getFormItemVisible("归属类型")?a("FormItem",{attrs:{label:"归属类型","label-width":64}},[a("Select",{staticStyle:{width:"120px"},attrs:{clearable:""},on:{"on-change":e.queryDeptList},model:{value:e.formData.belongDeptType,callback:function(t){e.$set(e.formData,"belongDeptType",t)},expression:"formData.belongDeptType"}},e._l(e.condition.belongTypeList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1):e._e(),e._v(" "),e.getFormItemVisible("归属")?a("FormItem",{attrs:{label:"归属","label-width":36}},[a("Select",{staticStyle:{width:"120px"},attrs:{disabled:!e.formData.belongDeptType,clearable:"",filterable:""},model:{value:e.formData.belongDeptId,callback:function(t){e.$set(e.formData,"belongDeptId",t)},expression:"formData.belongDeptId"}},e._l(e.condition.deptList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.deptName))])})),1)],1):e._e(),e._v(" "),e.getFormItemVisible("最后沟通内容")?a("FormItem",{attrs:{label:"最后沟通内容","label-width":92}},[a("Dropdown",{attrs:{placement:"bottom-start"},on:{"on-click":e.handleClickItem}},[a("Input",{attrs:{type:"text",placeholder:"请输入内容",clearable:""},on:{"on-change":e._followContentQuery},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}}),e._v(" "),e.followContentList.length>0?a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[e._l(e.followContentList,(function(t,n){return a("DropdownItem",{key:n,attrs:{name:t.name,selected:e.formData.content===t.name}},[a("p",{staticClass:"class-item",domProps:{innerHTML:e._s(t.highlightName)}})])}))],2):e._e()],1)],1):e._e(),e._v(" "),e.getFormItemVisible("分配时间")?a("FormItem",{attrs:{label:"快速搜索"}},[a("PhoneCardNameSearch",{ref:"fastSearch",on:{"on-change":e.handleFastSearchChange},model:{value:e.fastSearchArray,callback:function(t){e.fastSearchArray=t},expression:"fastSearchArray"}})],1):e._e(),e._v(" "),e.getFormItemVisible("加微状态")?a("FormItem",{attrs:{label:"加微状态"}},[a("Select",{staticStyle:{width:"100px"},model:{value:e.formData.weixinAddStatus,callback:function(t){e.$set(e.formData,"weixinAddStatus",t)},expression:"formData.weixinAddStatus"}},e._l(e.condition.weixinAddStatus,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1):e._e(),e._v(" "),e.getFormItemVisible("近30日体检行为")?a("FormItem",{attrs:{label:"近30日体验行为","label-width":109}},[a("Select",{staticStyle:{width:"100px"},model:{value:e.formData.expBehaviorThirty,callback:function(t){e.$set(e.formData,"expBehaviorThirty",t)},expression:"formData.expBehaviorThirty"}},e._l(e.condition.expBehaviorThirty,(function(t){return a("Option",{key:t.id,attrs:{value:t.name}},[e._v(e._s(t.name))])})),1)],1):e._e(),e._v(" "),e.getFormItemVisible("首次净缴学期")?a("FormItem",{attrs:{label:"首次净缴学期","label-width":92}},[a("Select",{staticStyle:{width:"100px"},model:{value:e.formData.payFirstTermName,callback:function(t){e.$set(e.formData,"payFirstTermName",t)},expression:"formData.payFirstTermName"}},e._l(e.condition.payFirstTermName,(function(t){return a("Option",{key:t.name,attrs:{value:t.name}},[e._v(e._s(t.name))])})),1)],1):e._e(),e._v(" "),e.getFormItemVisible("首次净缴日期")?a("FormItem",{attrs:{label:"首次净缴日期","label-width":92}},[a("DatePicker",{staticStyle:{width:"150px"},attrs:{type:"date",placeholder:"请选择"},model:{value:e.formData.payFirstDate,callback:function(t){e.$set(e.formData,"payFirstDate",t)},expression:"formData.payFirstDate"}})],1):e._e(),e._v(" "),a("div",{staticClass:"place"}),e._v(" "),a("div",{staticClass:"btns"},[a("Button",{staticStyle:{"margin-right":"8px"},attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查 询")]),e._v(" "),a("Button",{on:{click:e.handleReset}},[e._v("重 置")])],1)],1),e._v(" "),a("ResourceTable",{ref:"resourceTable",attrs:{"tab-index":Number(e.activeTabName),"resource-condition":e.resourceCondition,"search-params":e.formData}})],1)}),[],!1,null,"6fa85a5d",null));t.default=U.exports},"6b16":function(e,t,a){},"724a":function(e,t,a){"use strict";var n=a("c602");a.n(n).a},7652:function(e,t,a){"use strict";var n=a("1859");a.n(n).a},"76ca":function(e,t,a){"use strict";var n=a("328a");a.n(n).a},"77ed":function(e,t,a){"use strict";var n=a("1800");a.n(n).a},"7e65":function(e,t,a){"use strict";a.d(t,"r",(function(){return i})),a.d(t,"p",(function(){return s})),a.d(t,"l",(function(){return o})),a.d(t,"s",(function(){return l})),a.d(t,"n",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"u",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"e",(function(){return f})),a.d(t,"v",(function(){return h})),a.d(t,"j",(function(){return g})),a.d(t,"m",(function(){return v})),a.d(t,"t",(function(){return b})),a.d(t,"x",(function(){return y})),a.d(t,"y",(function(){return w})),a.d(t,"w",(function(){return k})),a.d(t,"o",(function(){return _})),a.d(t,"d",(function(){return D})),a.d(t,"c",(function(){return C})),a.d(t,"b",(function(){return S})),a.d(t,"a",(function(){return x})),a.d(t,"k",(function(){return T})),a.d(t,"i",(function(){return I})),a.d(t,"q",(function(){return N}));var n=a("66df"),r=a("15b1");function i(e){return n.a.request({url:"crmStudent/queryCompleteStudentList",method:"post",data:e})}function s(e){return n.a.request({url:"crmStudent/giveUpFollowUp",method:"get",params:e})}var o=function(e){return n.a.request({url:"crmStudent/getStuBelongRecord",params:e,method:"get"})},l=function(e){return n.a.request({url:"crmStudent/queryRelateAccount",params:e,method:"get"})},c=function(e){return n.a.request({url:"crmStudent/getStudentLabelBaseInfo",params:e,method:"get"})},u=function(e){return n.a.request({url:"crmStudent/getAdvisorFollowRecord",data:e,method:"post"})},d=function(e){return n.a.request({url:"crmStudent/getAdvisorFollowOtherInfo",data:e,method:"post"})},p=function(e){return n.a.request({url:"crmStudent/queryStudentLabel",params:e,method:"get"})};function m(e){return r.a.request({url:"/ALADDIN/activity/getBringNewAbility",method:"get",params:e})}function f(e){return r.a.request({url:"/ALADDIN/activity/getActivityUserInvite",method:"get",params:e})}function h(e){return r.a.request({url:"/ALADDIN/label/queryUserLabel",method:"get",params:e})}function g(e){return n.a.request({url:"crmStudent/getHighTransformPotential",method:"post",data:e})}var v=function(e){return n.a.request({url:"crmStudent/getStuIntention",params:e,method:"get"})},b=function(e){return n.a.request({url:"crmStudent/queryStuFamilyRecord",params:e,method:"get"})},y=function(e){return n.a.request({url:"crmStudent/updateStudentArchive",data:e,method:"post"})},w=function(e){return n.a.request({url:"crmStudent/updateUserLabel",data:e,method:"post"})},k=function(e){return n.a.request({url:"/crmStudent/stuTaskNotice",params:e,method:"get"})},_=function(e){return n.a.request({url:"/crmStudent/getStudentNeedFollowTask",params:e,method:"get"})},D=function(e){return n.a.request({url:"crmStudent/followTmp/save",data:e,method:"post"})},C=function(e){return n.a.request({url:"crmStudent/followTmp/getActive",params:e,method:"get"})},S=function(e){return n.a.request({url:"crmStudent/followTmp/delete",data:e,method:"post"})},x=function(e){return n.a.request({url:"crmStudent/addFollowRecord",data:e,method:"post"})},T=function(e){return n.a.request({url:"crmStudent/getStuAllLabelInfos",params:e,method:"get"})},I=function(e){return n.a.request({url:"crmStudent/getCallHistoryList",params:e,method:"get"})},N=function(e){return n.a.request({url:"/crmStudent/queryCallrecordUrl",data:e,method:"post"})}},"7e66":function(e,t,a){},"7f4db":function(e,t,a){"use strict";a("0d6d"),a("c5f6");var n=a("c3a7"),r=a("e0e9"),i=(a("8e6e"),a("ac6a"),a("cadf"),a("456d"),a("bd86")),s=(a("96cf"),a("3b8d")),o=a("c7d4");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u,d={name:"changeApplyStatus",props:{applyChangedRecord:{type:Array},applyInfo:{type:Object,default:function(){return{}}}},data:function(){return{options:{disabledDate:function(e){return e&&e.valueOf()<Date.now()-864e5}},nextTime:"",nextTimeShow:!1,formData:{remark:"",applyType:1,preApplyStatus:0,nextFollowUpTime:""},applyStatusMap:{0:"未跟进",1:"已预约",2:"跟进结束",3:"跟进中"},applySecondStatusMap:{1:"继续跟进",2:"未接通",3:"无意向",4:"已用其他账号预约",5:"已转化无需预约",6:"无匹配课程"},cascaderValue:[],cascaderList:[{value:3,label:"跟进中",children:[{value:1,label:"继续跟进"},{value:2,label:"未接通"}]},{value:2,label:"跟进结束",children:[{value:3,label:"无意向"},{value:4,label:"已用其他账号预约"},{value:5,label:"已转化无需预约"},{value:6,label:"无匹配课程",children:[{value:7,label:"无时间匹配"},{value:8,label:"无课程匹配"}]}]}]}},watch:{cascaderValue:function(e){e&&e.length&&3===e[0]?this.nextTimeShow=!0:(this.nextTimeShow=!1,this.nextTime="",this.formData.nextFollowUpTime="")}},mounted:function(){var e=this;this.$nextTick((function(){e.formData.preApplyStatus=e.applyInfo.applyStatus,e.formData.taskIds=e.applyInfo.taskIds,e.cascaderValue=[e.applyChangedRecord.applyStatus,e.applyChangedRecord.applySecondStatus,e.applyChangedRecord.applyThirdStatus],e.formData.applyId=e.applyInfo.id}))},methods:{timeChange:function(e){this.formData.nextFollowUpTime=e},submit:(u=Object(s.a)(regeneratorRuntime.mark((function e(){var t,a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cascaderValue[0]){e.next=2;break}return e.abrupt("return",this.$Message.warning("请选择状态"));case 2:if(this.formData.remark.trim()){e.next=4;break}return e.abrupt("return",this.$Message.warning("请填写备注"));case 4:if(t=this.cascaderValue[0],a=this.cascaderValue[1]||null,n=this.cascaderValue[2]||null,3!==t||this.formData.nextFollowUpTime){e.next=9;break}return e.abrupt("return",this.$Message.warning("请选择下次跟进时间"));case 9:return r=c(c({},this.formData),{},{currentApplyStatus:t,applySecondStatus:a,applyThirdStatus:n}),e.prev=10,e.next=13,Object(o.e)(r);case 13:this.$Message.success({content:"修改申请状态成功"}),this.$emit("success"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),this.$Message.error({content:"修改申请状态失败: ".concat(e.t0.message),duration:5});case 20:case"end":return e.stop()}}),e,this,[[10,17]])}))),function(){return u.apply(this,arguments)})}},p=(a("724a"),a("2877")),m=Object(p.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.applyChangedRecord.length?a("div",[a("Divider"),e._v(" "),a("h3",{staticStyle:{margin:"16px 0"}},[e._v("跟进记录")]),e._v(" "),a("Scroll",{attrs:{height:"200"}},e._l(e.applyChangedRecord,(function(t,n){return a("Row",{key:n,staticStyle:{"padding-left":"24px"}},[a("Col",[e._v("状态: "+e._s(e.applyStatusMap[t.currentApplyStatus]))]),e._v(" "),a("Col",[e._v("备注: "+e._s(t.remark))]),e._v(" "),a("Col",{attrs:{span:"8"}},[e._v("操作人: "+e._s(t.modifyEmpName))]),e._v(" "),a("Col",{attrs:{span:"16"}},[e._v("操作时间: "+e._s(t.createTime))]),e._v(" "),a("Col",{attrs:{span:"24"}},[a("Divider")],1)],1)})),1)],1):e._e(),e._v(" "),a("Divider"),e._v(" "),a("h3",{staticStyle:{marginBottom:"16px"}},[e._v("跟进维护")]),e._v(" "),a("Form",{attrs:{"label-width":100}},[a("FormItem",{attrs:{label:"状态",required:""}},[a("Cascader",{staticStyle:{width:"200px",display:"inline-block"},attrs:{size:"small",data:e.cascaderList},model:{value:e.cascaderValue,callback:function(t){e.cascaderValue=t},expression:"cascaderValue"}})],1),e._v(" "),e.nextTimeShow?a("FormItem",{attrs:{label:"下次跟进时间",required:""}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{options:e.options,type:"datetime",placement:"top",size:"small",format:"yyyy-MM-dd HH:mm",placeholder:"请选择"},on:{"on-change":e.timeChange},model:{value:e.formData.nextTime,callback:function(t){e.$set(e.formData,"nextTime",t)},expression:"formData.nextTime"}})],1):e._e(),e._v(" "),a("FormItem",{attrs:{label:"备注",required:""}},[a("Input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入备注",type:"textarea",minlength:5},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1),e._v(" "),a("Row",{attrs:{type:"flex",justify:"center",gutter:20}},[a("Col",[a("Button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确定")])],1)],1)],1)}),[],!1,null,"d22dab2a",null).exports,f={name:"AuditionFollowRecord",mixins:[r.a],components:{ChangeApplyStatus:m},props:{studentDetail:{type:Object,default:function(){return{}}},operationType:{type:Number,default:null},appointmentList:{type:Object,default:function(){return{}}},applyId:{type:String,default:""},preApplyStatus:{type:Number}},data:function(){return{followList:[],taskResp:[],changeApplyStatusModal:{show:!0},attendStatus:{0:"缺勤",1:"准时上课",2:"迟到"},classTypeMap:{1:"在线",2:"双师",4:"面授"},appointmentApply:null,loaded:!1,applyStatusMap:{0:"未跟进",1:"已预约",2:"跟进结束",3:"跟进中"},applySecondStatusMap:{1:"继续跟进",2:"未接通",3:"无意向",4:"已用其他账号预约",5:"已转化无需预约",6:"无匹配课程"}}},methods:{refresh:function(){this.queryFollowDetail()},queryFollowDetail:function(){var e=this,t={appointmentId:this.appointmentId,cityCode:this.studentDetail.cityCode,operationType:this.operationType,appointmentApplyId:this.appointmentApplyId};Object(n.d)(t).then((function(t){e.followList=Object.freeze(t.followList)||[],e.appointmentResp=Object.freeze(t.appointmentResp)||{},e.taskResp=Object.freeze(t.taskResp)||[],e.appointmentApply=Object.freeze(t.appointmentApply)||null,e.loaded=!0})).catch((function(t){e.loaded=!0,e.$Message.error({content:t.message,duration:5})}))}}},h=(a("f60d"),Object(p.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{attrs:{type:"flex"}},[a("Col",{attrs:{span:"8"}},[a("span",[e._v("学员姓名: "+e._s(e.appointmentList.stuName||"--"))])]),e._v(" "),a("Col",{attrs:{span:"8"}},[a("span",[e._v("年级: "+e._s(e.appointmentList.gradeName||"--"))])]),e._v(" "),a("Col",{attrs:{span:"8"}},[a("span",[e._v("学员编号: "+e._s(e.appointmentList.stuCode||"--"))])])],1),e._v(" "),a("br"),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("Col",{attrs:{span:"8"}},[a("span",[e._v("申请时间: "+e._s(e.appointmentList.createTime||"--"))])]),e._v(" "),a("Col",{attrs:{span:"8"}},[a("span",[e._v("推荐顾问: "+e._s(e.appointmentList.maintainerName||"--"))])]),e._v(" "),a("Col",{attrs:{span:"8"}},[a("span",[e._v("推荐学员: "+e._s(e.appointmentList.referrerStuName||"--"))])])],1),e._v(" "),a("br"),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("Col",{attrs:{span:"8"}},[a("span",[e._v("意向服务中心: "+e._s(e.appointmentList.intendedServiceCenter||"--"))])]),e._v(" "),a("Col",{attrs:{span:"8"}},[a("span",[e._v("年份: "+e._s(e.appointmentList.year||"--"))])]),e._v(" "),a("Col",{attrs:{span:"8"}},[a("span",[e._v("年级: "+e._s(e.appointmentList.gradeName||"--"))])])],1),e._v(" "),a("br"),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("Col",{attrs:{span:"8"}},[a("span",[e._v("学科: "+e._s(e.appointmentList.subject||"--"))])]),e._v(" "),a("Col",{attrs:{span:"8"}},[a("span",[e._v("授课类型: "+e._s(e.appointmentList.classType||"--"))])]),e._v(" "),a("Col",{attrs:{span:"8"}},[a("span",[e._v("期望试听时间: "+e._s(e.appointmentList.subTime||"--"))])])],1),e._v(" "),a("br"),e._v(" "),e.changeApplyStatusModal.show?a("ChangeApplyStatus",{attrs:{applyChangedRecord:e.appointmentList.recordList,applyInfo:e.appointmentList},on:{success:function(t){return e.$emit("success")}}}):e._e()],1)}),[],!1,null,"59121f74",null));t.a=h.exports},"8b5d":function(e,t,a){},"8d8d":function(e,t,a){},9044:function(e,t,a){"use strict";a.r(t);a("8e6e"),a("cadf"),a("456d"),a("ac6a"),a("0d6d"),a("7f7f"),a("96cf");var n=a("3b8d"),r=a("bd86"),i=(a("c5f6"),{props:{name:String,target:Number,done:Number},computed:{percent:function(){return 0===this.done||0===this.target?0:+(this.done/this.target*100).toFixed(1)}}}),s=(a("3631"),a("2877")),o=Object(s.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"new-data-card"},[a("h1",{staticClass:"title"},[e._v(e._s(e.name))]),e._v(" "),a("div",{staticClass:"num",staticStyle:{"margin-top":"16px","margin-bottom":"4px"}},[a("span",{staticClass:"done"},[e._v(e._s(e.done))]),e._v(" / "+e._s(e.target)+"\n  ")]),e._v(" "),0!==e.target?a("span",{staticClass:"desc"},[e._v("完成率 "+e._s(e.percent)+"%")]):a("span",{staticClass:"desc"},[e._v("-")]),e._v(" "),a("Progress",{staticStyle:{"margin-top":"6px"},attrs:{percent:e.percent,"hide-info":"","stroke-color":"个人招新人次"!==e.name?"#FF9F19":"#2d8cf0"}})],1)}),[],!1,null,"17047819",null).exports,l={name:"ResourceCard",props:{name:String,tooltips:String,data:{type:Array,default:function(){return[]}}}},c=(a("77ed"),Object(s.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resource-card"},[a("div",{staticClass:"title"},[e._v(e._s(e.name)+"\n    "),e.tooltips?a("Tooltip",{staticStyle:{transform:"translate(0, -2px)"},attrs:{placement:"left-start",transfer:"",theme:"light","max-width":700}},[a("Icon",{staticClass:"icon-help",attrs:{type:"ios-information-circle-outline"}}),e._v(" "),a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.tooltips)},slot:"content"})],1):e._e()],1),e._v(" "),a("Divider",{staticStyle:{"margin-bottom":"9px","margin-top":"16px"}}),e._v(" "),e._l(e.data,(function(t,n){return a("div",{key:n,staticClass:"flex"},[a("div",{staticClass:"name"},[e._v(e._s(t.name))]),e._v(" "),a("a",{staticClass:"num",attrs:{href:"javascript:void(0)"},on:{click:function(a){return e.$emit("count-click",t)}}},[e._v(e._s(t.count))])])}))],2)}),[],!1,null,"43c552e0",null).exports),u=a("90de"),d={name:"HScroll",props:{gutter:{type:Number,default:16}},provide:function(){return{ScrollInstance:this}},data:function(){return{scrollBoxWidth:0,fullChildrenWidth:0,scrollLeft:0}},mounted:function(){this.scrollBoxWidth=0,this.fullChildrenWidth=0,Object(u.g)(window,"resize",this.updateView)},activated:function(){this.refresh()},beforeDestroy:function(){Object(u.f)(window,"resize",this.updateView)},methods:{refresh:function(){var e=this;this.$nextTick((function(){var t=e.$refs.scrollBox;e.scrollBoxWidth=t.clientWidth,e.$refs.scrollBox.scrollLeft=e.scrollLeft}))},updateView:function(e){var t=this.$refs.scrollBox;this.scrollBoxWidth=t.clientWidth,e&&"number"==typeof e&&(this.fullChildrenWidth+=e+this.gutter),console.log("scrollBox宽度",this.scrollBoxWidth)},scroll:function(e){"left"===e?this.$refs.scrollBox.scrollLeft-=this.scrollBoxWidth:"right"===e&&(this.$refs.scrollBox.scrollLeft+=this.scrollBoxWidth),this.scrollLeft=this.$refs.scrollBox.scrollLeft}}},p=(a("bd61"),Object(s.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"h-scroll"},[a("div",{staticClass:"arrow left",class:{disabled:0===e.scrollLeft||e.fullChildrenWidth<=e.scrollBoxWidth},on:{click:function(t){return e.scroll("left")}}},[a("Icon",{attrs:{type:"ios-arrow-back"}})],1),e._v(" "),a("div",{staticClass:"arrow right",class:{disabled:e.scrollLeft===e.fullChildrenWidth-e.scrollBoxWidth||e.fullChildrenWidth<=e.scrollBoxWidth},on:{click:function(t){return e.scroll("right")}}},[a("Icon",{attrs:{type:"ios-arrow-forward"}})],1),e._v(" "),a("div",{ref:"scrollBox",staticClass:"scroll-box"},[e._t("default")],2)])}),[],!1,null,"c4f70720",null).exports),m={inject:["ScrollInstance"],props:{data:{type:Object,default:function(){}}},data:function(){return{hover:!1,hover2:!1}},mounted:function(){var e=this;this.$nextTick((function(){var t=e.$refs.card.clientWidth;e.ScrollInstance&&e.ScrollInstance.updateView(t+2)}))},methods:{mouseOver:function(){}}},f=(a("210e"),Object(s.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"card",staticClass:"task-type-card",class:{active:e.data.checked},on:{mouseenter:function(t){e.hover=!0},mouseleave:function(t){e.hover=!1},click:function(t){return e.$emit("card-click",e.data)}}},[a("p",{staticClass:"name"},[e._v(e._s(e.data.taskName))]),e._v(" "),a("div",{staticClass:"num"},[e._v(e._s(e.data.taskCount)+"\n    "),"全部任务"!==e.data.taskName?[!e.data.isTop&&e.hover?a("span",{staticClass:"top",staticStyle:{"font-size":"12px"},on:{click:function(t){return t.stopPropagation(),e.$emit("top",e.data)}}},[e._v("置顶")]):e._e(),e._v(" "),e.data.isTop&&e.hover?a("div",{staticClass:"top",staticStyle:{"font-size":"12px"},on:{mouseenter:function(t){e.hover2=!0},mouseleave:function(t){e.hover2=!1}}},[e._v("\n        置顶\n        "),e.hover2?a("div",{staticClass:"tooltips",on:{click:function(t){return t.stopPropagation(),e.$emit("cancel-top",e.data)}}},[e._v("取消置顶")]):e._e(),e._v(" "),a("div",{staticClass:"del"})]):e._e()]:e._e()],2),e._v(" "),e.data.isTop?a("div",{staticClass:"overflow"},[a("div",{staticClass:"corner"})]):e._e()])}),[],!1,null,"6ef80d76",null).exports),h=a("768b"),g=(a("6762"),a("2fdb"),a("75fc")),v=a("a474"),b=a("867e"),y=a("0ef6"),w=a("e61f"),k=a("fa7d");function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var C,S,x=function(e){var t=parseInt(e),a=0,n=0;t>60&&(a=parseInt(t/60),t=parseInt(t%60),a>60&&(n=parseInt(a/60),a=parseInt(a%60)));var r=parseInt(t)+"秒";return a>0&&(r=parseInt(a)+"分"+r),n>0&&(r=parseInt(n)+"小时"+r),r},T={name:"TaskTable",mixins:[y.a],props:{tableType:{type:Number,default:1}},data:function(){var e=this;return{type:1,inputValue:"",selectValue:"stuMobile",followNumOrder:"",taskTimeLastOrder:"desc",followStartDate:"",followEndDate:"",taskList:[],columns:[],tableConfig:{pageNo:1,pageSize:10,totalCount:0,tableLoading:!1,hasNextPage:!1},table:[],columns1:[{title:"学员编号",key:"stuLoginName",align:"left",minWidth:130},{minWidth:120,title:"学员姓名",key:"stuRealName",align:"left",render:function(t,a){var n=[t("a",{on:{click:function(){var t={card:a.row.stuLoginName,cityCode:a.row.areaCode};Object(w.a)("click_lFbbBiRS",{task_name:e.taskType+"",channel_name:e.tableType>2?1:0}),e.goCustomerDetail(t)}}},a.row.stuRealName||"无"),t("Icon",{props:{custom:"iconfont icon-phone-fill"},style:{cursor:"pointer",marginLeft:"5px",display:e.callShow(a.row.areaCode)?"block":"none"},on:{click:function(){e.$store.state.app.callInstance.call(a.row.areaCode,a.row.pyUid)}}})];return t("div",{style:{display:"flex",alignItems:"center"}},n)}},{title:"联系电话",key:"stuMobile",align:"left",minWidth:160,render:function(e,t){return e("TalDecodeText",{props:{uid:t.row.pyUid,encodeText:t.row.stuMobile,type:"phone"}})}},{title:"注册渠道",key:"stuRegistName",align:"left",minWidth:160,slot:"stuRegistName"},{title:"注册时间",key:"stuCreateDate",align:"left",minWidth:175},{title:"最长任务时长",key:"taskTimeLast",align:"left",minWidth:150,sortable:"custom"},{title:"加微状态",align:"left",minWidth:150,render:function(e,t){var a="--";switch(t.row.isWechatAdded){case 0:a="从未添加";break;case 1:a="已添加未删除";break;case 2:a="历史添加当前已删除";break;default:a="--"}return e("p",a)}},{title:"当前年级",key:"stuGradeName",align:"left",minWidth:120,filters:[],filterRemote:function(t,a){e.stuGradeIdList=t,e.resetTableConfig(),e.getTableData()}},{title:"任务类型",key:"taskTypeStr",align:"left",minWidth:220,tooltip:!0},{title:"待维护任务数",key:"crmAdvisorTaskCount",align:"left",minWidth:150},{title:"维护次数",key:"followNum",align:"left",minWidth:150},{title:"维护顾问",key:"saveEmpName",align:"left",minWidth:150},{title:"服务中心",key:"serviceCenterName",align:"left",minWidth:150},{title:"操作",slot:"action",align:"left",fixed:"right",width:150}],columns2:[{title:"学员编号",key:"stuLoginName",align:"left",minWidth:130},{minWidth:120,title:"学员姓名",key:"stuRealName",align:"left",render:function(t,a){var n=[t("a",{on:{click:function(){var t={card:a.row.stuLoginName,cityCode:a.row.areaCode};Object(w.a)("click_lFbbBiRS",{task_name:e.taskType+"",channel_name:e.tableType>2?1:0}),e.goCustomerDetail(t)}}},a.row.stuRealName||"无"),t("Icon",{props:{custom:"iconfont icon-phone-fill"},style:{cursor:"pointer",marginLeft:"5px",display:e.callShow(a.row.areaCode)?"block":"none"},on:{click:function(){e.$store.state.app.callInstance.call(a.row.areaCode,a.row.pyUid)}}})];return t("div",{style:{display:"flex",alignItems:"center"}},n)}},{title:"联系电话",key:"stuMobile",align:"left",minWidth:160,render:function(e,t){return e("TalDecodeText",{props:{uid:t.row.pyUid,encodeText:t.row.stuMobile,type:"phone"}})}},{title:"注册渠道",key:"stuRegistName",align:"left",minWidth:160,slot:"stuRegistName"},{title:"注册时间",key:"stuCreateDate",align:"left",minWidth:175},{title:"最长任务时长",key:"taskTimeLast",align:"left",minWidth:150,sortable:"custom"},{title:"加微状态",align:"left",minWidth:150,render:function(e,t){var a="--";switch(t.row.isWechatAdded){case 0:a="从未添加";break;case 1:a="已添加未删除";break;case 2:a="历史添加当前已删除";break;default:a="--"}return e("p",a)}},{title:"当前年级",key:"stuGradeName",align:"left",minWidth:120,filters:[],filterRemote:function(t,a){e.stuGradeIdList=t,e.resetTableConfig(),e.getTableData()}},{title:"任务类型",key:"taskTypeStr",align:"left",minWidth:220,tooltip:!0},{title:"待维护任务数",key:"crmAdvisorTaskCount",align:"left",minWidth:150},{title:"维护次数",key:"followNum",align:"left",minWidth:150},{title:"维护顾问",key:"saveEmpName",align:"left",minWidth:150},{title:"服务中心",key:"serviceCenterName",align:"left",minWidth:150}],columns3:[{title:"学员编号",key:"stuLoginName",align:"left",minWidth:130},{minWidth:120,title:"学员姓名",key:"stuRealName",align:"left",render:function(t,a){var n=[t("a",{on:{click:function(){var t={card:a.row.stuLoginName,cityCode:a.row.areaCode};Object(w.a)("click_lFbbBiRS",{task_name:e.taskType+"",channel_name:e.tableType>2?1:0}),e.goCustomerDetail(t)}}},a.row.stuRealName||"无"),t("Icon",{props:{custom:"iconfont icon-phone-fill"},style:{cursor:"pointer",marginLeft:"5px",display:e.callShow(a.row.areaCode)?"block":"none"},on:{click:function(){e.$store.state.app.callInstance.call(a.row.areaCode,a.row.pyUid)}}})];return t("div",{style:{display:"flex",alignItems:"center"}},n)}},{title:"联系电话",key:"stuMobile",align:"left",minWidth:160,render:function(e,t){return e("TalDecodeText",{props:{uid:t.row.pyUid,encodeText:t.row.stuMobile,type:"phone"}})}},{title:"注册渠道",key:"stuRegistName",align:"left",minWidth:160,slot:"stuRegistName"},{title:"注册时间",key:"stuCreateDate",align:"left",minWidth:175},{title:"当前年级",key:"stuGradeName",align:"left",minWidth:120},{title:"维护时间",key:"closeDate",align:"left",minWidth:175},{title:"任务类型",key:"taskTypeStr",align:"left",minWidth:220,tooltip:!0},{title:"有效沟通",key:"duration",align:"left",minWidth:120,render:function(e,t){return e("span",1===t.row.isEffectiveCommunication?"是":"否")}},{title:"维护次数",key:"followNum",align:"left",minWidth:120},{title:"最后沟通内容",key:"content",align:"left",minWidth:220,tooltip:!0},{title:"响应时长",align:"left",minWidth:160,render:function(e,t){return e("p",t.row.avgReactionCost?function(e){var t=parseInt(e),a=0,n=0;t>60&&(a=parseInt(t/60),t=parseInt(t%60),a>60&&(n=parseInt(a/60),a=parseInt(a%60)));var r=parseInt(t)+"秒";return a>0&&(r=parseInt(a)+"分"+r),n>0&&(r=parseInt(n)+"小时"+r),r}(t.row.avgReactionCost):"--秒")}},{title:"操作",align:"left",minWidth:120,fixed:"right",render:function(t,a){return t("a",{on:{click:function(){e.$emit("task-maintain",{type:7,row:a.row})}}},"添加维护")}}],columns4:[{title:"学员编号",key:"stuLoginName",align:"left",minWidth:130},{minWidth:120,title:"学员姓名",key:"stuRealName",align:"left",render:function(t,a){var n=[t("a",{on:{click:function(){var t={card:a.row.stuLoginName,cityCode:a.row.areaCode};Object(w.a)("click_lFbbBiRS",{task_name:e.taskType+"",channel_name:e.tableType>2?1:0}),e.goCustomerDetail(t)}}},a.row.stuRealName||"无"),t("Icon",{props:{custom:"iconfont icon-phone-fill"},style:{cursor:"pointer",marginLeft:"5px",display:e.callShow(a.row.areaCode)?"block":"none"},on:{click:function(){e.$store.state.app.callInstance.call(a.row.areaCode,a.row.pyUid)}}})];return t("div",{style:{display:"flex",alignItems:"center"}},n)}},{title:"联系电话",key:"stuMobile",align:"left",minWidth:160,render:function(e,t){return e("TalDecodeText",{props:{uid:t.row.pyUid,encodeText:t.row.stuMobile,type:"phone"}})}},{title:"注册渠道",key:"stuRegistName",align:"left",minWidth:160,slot:"stuRegistName"},{title:"注册时间",key:"stuCreateDate",align:"left",minWidth:175},{title:"当前年级",key:"stuGradeName",align:"left",minWidth:120},{title:"维护时间",key:"closeDate",align:"left",minWidth:175},{title:"任务类型",key:"taskTypeStr",align:"left",minWidth:220,tooltip:!0},{title:"有效沟通",key:"duration",align:"left",minWidth:120,render:function(e,t){return e("span",1===t.row.isEffectiveCommunication?"是":"否")}},{title:"维护次数",key:"followNum",align:"left",minWidth:120},{title:"最后沟通内容",key:"content",align:"left",minWidth:220,tooltip:!0},{title:"响应时长",align:"left",minWidth:160,render:function(e,t){return e("p",t.row.avgReactionCost?function(e){var t=parseInt(e),a=0,n=0;t>60&&(a=parseInt(t/60),t=parseInt(t%60),a>60&&(n=parseInt(a/60),a=parseInt(a%60)));var r=parseInt(t)+"秒";return a>0&&(r=parseInt(a)+"分"+r),n>0&&(r=parseInt(n)+"小时"+r),r}(t.row.avgReactionCost):"--秒")}}],stuGradeIdList:[],dateOptions:{shortcuts:[{text:"近一周",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:"近一个月",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}},{text:"近三个月",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]}}]},dateRange:[]}},mounted:function(){1===this.tableType?this.columns=Object(g.a)(this.columns1):2===this.tableType?this.columns=Object(g.a)(this.columns2):3===this.tableType?this.columns=Object(g.a)(this.columns3):4===this.tableType&&(this.columns=Object(g.a)(this.columns4)),1===this.tableType||2===this.tableType?this.type=1:3!==this.tableType&&4!==this.tableType||(this.type=3),1===this.type?this.getGradeList():this.initDate()},methods:{callShow:function(e){var t=this.$store.state.app.callGrayCity;return!(t&&t.length&&!t.includes(e)||!this.$store.state.roleRelativeData.roleIds.includes(this.$store.state.roleRelativeData.userInfo.crmRoleId))},initDate:function(){var e=new Date,t=new Date;t.setTime(t.getTime()-6048e5),this.dateRange=[t,e],this.followStartDate=Object(k.d)(t,"yyyy-MM-dd")+" 00:00:00",this.followEndDate=Object(k.d)(e,"yyyy-MM-dd")+" 23:59:59"},handleDateRangeChange:function(e){var t=Object(h.a)(e,2),a=t[0],n=t[1];this.followStartDate=a,this.followEndDate=n,a&&(this.followStartDate=a+" 00:00:00"),n&&(this.followEndDate=n+" 23:59:59"),Object(w.a)("15-5008",{task_name:e}),this.getTableData()},getGradeList:(S=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(b.u)();case 3:t=e.sent,t=[{value:99,label:"未填写"}].concat(t.map((function(e){return{value:e.id,label:e.name}}))),this.columns1[6].filters=Object.freeze(t)||[],this.columns2[6].filters=Object.freeze(t)||[],e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.$Message.error({content:"获取年级列表失败: "+e.t0.message});case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return S.apply(this,arguments)}),aggrActions:function(e){var t=[];return e.diagnosisTaskContains&&t.push({value:1,label:"散诊跟进"}),e.auditionsTaskContains&&t.push({value:2,label:"试听跟进"}),e.isStudentDiagnosis&&t.push({value:3,label:"诊断报告"}),e.isStuHasReg&&t.push({value:4,label:"报班信息"}),e.isStuHasWait&&t.push({value:5,label:"候补记录"}),e.isStuFollowUp&&t.push({value:6,label:"关键行为"}),e.isAddSave&&t.push({value:7,label:"添加维护"}),e.auditionApplyFollow&&t.push({value:8,label:"试听申请跟进"}),e.isQueryAppClassConsult&&t.push({value:9,label:"查询APP课程咨询"}),t},resetTableConfig:function(){this.tableConfig.pageSize=10,this.tableConfig.pageNo=1},search:function(){this.resetTableConfig(),this.getTableData()},handleSortChange:function(e){this[e.key+"Order"]=e.order,this.resetTableConfig(),this.getTableData()},changePage:function(e){this.tableConfig.pageNo=e,this.getTableData()},pageSizeChange:function(e){this.tableConfig.pageNo=1,this.tableConfig.pageSize=e,this.getTableData()},getTableData:(C=Object(n.a)(regeneratorRuntime.mark((function e(t){var a,n,i,s,o,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.$store.state.roleRelativeData.userInfo,t&&(this.taskType=t,this.tableConfig.pageNo=1,this.tableConfig.pageSize=10,this.tableConfig.hasNextPage=!1),0===t&&(this.taskType=null,this.tableConfig.pageNo=1,this.tableConfig.pageSize=10,this.tableConfig.hasNextPage=!1),i=D((a={cityCode:n.cityCode,crmDeptId:n.crmDeptId,crmRoleId:n.crmRoleId},Object(r.a)(a,this.selectValue,this.inputValue),Object(r.a)(a,"taskType",this.taskType),Object(r.a)(a,"type",this.type),Object(r.a)(a,"stuGradeIdList",this.stuGradeIdList||[]),Object(r.a)(a,"followNumOrder",this.followNumOrder),Object(r.a)(a,"taskTimeLastOrder",this.taskTimeLastOrder),Object(r.a)(a,"followStartDate",this.followStartDate),Object(r.a)(a,"followEndDate",this.followEndDate),a),this.tableConfig),e.prev=4,this.tableConfig.tableLoading=!0,e.next=8,Object(v.a)(i);case 8:s=e.sent,this.tableConfig.totalCount=s.totalCount,this.tableConfig.hasNextPage=s.hasNextPage,s.records.forEach((function(e){e.actions=l.aggrActions(e)||[],e.taskTimeLast>=252e3?e.taskTimeLast="超过70小时":e.taskTimeLast?e.taskTimeLast=x(e.taskTimeLast):e.taskTimeLast="--";var t="";e.taskList&&e.taskList.length>0&&(t=e.taskList.reduce((function(e,t){return e+t.taskName+"、"}),t).slice(0,-1)),e.taskTypeStr=t})),this.table=s.records,e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),o=1===this.type?"获取待维护任务失败":"获取维护记录失败",this.$Message.error({content:"".concat(o,": ").concat(e.t0.message),duration:5});case 19:setTimeout((function(){l.tableConfig.tableLoading=!1}),500);case 20:case"end":return e.stop()}}),e,this,[[4,15]])}))),function(e){return C.apply(this,arguments)})}},I=(a("c68d"),Object(s.a)(T,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"form flex",staticStyle:{"justify-content":"flex-start"}},[a("Input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入关键词搜索",clearable:""},on:{"on-clear":e.search,"on-keyup":function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}},[a("Select",{staticStyle:{width:"86px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}},[a("Option",{attrs:{value:"stuMobile"}},[e._v("手机号")]),e._v(" "),a("Option",{attrs:{value:"stuRealName"}},[e._v("学员姓名")]),e._v(" "),a("Option",{attrs:{value:"stuLoginName"}},[e._v("学员编号")])],1)],1),e._v(" "),3===e.type?[a("span",{staticStyle:{"font-size":"14px","margin-left":"26px","margin-right":"6px"}},[e._v("维护时间 ")]),e._v(" "),a("DatePicker",{staticStyle:{width:"200px"},attrs:{transfer:"",format:"yyyy-MM-dd",type:"daterange",options:e.dateOptions,placement:"bottom-end",placeholder:"选择日期"},on:{"on-change":e.handleDateRangeChange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})]:e._e()],2),e._v(" "),a("Table",{staticStyle:{"border-radius":"0 0 4px 4px"},attrs:{loading:e.tableConfig.tableLoading,maxHeight:300,data:e.table,columns:e.columns},on:{"on-sort-change":e.handleSortChange},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.row;return[n.actions&&1===n.actions.length?[a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.$emit("task-maintain",{type:n.actions[0].value,row:n})}}},[e._v(e._s(n.actions[0].label))])]:e._e(),e._v(" "),n.actions&&n.actions.length>1?[a("div",{staticClass:"flex",staticStyle:{"font-size":"14px"}},[a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.$emit("task-maintain",{type:n.actions[0].value,row:n})}}},[e._v(e._s(n.actions[0].label))]),e._v(" "),a("Dropdown",{attrs:{transfer:"",placement:"bottom-end"},on:{"on-click":function(t){return e.$emit("task-maintain",{type:t,row:n})}}},[a("a",{attrs:{href:"javascript:void(0)"}},[e._v("\n                    更多\n                    "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(n.actions,(function(t,n){return 0!==n?a("DropdownItem",{key:n,attrs:{name:t.value}},[e._v(e._s(t.label))]):e._e()})),1)],1)],1)]:e._e()]}},{key:"stuRegistName",fn:function(t){var n=t.row;return[a("p",{staticStyle:{display:"flex","flex-wrap":"wrap"}},[a("span",[e._v("\n          "+e._s(n.stuRegistName)+"\n          "),n.sceneMessage?[e._v("/"+e._s(n.sceneMessage.sceneType)+" / "+e._s(n.sceneMessage.secondaryType)+" / "+e._s(n.sceneMessage.activityName))]:e._e()],2)])]}}])}),e._v(" "),a("div",{staticClass:"flex",staticStyle:{"margin-top":"16px","margin-bottom":"12px"}},[a("span"),e._v(" "),1===e.type?a("Page",{attrs:{total:e.tableConfig.totalCount,"page-size":e.tableConfig.pageSize,current:e.tableConfig.pageNo,"show-elevator":"","show-sizer":"","show-total":"",transfer:""},on:{"update:current":function(t){return e.$set(e.tableConfig,"pageNo",t)},"on-page-size-change":e.pageSizeChange,"on-change":e.changePage}}):e._e(),e._v(" "),3===e.type?a("div",[a("Dropdown",{staticStyle:{"margin-right":"8px"},attrs:{trigger:"click",transfer:""},on:{"on-click":e.pageSizeChange}},[a("Button",[e._v("\n            "+e._s(e.tableConfig.pageSize)+"条/每页\n            "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:10}},[e._v("10")]),e._v(" "),a("DropdownItem",{attrs:{name:20}},[e._v("20")]),e._v(" "),a("DropdownItem",{attrs:{name:30}},[e._v("30")]),e._v(" "),a("DropdownItem",{attrs:{name:40}},[e._v("40")])],1)],1),e._v(" "),a("Button",{staticStyle:{"margin-right":"8px"},attrs:{disabled:1===e.tableConfig.pageNo},on:{click:function(t){return e.changePage(e.tableConfig.pageNo-1)}}},[e._v("上一页")]),e._v(" "),a("Button",{staticStyle:{"margin-right":"16px"},attrs:{disabled:!e.tableConfig.hasNextPage},on:{click:function(t){return e.changePage(e.tableConfig.pageNo+1)}}},[e._v("下一页")])],1):e._e()],1)],1)}),[],!1,null,"3b483e26",null).exports),N={props:{name:String,rank:Number,rise:Number,medals:Number}},O=(a("0097"),Object(s.a)(N,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"rank-card"},[n("h1",{staticClass:"title"},[e._v(e._s(e.name))]),e._v(" "),n("div",{staticClass:"rank",staticStyle:{"margin-top":"14.5px"}},[n("span",{staticClass:"num"},[e._v(e._s(e.rank||"--"))]),e._v(" "),0!==e.rise?[e.rise>=0?n("Icon",{staticClass:"icon",staticStyle:{color:"#F64242"},attrs:{type:"md-arrow-round-up"}}):n("Icon",{staticClass:"icon",staticStyle:{color:"#32C730"},attrs:{type:"md-arrow-round-down"}}),e._v(" "),n("span",[e._v("排名"+e._s(e.rise>0?"上升":"下降")+e._s(Math.abs(e.rise))+"位")])]:e._e()],2),e._v(" "),e.rise>0?n("span",{staticClass:"desc"},[e._v("较昨日排名上升,继续保持啊!")]):e._e(),e._v(" "),0===e.rise?n("span",{staticClass:"desc"},[e._v("较昨日排名无变化，继续加油更上一层哦")]):e._e(),e._v(" "),e.rise<0?n("span",{staticClass:"desc"},[e._v("较昨日排名下降，使劲往前冲吧!")]):e._e(),e._v(" "),1===e.medals?n("img",{staticClass:"medal",attrs:{src:a("ad18"),alt:""}}):e._e(),e._v(" "),2===e.medals?n("img",{staticClass:"medal",attrs:{src:a("3c7c"),alt:""}}):e._e(),e._v(" "),3===e.medals?n("img",{staticClass:"medal",attrs:{src:a("a0f1"),alt:""}}):e._e()])}),[],!1,null,"924cd5f4",null).exports),L=a("2f62"),R=a("5523"),j=a("6167"),M=a("e0e9"),$=a("02f7"),A=a("46a8"),P=a("efbf"),F=a("7f4db"),z=a("3ce3");function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var B,q,W,V,U,G={name:"advisorWorkbench",mixins:[M.a],components:{NewDataCard:o,ResourceCard:c,HScroll:p,TaskTypeCard:f,TaskTable:I,RankCard:O,MaintainRecordAdd:$.a,FllowDiagnosisRecord:A.a,FollowRecord:P.a,ClassTable:z.a,AuditionFollowRecord:F.a},computed:H({},Object(L.e)({userInfo:function(e){return e.roleRelativeData.userInfo},roleId:function(e){return e.roleRelativeData.userInfo.crmRoleId},cityCode:function(e){return e.roleRelativeData.userInfo.cityCode}})),watch:{cityCode:function(){this.initView()}},data:function(){return{waitTaskTypeLoading:!1,recordTaskTypeLoading:!1,tabName:"taskTable1",secondHScrollInitSuccess:!1,formData:{month:null,serviceCenterId:""},monthList:[],serviceCenterList:[],waitTaskTypeList:[],activeWaitTaskType:null,recordTaskTypeList:[],activeRecordTaskType:null,advisorNewData:{},managerNewData:[],resourceWarningData:{regNotAddWechatList:[],regNotTransferList:[],productsNotTransformList:[],customerLevelList:[]},regNotAddWechatTips:'<p style="display: flex; flex-direction: column">\n                              <span>资源列表中，一段时间内注册，但是没有被任何一个顾问添加微信的学员人数，（不含当日数据）。</span>\n                              <span>点击数字，可跳转资源列表，查看明细。当数据大于500时。仅支持查看前500学员信息。</span>\n                            </p> <p style="display: flex; flex-direction: column">\n                              <b>昨日</b>\n                              <span>昨日注册，但是昨日未完成添加微信的学员人数。</span>\n                            </p> <p style="display: flex; flex-direction: column">\n                              <b>近7日</b>\n                              <span>最近7日内累积注册，但是截止昨日未完成添加微信的学员人数。</span>\n                            </p> <p style="display: flex; flex-direction: column">\n                              <b>近14日</b>\n                              <span>最近14日内累积注册，但是截止昨日未完成添加微信的学员人数。</span>\n                            </p>',regNotTransferTips:'<p style="display: flex; flex-direction: column">\n                              <span>资源列表中，一段时间内注册，完成注册，但是仍未完成转化的累积学员人数。</span>\n                              <span>点击数字，可跳转资源列表，查看明细。当数据大于500时。仅支持查看前500学员信息。</span>\n                            </p> <p style="display: flex; flex-direction: column">\n                              <b>近7日</b>\n                              <span>最近7日内累积注册，但是截止昨日完成转化的学员人数。</span>\n                            </p> <p style="display: flex; flex-direction: column">\n                              <b>近14日</b>\n                              <span>最近14日内累积注册，但是截止昨日未完成转化的学员人数。</span>\n                            </p> <p style="display: flex; flex-direction: column">\n                              <b>近30日</b>\n                              <span>最近30日内累积注册，但是截止昨日未完成转化的学员人数。</span>\n                            </p>',productsNotTransformTips:'<p style="display: flex; flex-direction: column">\n                              <span>资源列表中，最近30天（含）内，参加过转化产品，但是截止昨日，仍未完成对应学科转化的学员人数，（含当日数据）。</span>\n                              <span>点击数字，可跳转资源列表，查看明细。当数据大于500时。仅支持查看前500学员信息。</span>\n                            </p> <p style="display: flex; flex-direction: column">\n                              <b>参诊未转化</b>\n                              <span>资源列表中，参加过试听课，但是截止昨日，仍未完成对应科目转化的学员人数。</span>\n                            </p> <p style="display: flex; flex-direction: column">\n                              <b>试听未转化</b>\n                              <span>资源列表中，参加过试听课，但是截止昨日，仍未完成对应科目转化的学员人数。</span>\n                            </p>',customerLevelTips:'<p style="display: flex; flex-direction: column">\n                              <span>资源列表中，最近30天（含）内有跟进，最近一次任务跟进或散诊维护的用户意愿。</span>\n                              <span>点击数字，可跳转资源列表，查看明细。当数据大于500时。仅支持查看前500学员信息。</span>\n                            </p>'}},mounted:function(){this.initView()},methods:{initView:function(){var e=this;this.$nextTick(Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.cityCode&&e.roleId&&(2===e.roleId&&e.queryDeptByAreaCode(),4===e.roleId&&e.getTargetPank(),5===e.roleId&&(e.inintMonth(),e.getConsultTargetPank()),e.taskSummary(1),e.taskSummary(3),e.$refs.taskTable1.getTableData(),e.$refs.taskTable2.getTableData(),e.resourceWarning());case 1:case"end":return t.stop()}}),t)}))))},handleRefresh:function(){this.taskSummary(1),this.taskSummary(3),this.$refs.taskTable1.getTableData(),this.$refs.taskTable2.getTableData()},handleTabClick:function(e){var t;t="taskTable1"===e?"待维护任务":"维护记录",Object(w.a)("15-5004",{tab_name:t,code:void 0}),this.secondHScrollInitSuccess=!0,this.$refs[e+"Scroll"]&&this.$refs[e+"Scroll"].refresh()},goTargetMgt:function(){this.$router.push({name:"targetMgt"})},handleServiceCenterChange:function(e){this.getTargetPank(e)},handleResourceCountClick:function(e,t,a){this.$router.push({name:"resourceList2ForMulti",params:{id:(new Date).getTime()},query:H({type:e,typeName:t},a)}),Object(w.a)("15-5009",{cardValue_id:t,card_name:a.name,card_num:a.count})},resourceWarning:(U=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={crmRoleId:this.userInfo.crmRoleId,crmDeptId:this.userInfo.crmDeptId,cityCode:this.userInfo.cityCode,baseDataId:this.userInfo.baseDataId},e.next=4,Object(j.P)(t);case 4:a=e.sent,this.resourceWarningData=a,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$Message.error({content:"获取资源预警数据失败: ".concat(e.t0.message),duration:5});case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return U.apply(this,arguments)}),handleMonthChange:function(){Object(w.a)("15-5002",{month:this.formData.month}),this.getConsultTargetPank()},inintMonth:function(){var e,t,a,n=(new Date).getMonth()+1;0===(e=n-1)&&(e=12),13===(t=n+1)&&(t=1),13===(a=t+1)&&(a=1),this.monthList=[e,n,t,a],this.formData.month=n},getTargetPank:(V=Object(n.a)(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={cityCode:this.cityCode,serviceId:t||this.userInfo.crmDeptId},e.next=4,Object(R.f)(a);case 4:n=e.sent,this.managerNewData=n,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$Message.error({content:"获取服务中心招新数据失败: ".concat(e.t0.message),duration:5});case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return V.apply(this,arguments)}),getConsultTargetPank:(W=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(new Date).getFullYear(),a={cityCode:this.cityCode,month:this.formData.month,year:t},e.next=5,Object(R.c)(a);case 5:n=e.sent,this.advisorNewData=Object.freeze(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.$Message.error({content:"获取顾问招新数据失败: ".concat(e.t0.message),duration:5});case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return W.apply(this,arguments)}),queryDeptByAreaCode:function(){var e=this;Object(j.l)({areaCode:this.cityCode,isActive:1}).then((function(t){e.serviceCenterList=Object.freeze(t),e.serviceCenterList&&e.serviceCenterList[0]&&(e.formData.serviceCenterId=e.serviceCenterList[0].id,e.getTargetPank(e.formData.serviceCenterId))})).catch((function(t){e.$message.error("查询服务中心列表错误："+t.message)}))},taskSummary:(q=Object(n.a)(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,1===t?this.waitTaskTypeLoading=!0:3===t&&(this.recordTaskTypeLoading=!0),a={cityCode:this.cityCode,crmDeptId:this.userInfo.crmDeptId,crmRoleId:this.roleId,type:t},e.next=5,Object(v.r)(a);case 5:(n=e.sent).forEach((function(e,t){e.checked=0===t})),1===t?this.waitTaskTypeList=n:3===t&&(this.recordTaskTypeList=n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),this.$Message.error({content:"获取任务类型汇总数据失败: ".concat(e.t0.message),duration:5});case 13:1===t?this.waitTaskTypeLoading=!1:3===t&&(this.recordTaskTypeLoading=!1);case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e){return q.apply(this,arguments)}),topAdvisorType:(B=Object(n.a)(regeneratorRuntime.mark((function e(t,a){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(v.s)(t);case 3:return e.next=5,this.taskSummary(a);case 5:n=null,3===a?n=this.activeRecordTaskType:1===a&&(n=this.activeWaitTaskType),n&&(console.log("active",n),this.handleTaskClick(a,n)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),this.$Message.error({content:"修改置顶失败: ".concat(e.t0.message),duration:5});case 13:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e,t){return B.apply(this,arguments)}),handleTop:function(e,t){Object(w.a)("15-5003",{task_name:t.taskName}),this.topAdvisorType(H(H({},t),{},{isTop:1}),e)},handleCancelTop:function(e,t){this.topAdvisorType(H(H({},t),{},{isTop:0}),e)},handleTaskClick:function(e,t){Object(w.a)("15-5005",{task_name:1===e?"待维护任务":"维护记录",filter_type:t.taskName}),1===e?(this.activeWaitTaskType=t,this.waitTaskTypeList.forEach((function(e){e.checked=!1,e.taskType===t.taskType&&(e.checked=!0)})),this.$refs.taskTable1.getTableData(t.taskType)):3===e&&(this.activeRecordTaskType=t,this.recordTaskTypeList.forEach((function(e){e.checked=!1,e.taskType===t.taskType&&(e.checked=!0)})),this.$refs.taskTable2.getTableData(t.taskType))}}},K=(a("7652"),Object(s.a)(G,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layout"},[2===e.roleId?a("div",{staticClass:"layout-card"},[a("Select",{staticStyle:{width:"216px"},attrs:{placeholder:"服务中心",filterable:"",clearable:""},on:{"on-change":e.handleServiceCenterChange},model:{value:e.formData.serviceCenterId,callback:function(t){e.$set(e.formData,"serviceCenterId",t)},expression:"formData.serviceCenterId"}},e._l(e.serviceCenterList,(function(t,n){return a("Option",{key:n,attrs:{value:t.id}},[e._v(e._s(t.deptName))])})),1)],1):e._e(),e._v(" "),a("div",{staticClass:"new-data"},[a("div",{staticClass:"flex"},[a("h1",{staticClass:"title"},[e._v("招新数据\n        "),a("Tooltip",{staticStyle:{transform:"translate(0, -3px)"},attrs:{placement:"left-start",transfer:"",theme:"light","max-width":800}},[a("Icon",{staticClass:"icon-help",attrs:{type:"ios-help-circle-outline"}}),e._v(" "),a("div",{attrs:{slot:"content"},slot:"content"},[a("p",{staticClass:"tooltip-p"},[a("span",[e._v("统计单位:人次")]),e._v(" "),a("span",[e._v("招新目标数据来源：顾问主管、城市经理在盘古平台-运营管理-目标管理，菜单下设置。")]),e._v(" "),a("span",[e._v("达成数据来源：盘古平台-长期班绩效明细看板。")])]),e._v(" "),a("p",{staticClass:"tooltip-p"},[a("b",[e._v("一、实际招新人次说明：")]),e._v(" "),a("span",[e._v("数据指标：学员流量标签。以及实际缴费月份统计。")]),e._v(" "),a("span",[e._v("学员流量标签：")]),e._v(" "),a("span",[e._v("自然流量：先判断报名顾问，再判断维护顾问，以及顾问所属服务中心完成。")]),e._v(" "),a("span",[e._v("拉流流量：先判断报名顾问，再判断注册顾问，以及顾问所属服务中心完成。")])]),e._v(" "),a("p",{staticClass:"tooltip-p"},[a("b",[e._v("二、登录角色可见数据范围说明：")]),e._v(" "),a("span",[e._v("1、服务中心目标&完成：")]),e._v(" "),a("span",[e._v("顾问主管、区域经理、城市经理：当前登录角色下，所选服务中心数据。城市经理可查看分校数据。")]),e._v(" "),a("span",[e._v("服务中心数据统计为盘古系统中，服务中心下对应顾问数据汇总，如果顾问重复开通多服务中心，会造成数据叠加。")]),e._v(" "),a("span",[e._v("2、顾问目标&完成：")]),e._v(" "),a("span",[e._v("顾问：个人数据汇总。")])]),e._v(" "),a("p",{staticClass:"tooltip-p"},[a("b",[e._v("三、数据更新时间：每天10.30，更新昨日数据。")])])])],1)],1),e._v(" "),a("div",{staticStyle:{"margin-left":"35px"}},[5===e.roleId?a("RadioGroup",{attrs:{type:"button","button-style":"solid"},on:{"on-change":e.handleMonthChange},model:{value:e.formData.month,callback:function(t){e.$set(e.formData,"month",t)},expression:"formData.month"}},e._l(e.monthList,(function(t,n){return a("Radio",{key:n,attrs:{label:t}},[e._v(e._s(t)+"月")])})),1):e._e(),e._v(" "),4===e.roleId||2===e.roleId?a("a",{staticStyle:{"font-size":"14px","line-height":"1.5"},attrs:{href:"javascript: void(o);"},on:{click:e.goTargetMgt}},[a("Icon",{staticClass:"icon-edit",attrs:{type:"ios-create-outline"}}),e._v("目标管理\n        ")],1):e._e()],1),e._v(" "),5===e.roleId?a("div",{staticClass:"updateTimeArea"},[a("p",[e._v("数据更新时间："+e._s(e.advisorNewData.updateTime))])]):e._e(),e._v(" "),2===e.roleId||4===e.roleId?a("div",{staticClass:"updateTimeArea"},[a("p",[e._v("数据更新时间："+e._s(e.managerNewData[0]&&e.managerNewData[0].updateTime))])]):e._e()]),e._v(" "),a("Row",{staticStyle:{margin:"16px -8px"},attrs:{gutter:16}},[5===e.roleId?[a("Col",{attrs:{span:"8"}},[a("NewDataCard",{attrs:{name:"个人招新人次",target:e.advisorNewData.personalRecruitment,done:e.advisorNewData.personalRecruitmentDone}})],1),e._v(" "),a("Col",{attrs:{span:"8"}},[a("NewDataCard",{attrs:{name:"服务中心招新人次",target:e.advisorNewData.serviceRecruitment,done:e.advisorNewData.serviceRecruitmentDone}})],1),e._v(" "),a("Col",{attrs:{span:"8"}},[a("RankCard",{attrs:{name:"我的排名",rank:e.advisorNewData.pank,rise:e.advisorNewData.rise,medals:e.advisorNewData.medals}})],1)]:e._e(),e._v(" "),2===e.roleId||4===e.roleId?e._l(e.managerNewData,(function(e,t){return a("Col",{key:t,attrs:{span:"6"}},[a("NewDataCard",{attrs:{name:e.month+"月服务中心招新人次",target:e.serviceRecruitmentTarget,done:e.serviceRecruitment}})],1)})):e._e()],2)],1),e._v(" "),a("div",{staticClass:"task-list"},[a("Tabs",{attrs:{animated:!1},on:{"on-click":e.handleTabClick},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[a("TabPane",{attrs:{label:"待维护任务",name:"taskTable1"}},[a("div",{staticClass:"layout-card"},[a("HScroll",{ref:"taskTable1Scroll"},[e.waitTaskTypeLoading?a("Spin",{attrs:{size:"large",fix:""}}):e._e(),e._v(" "),e._l(e.waitTaskTypeList,(function(t,n){return a("TaskTypeCard",{key:n,staticStyle:{"margin-right":"16px"},attrs:{data:t},on:{"card-click":function(t){return e.handleTaskClick(1,t)},top:function(t){return e.handleTop(1,t)},"cancel-top":function(t){return e.handleCancelTop(1,t)}}})}))],2),e._v(" "),e.roleId?a("TaskTable",{ref:"taskTable1",attrs:{tableType:2===e.roleId||4===e.roleId?2:1},on:{"task-maintain":e.handleAction}}):e._e()],1)]),e._v(" "),a("TabPane",{attrs:{label:"维护记录",name:"taskTable2"}},[a("div",{staticClass:"layout-card"},["taskTable2"===e.tabName||!0===e.secondHScrollInitSuccess?a("HScroll",{ref:"taskTable2Scroll"},[e.recordTaskTypeLoading?a("Spin",{attrs:{size:"large",fix:""}}):e._e(),e._v(" "),e._l(e.recordTaskTypeList,(function(t,n){return a("TaskTypeCard",{key:n,staticStyle:{"margin-right":"16px"},attrs:{data:t},on:{"card-click":function(t){return e.handleTaskClick(3,t)},top:function(t){return e.handleTop(3,t)},"cancel-top":function(t){return e.handleCancelTop(3,t)}}})}))],2):e._e(),e._v(" "),e.roleId?a("TaskTable",{ref:"taskTable2",attrs:{tableType:2===e.roleId||4===e.roleId?4:3},on:{"task-maintain":e.handleAction}}):e._e()],1)])],1),e._v(" "),a("Icon",{staticClass:"refreshIcon",attrs:{type:"md-refresh"},on:{click:e.handleRefresh}})],1),e._v(" "),a("div",{staticClass:"resource-alarm"},[a("h1",{staticClass:"title",staticStyle:{"margin-bottom":"16px"}},[e._v("资源预警")]),e._v(" "),a("Row",{staticStyle:{margin:"0 -8px"},attrs:{gutter:16}},[a("Col",{attrs:{span:"6"}},[a("ResourceCard",{attrs:{name:"注册未加微",tooltips:e.regNotAddWechatTips,data:e.resourceWarningData.regNotAddWechatList.slice(0,-1)},on:{"count-click":function(t){return e.handleResourceCountClick(1,"注册未加微",t)}}})],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("ResourceCard",{attrs:{name:"注册未转化",tooltips:e.regNotTransferTips,data:e.resourceWarningData.regNotTransferList.slice(1)},on:{"count-click":function(t){return e.handleResourceCountClick(2,"注册未转化",t)}}})],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("ResourceCard",{attrs:{name:"转化产品未转化",tooltips:e.productsNotTransformTips,data:e.resourceWarningData.productsNotTransformList},on:{"count-click":function(t){return e.handleResourceCountClick(3,"转化产品未转化",t)}}})],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("ResourceCard",{attrs:{name:"客户分级",tooltips:e.customerLevelTips,data:e.resourceWarningData.customerLevelList},on:{"count-click":function(t){return e.handleResourceCountClick(5,"客户等级",t)}}})],1)],1)],1),e._v(" "),a("div",{staticStyle:{height:"24px"}}),e._v(" "),a("Modal",{attrs:{title:"候补记录",width:"80%","mask-closable":!1,"footer-hide":!0},model:{value:e.showBackupRecordModal,callback:function(t){e.showBackupRecordModal=t},expression:"showBackupRecordModal"}},[e.showBackupRecordModal?a("TalBackupRecordsModal",{attrs:{studentDetail:e.stuDetail,isTaskMode:!0},on:{close:function(t){e.showBackupRecordModal=!1}}}):e._e()],1),e._v(" "),a("Modal",{attrs:{title:"报名未缴费记录",width:"80%","mask-closable":!1,"footer-hide":!0},model:{value:e.showNoPaymentModal,callback:function(t){e.showNoPaymentModal=t},expression:"showNoPaymentModal"}},[e.showNoPaymentModal?a("TalNotPaymentModal",{attrs:{studentDetail:e.stuDetail,isTaskMode:!0},on:{close:function(t){e.showNoPaymentModal=!1}}}):e._e()],1),e._v(" "),a("Modal",{attrs:{"mask-closable":!1,"footer-hide":!0,title:"诊断报告",width:"1060px"},model:{value:e.diagnosisModal,callback:function(t){e.diagnosisModal=t},expression:"diagnosisModal"}},[a("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:e.diagnosisColumns,data:e.diagnosisData},scopedSlots:e._u([{key:"isValid",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(1===n.isValid?"有效":"无效"))])]}},{key:"forRegist",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(1===n.forRegist?"是":"否"))])]}},{key:"reportUrl",fn:function(t){var n=t.row;return[a("Button",{attrs:{ghost:"",type:"primary",size:"small",to:n.reportUrl,target:"_blank"}},[e._v("点击查看")])]}}])})],1),e._v(" "),a("Modal",{attrs:{title:"散诊任务跟进",width:"760","mask-closable":!1,"footer-hide":!0},model:{value:e.showDiagnosisFllowModal,callback:function(t){e.showDiagnosisFllowModal=t},expression:"showDiagnosisFllowModal"}},[e.showDiagnosisFllowModal?a("Tabs",{attrs:{animated:!1},on:{"on-click":e.handleFollowDiagnosisTabsClick},model:{value:e.activeTabId,callback:function(t){e.activeTabId=t},expression:"activeTabId"}},e._l(e.followDiagnosisArr,(function(t,n){return a("TabPane",{key:n,attrs:{label:"预约记录"+(n+1),name:t.id,index:n}},[t.init?a("FllowDiagnosisRecord",{ref:t.id,refInFor:!0,attrs:{diagnosisRecordId:t.id,studentDetail:e.stuDetail},on:{success:function(a){return e.handleFollowDiagnosisRecordSuccess(t.id)},close:function(t){e.showDiagnosisFllowModal=!1}}}):e._e()],1)})),1):e._e()],1),e._v(" "),a("Modal",{attrs:{title:"试听任务跟进",width:"760","mask-closable":!1,"footer-hide":!0},model:{value:e.showAuditionFollowModal,callback:function(t){e.showAuditionFollowModal=t},expression:"showAuditionFollowModal"}},[e.showAuditionFollowModal?a("Tabs",{attrs:{animated:!1},on:{"on-click":e.handleFollowAuditionTabsClick},model:{value:e.activeTabId,callback:function(t){e.activeTabId=t},expression:"activeTabId"}},e._l(e.followAuditionArr,(function(t,n){return a("TabPane",{key:n,attrs:{label:"预约记录"+(n+1),name:t.id,index:n}},[t.init?a("FollowRecord",{ref:t.id,refInFor:!0,attrs:{appointmentApplyId:t.appointmentApplyId,appointmentId:t.id,operationType:1,studentDetail:e.stuDetail},on:{success:e.handleFollowAuditionRecordSuccess,close:function(t){e.showAuditionFollowModal=!1}}}):e._e()],1)})),1):e._e()],1),e._v(" "),a("Modal",{attrs:{title:"试听申请任务跟进",width:"760","mask-closable":!1,"footer-hide":!0},model:{value:e.showAuditionApplyFollowModal,callback:function(t){e.showAuditionApplyFollowModal=t},expression:"showAuditionApplyFollowModal"}},[e.showAuditionApplyFollowModal?a("Tabs",{attrs:{animated:!1},on:{"on-click":e.handleFollowApplyTabsClick},model:{value:e.activeTabId,callback:function(t){e.activeTabId=t},expression:"activeTabId"}},e._l(e.followApplyArr,(function(t,n){return a("TabPane",{key:n,attrs:{label:"试听申请"+(n+1),name:t.id,index:n}},[t.init?a("AuditionFollowRecord",{ref:t.id,refInFor:!0,attrs:{operationType:1,appointmentApplyId:t.appointmentApplyId,appointmentId:t.id,appointmentList:t,studentDetail:e.stuDetail},on:{success:e.handleFollowAuditionRecordSuccess}}):e._e()],1)})),1):e._e()],1),e._v(" "),a("Modal",{attrs:{title:"关键信息",width:"80%","mask-closable":!1,"footer-hide":!0},model:{value:e.keyActionModal,callback:function(t){e.keyActionModal=t},expression:"keyActionModal"}},[e.keyActionData.activityClassList&&e.keyActionData.activityClassList.length?a("div",[a("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("活动类")]),e._v(" "),a("class-table",{attrs:{"student-detail":e.stuDetail,"table-data":e.keyActionData.activityClassList}})],1):e._e(),e._v(" "),e.keyActionData.shortTermClassList&&e.keyActionData.shortTermClassList.length?a("div",[a("h3",{staticStyle:{margin:"10px 0"}},[e._v("短期班")]),e._v(" "),a("class-table",{attrs:{"student-detail":e.studentDetail,"table-data":e.keyActionData.shortTermClassList}})],1):e._e(),e._v(" "),e.keyActionData.mofangActivityList&&e.keyActionData.mofangActivityList.length?a("div",[a("h3",{staticStyle:{margin:"10px 0"}},[e._v("魔方活动")]),e._v(" "),a("Table",{attrs:{columns:e.cubeCols,data:e.keyActionData.mofangActivityList},scopedSlots:e._u([{key:"url",fn:function(t){var n=t.row;return[a("a",{attrs:{href:n.url,target:"_blank"}},[e._v(e._s(n.url))])]}}],null,!1,2361283530)})],1):e._e()]),e._v(" "),a("MaintainRecordAdd",{ref:"addrecord",attrs:{show:e.maintainRecordAddModal,uid:e.stuDetail.pyUid,data:e.maintainRecordAddData},on:{close:function(t){e.maintainRecordAddModal=!1},success:e.addSuccess}}),e._v(" "),a("Modal",{attrs:{title:"查询APP课程咨询","footer-hide":!0},model:{value:e.isShowAppConsultModal,callback:function(t){e.isShowAppConsultModal=t},expression:"isShowAppConsultModal"}},[a("div",{staticStyle:{height:"600px",overflow:"auto"}},e._l(e.appClassConsultContent,(function(t,n){return a("div",{key:n},[t.gradeName?a("p",[e._v("年级："+e._s(t.gradeName))]):e._e(),e._v(" "),t.subjectNames?a("p",[e._v("学科："+e._s(t.subjectNames))]):e._e(),e._v(" "),t.context?a("p",[e._v("内容："+e._s(t.context))]):e._e(),e._v(" "),e.appClassConsultContent.length-1!==n?a("Divider"):e._e()],1)})),0)])],1)}),[],!1,null,"03f34505",null));t.default=K.exports},"93bd":function(e,t,a){},"94fc":function(e,t,a){},9780:function(e,t,a){},"9a2f":function(e,t,a){},a00d2:function(e,t,a){"use strict";a.r(t);a("8e6e"),a("ac6a"),a("cadf"),a("456d"),a("96cf");var n=a("3b8d"),r=a("bd86"),i=a("6167"),s=a("7df4"),o=a("75fc"),l=(a("c5f6"),a("2b0e")),c=a("2f62");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={name:"classTable",props:["schoolId","gradeId","grageName"],data:function(){var e=this;return{columns:[{type:"expand",width:50},{title:"学校",key:"schoolClassName",tooltip:!0,width:150,render:function(e,t){var a=t.row;return e("span",a.schoolClassName?a.schoolClassName:"--")}},{title:"人数",key:"totalPeople",width:150,align:"right",render:function(t,n){var r=n.row,i=(n.columns,n.index);return r.isEdit?t("div",[t("InputNumber",{style:{width:"70px"},props:{controlsPosition:"right",size:"small",value:Number(r.totalPeople),activeChange:!1},on:{input:function(t){l.default.set(e.tableList,i,d(d({},r),{},{totalPeople:t}))}}}),t("span",{class:"button_round button_save",domProps:{innerHTML:"<i class='icon el-icon-close point'></i>"},on:{click:function(){e.onClose(r,i)}}}),t("span",{class:"button_round button_close",domProps:{innerHTML:"<i class='el-icon-check point' ></i>"},on:{click:function(){e.onSave(r,i)}}})]):t("div",[t("span",{style:{height:"15px",lineHeight:"15px",display:"inline-block"}},r.totalPeople),t("span",{style:{fontSize:"12px",display:"inline-block",marginLeft:"10px",width:"15px",height:"21px",cursor:"pointer",verticalAlign:"text-bottom",background:"url("+a("1f2b")+") no-repeat top center"},on:{click:function(){e.isEdit(r,i,!0)}}})])}},{title:"线索渗透",key:"address",align:"center",children:[{title:"人数",key:"music",align:"right",render:function(e,t){t.row;return e("span","--")}},{title:"渗透率",key:"job",align:"center",render:function(e,t){t.row;return e("span","--")}}]},{title:"注册渗透",key:"registerTotal",align:"center",children:[{title:"人数",key:"registerTotalPeople",align:"right",render:function(t,a){var n=a.row;a.columns,a.index;return t("router-link",{style:{color:"#276BFC",cursor:"pointer"},props:{to:{path:"/resource/classRoster",query:{atSchoolTotalPeople:n.atSchoolTotalPeople,totalPeople:n.totalPeople,registerTotalPeople:n.registerTotalPeople,schoolId:n.schoolId,gradeId:n.gradeId,classOrder:n.classOrder,areaCode:n.schoolCode,schoolName:n.schoolName,schoolClassName:n.schoolClassName,grageName:e.grageName}}}},n.registerTotalPeople?n.registerTotalPeople:"--")}},{title:"渗透率",key:"registerPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.registerPermRate?a.registerPermRate:"--")}}]},{title:"在读渗透",key:"atSchoolTotal",align:"center",children:[{title:"人数",key:"atSchoolTotalPeople",align:"right",render:function(e,t){var a=t.row;return e("span",a.atSchoolTotalPeople?a.atSchoolTotalPeople:"--")}},{title:"渗透率",key:"atSchoolPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.atSchoolPermRate?a.atSchoolPermRate:"--")}}]},{title:"班级KOL渗透",key:"total",align:"center",children:[{title:"班级数",key:"totalClass",align:"right",render:function(e,t){var a=t.row;return e("span",a.totalClass?a.totalClass:"--")}},{title:"KOL用户",key:"totalKolPeople",align:"center",render:function(e,t){var a=t.row;return e("span",a.totalKolPeople?a.totalKolPeople:"--")}},{title:"渗透率",key:"kolPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.kolPermRate?a.kolPermRate:"--")}}]}],tableList:[]}},computed:d(d({},Object(c.e)("resource",["classData","classDataLoading","classDataSearch"])),Object(c.e)("roleRelativeData",["userInfo"])),methods:d(d({},Object(c.b)("resource",["queryClassData"])),{},{rowClassName:function(e){e.row,e.index;return"backcolor_deeper"},isEdit:function(e,t,a){l.default.set(this.tableList,t,d(d({},e),{},{isEdit:a}))},onSave:function(e,t){var a=this;if(!e.hasOwnProperty("totalPeople")||null!==e.totalPeople&&void 0!==e.totalPeople)if(e.totalPeople<0)this.$Message.error("保存失败，人数不能小于0人");else if(e.totalPeople>200)this.$Message.error("保存失败，超出最多限额人数200人");else{var n={classOrder:e.classOrder,className:e.schoolClassName,studentCount:e.totalPeople,id:e.schoolClassId,cityCode:this.userInfo.cityCode};Object(s.c)(n).then((function(n){n&&(a.$Message.success("保存成功"),a.isEdit(e,t,!1),a.queryClassData(a.classDataSearch))})).catch((function(e){a.$Message.error("保存失败"+e.message),a.queryClassData(a.classDataSearch)}))}else this.$Message.error("保存失败，人数不能为空")},onClose:function(e,t){this.isEdit(e,t,!1),this.queryClassData(this.classDataSearch)}}),watch:{classDataLoading:{handler:function(){var e=this.classData[this.schoolId+this.gradeId];this.tableList=e&&e.length>0?e:[]},immediate:!0}}},m=(a("6350"),a("2877")),f=Object(m.a)(p,(function(){var e=this.$createElement,t=this._self._c||e;return t("Layout",{attrs:{id:"class-table"}},[t("Row",[t("Table",{attrs:{"row-class-name":this.rowClassName,"disabled-hover":"",columns:this.columns,data:this.tableList,"no-data-text":"暂无数据"}})],1)],1)}),[],!1,null,null,null).exports;function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v={name:"gradeTable",components:{classTable:f},props:["schoolId"],data:function(){return{columns:[{type:"expand",width:50,render:function(e,t){var a=t.row;return e(f,{props:{schoolId:a.schoolId,gradeId:a.gradeId,grageName:a.gradeName}})}},{title:"学校",key:"gradeName",width:150,render:function(e,t){var a=t.row;return e("span",a.gradeName?a.gradeName:"--")}},{title:"人数",key:"totalPeople",align:"right",width:150,render:function(e,t){var a=t.row;return e("span",a.totalPeople?a.totalPeople:"--")}},{title:"线索渗透",key:"address",align:"center",children:[{title:"人数",key:"music",align:"right",render:function(e,t){t.row;return e("span","--")}},{title:"渗透率",key:"job",align:"center",render:function(e,t){t.row;return e("span","--")}}]},{title:"注册渗透",key:"registerTotal",align:"center",children:[{title:"人数",key:"registerTotalPeople",align:"right",render:function(e,t){var a=t.row;return e("span",a.registerTotalPeople?a.registerTotalPeople:"--")}},{title:"渗透率",key:"registerPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.registerPermRate?a.registerPermRate:"--")}}]},{title:"在读渗透",key:"atSchoolTotal",align:"center",children:[{title:"人数",key:"atSchoolTotalPeople",align:"right",render:function(e,t){var a=t.row;return e("span",a.atSchoolTotalPeople?a.atSchoolTotalPeople:"--")}},{title:"渗透率",key:"atSchoolPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.atSchoolPermRate?a.atSchoolPermRate:"--")}}]},{title:"班级KOL渗透",key:"total",align:"center",children:[{title:"班级数",key:"totalClass",align:"right",render:function(e,t){var a=t.row;return e("span",a.totalClass?a.totalClass:"--")}},{title:"KOL用户",key:"totalKolPeople",align:"center",render:function(e,t){var a=t.row;return e("span",a.totalKolPeople?a.totalKolPeople:"--")}},{title:"渗透率",key:"kolPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.kolPermRate?a.kolPermRate:"--")}}]}],tableList:[]}},computed:g(g({},Object(c.e)("resource",["gradeData","gradeDataLoading","gradeDataSearch","classData"])),Object(c.e)("roleRelativeData",["userInfo"])),methods:g(g({},Object(c.b)("resource",["queryClassData"])),{},{expendChange:function(e,t){if(t){var a={schoolId:e.schoolId,gradeId:e.gradeId,cityCode:this.userInfo.cityCode};this.queryClassData(a)}var n=e.schoolId+e.gradeId;this.classData[n]&&(this.classData[n]=this.classData[n].map((function(e){return e.isEdit&&delete e.isEdit,e})))},rowClassName:function(){return"backcolor_deep"}}),watch:{gradeDataLoading:{handler:function(){var e=this.gradeData[this.schoolId];this.tableList=e&&e.length>0?e:[]},immediate:!0}}},b=(a("c48f"),Object(m.a)(v,(function(){var e=this.$createElement,t=this._self._c||e;return t("Layout",{attrs:{id:"grade-table"}},[t("Row",[t("Table",{attrs:{"show-header":!1,"row-class-name":this.rowClassName,columns:this.columns,data:this.tableList,"no-data-text":"暂无数据","disabled-hover":""},on:{"on-expand":this.expendChange}})],1)],1)}),[],!1,null,null,null).exports);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k={components:{gradeTable:b},data:function(){return{loading:!1,isOpen:!1,currentClickItemIndex:-1,allClickItemIndex:[],columns:[{type:"expand",width:50,render:function(e,t){var a=t.row;return e(b,{props:{schoolId:a.schoolId}})}},{title:"学校",key:"schoolName",width:150,render:function(e,t){var a=t.row;return e("span",a.schoolName?a.schoolName:"--")}},{title:"人数",key:"totalPeople",align:"right",width:150,render:function(e,t){var a=t.row;return e("span",a.totalPeople?a.totalPeople:"--")}},{title:"线索渗透",key:"address",align:"center",children:[{title:"人数",key:"music",align:"right",render:function(e,t){t.row;return e("span","--")}},{title:"渗透率",key:"job",align:"center",render:function(e,t){t.row;return e("span","--")}}]},{title:"注册渗透",key:"registerTotal",align:"center",children:[{title:"人数",key:"registerTotalPeople",align:"right",render:function(e,t){var a=t.row;return e("span",a.registerTotalPeople?a.registerTotalPeople:"--")}},{title:"渗透率",key:"registerPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.registerPermRate?a.registerPermRate:"--")}}]},{title:"在读渗透",key:"atSchoolTotal",align:"center",children:[{title:"人数",key:"atSchoolTotalPeople",align:"right",render:function(e,t){var a=t.row;return e("span",a.atSchoolTotalPeople?a.atSchoolTotalPeople:"--")}},{title:"渗透率",key:"atSchoolPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.atSchoolPermRate?a.atSchoolPermRate:"--")}}]},{title:"班级KOL渗透",key:"total",align:"center",children:[{title:"班级数",key:"totalClass",align:"right",render:function(e,t){var a=t.row;return e("span",a.totalClass?a.totalClass:"--")}},{title:"KOL用户",key:"totalKolPeople",align:"center",render:function(e,t){var a=t.row;return e("span",a.totalKolPeople?a.totalKolPeople:"--")}},{title:"渗透率",key:"kolPermRate",align:"center",render:function(e,t){var a=t.row;return e("span",a.kolPermRate?a.kolPermRate:"--")}}]}]}},computed:w(w({},Object(c.e)("resource",["schoolData","schoolDataSearch","schoolDataLoading","gradeData"])),Object(c.e)("roleRelativeData",["userInfo"])),methods:w(w({},Object(c.b)("resource",["querySchoolData","queryGradeData"])),{},{expendChange:function(e,t){var a=this;if(this.currentClickItemIndex=this.schoolData.records.findIndex((function(t){return t.schoolId===e.schoolId})),t){this.allClickItemIndex=[].concat(Object(o.a)(this.allClickItemIndex),[this.currentClickItemIndex]);var n={schoolId:e.schoolId,cityCode:this.userInfo.cityCode};this.queryGradeData(n)}else this.allClickItemIndex=this.allClickItemIndex.filter((function(e){return e!==a.currentClickItemIndex}));this.$nextTick((function(){a.rowClassName(e,a.currentClickItemIndex)}))},changePage:function(e){var t=w(w({},this.schoolDataSearch),{},{pageNum:e});this.querySchoolData(t)},rowClassName:function(e,t){return-1!==this.allClickItemIndex.indexOf(t)?"backcolor_nomal":"backcolor_no"}})},_=(a("66bf"),Object(m.a)(k,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",{attrs:{id:"school-table"}},[a("Row",[a("Table",{staticClass:"tableStyle",attrs:{"row-class-name":e.rowClassName,"disabled-hover":"",columns:e.columns,data:e.schoolData.records,border:"",loading:e.schoolDataLoading},on:{"on-expand":e.expendChange}})],1),e._v(" "),a("Row",{attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{total:e.schoolData.totalCount,current:e.schoolData.pageNo,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}})],1)],1)}),[],!1,null,null,null).exports),D=a("1535"),C=a("127a");a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("7f7f"),a("6b54");function S(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return x(e,t)}(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var T,I,N,O,L={data:function(){return{gradeList:[],classList:[],gradeId:"",classIds:[]}},methods:{setCurrentGradeId:function(e){this.gradeId=e,this.queryClassList()},queryClassList:(T=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a,n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={cityCode:this.cityCode,schoolId:this.schoolId,gradeId:this.gradeId},e.next=4,Object(s.m)(t);case 4:if(a=e.sent,this.classList=a.map((function(e){return e.log={},e})),!this.classList.length){e.next=28;break}if(this.classIds=[this.classList[0].id],"edit"!==this.source){e.next=28;break}n=S(this.classList),e.prev=10,n.s();case 12:if((r=n.n()).done){e.next=20;break}return i=r.value,e.next=16,Object(s.l)({cityCode:this.cityCode,schoolIds:i.id});case 16:(o=e.sent).records&&o.records.length&&(i.log=o.records[0]);case 18:e.next=12;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(10),n.e(e.t0);case 25:return e.prev=25,n.f(),e.finish(25);case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(0),this.$Message.error({content:"查询班级信息错误："+e.t1.message,duration:5});case 33:case"end":return e.stop()}}),e,this,[[0,30],[10,22,25,28]])}))),function(){return T.apply(this,arguments)}),queryGradeClassNum:function(){var e=this;this.classList=[],this.gradeList=[],Object(s.k)({cityCode:this.cityCode,schoolId:this.schoolId}).then((function(t){e.gradeList=t,t.length&&(e.gradeId=t[0].gradeId,"edit"===e.source&&e.queryClassList())})).catch((function(t){e.$Message.error({content:"查询年级、班级个数错误："+t.message,duration:5})}))}}},R=/^[+]?(\d+)$/,j={name:"RecordTab",mixins:[L],components:{TalTab:D.a,TalTabItem:C.a},props:{schoolId:String,cityCode:String},data:function(){return{source:"edit",adding:!1}},methods:{editClassName:function(e){var t=this.classList.find((function(t){return t.id===e}));this.$set(t,"editing",!0)},classBlur:(O=Object(n.a)(regeneratorRuntime.mark((function e(t,a,n){var r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this.classList[a],i=t.target.value,"name"!==n){e.next=10;break}if(r.className!==i){e.next=7;break}return r.editing=!1,e.abrupt("return");case 7:r.className=i,e.next=17;break;case 10:if("count"!==n){e.next=17;break}if(R.test(i)){e.next=14;break}return this.$Message.error({content:"请输入正整数",duration:5}),e.abrupt("return");case 14:if(Number(r.studentCount)!==Number(i)){e.next=16;break}return e.abrupt("return");case 16:r.studentCount=i;case 17:return r.cityCode=this.cityCode,e.next=20,Object(s.c)(r);case 20:return this.$Message.success("更新班级成功"),r.editing=!1,e.next=24,Object(s.l)({cityCode:this.cityCode,schoolIds:r.id});case 24:(o=e.sent).records&&o.records.length?r.log=o.records[0]:r.log={},e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),this.$Message.error({content:"更新班级失败："+e.t0.message,duration:5});case 31:case"end":return e.stop()}}),e,this,[[0,28]])}))),function(e,t,a){return O.apply(this,arguments)}),classCountBlur:(N=Object(n.a)(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.adding=!0,a=t.target.value,!R.test(a)){e.next=14;break}n=1;case 5:if(!(n<=Number(a))){e.next=12;break}return r={cityCode:this.cityCode,schoolId:this.schoolId,gradeId:this.gradeId,classOrder:n,className:"".concat(n,"班"),studentCount:0},e.next=9,this.addClass(r);case 9:n++,e.next=5;break;case 12:e.next=15;break;case 14:this.$Message.error({content:"请输入正整数",duration:5});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),this.$Message.error({content:"批量新增班级失败："+e.t0.message,duration:5});case 20:return e.prev=20,this.adding=!1,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[0,17,20,23]])}))),function(e){return N.apply(this,arguments)}),addNewClass:function(){if(this.adding)this.$Message.warning({content:"新增班级中，新稍后重试...",duration:5});else{var e=this.classList.length+1,t={cityCode:this.cityCode,schoolId:this.schoolId,gradeId:this.gradeId,classOrder:e,className:"".concat(e,"班"),studentCount:0};this.addClass(t)}},addClass:(I=Object(n.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s.a)(t);case 3:return t=e.sent,e.next=6,Object(s.l)({cityCode:this.cityCode,schoolIds:t.id});case 6:(a=e.sent).records&&a.records.length?t.log=a.records[0]:t.log={},this.classList.push(t),this.gradeList.find((function(e){return t.gradeId===e.gradeId})).classCount=this.classList.length,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.$Message.error({content:"新增班级失败："+e.t0.message,duration:5});case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return I.apply(this,arguments)}),deleteClass:function(e){var t=this;this.$Modal.confirm({title:"删除确认",content:"是否确认删除此班级？",onOk:function(){Object(s.b)({cityCode:t.cityCode,id:e}).then((function(){t.$Message.success("删除班级成功"),t.classList=t.classList.filter((function(t){return t.id!==e})),t.gradeList.find((function(e){return e.gradeId===t.gradeId})).classCount=t.classList.length})).catch((function(e){t.$Message.error({content:"删除班级失败："+e.message,duration:5})}))}})}}},M=(a("5091"),Object(m.a)(j,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{border:"1px solid rgba(0, 0, 0, 0.08)",height:"100%"}},[a("div",{staticClass:"all-grade"},[a("div",{staticStyle:{width:"20%","padding-left":"37px"}},[e._v("全部班级")]),e._v(" "),a("div",{staticStyle:{width:"80%","padding-left":"53px"}},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),a("span",[e._v("班级个数")]),e._v(" "),e.classList.length?a("span",[e._v(e._s(e.classList.length))]):a("InputNumber",{attrs:{value:0,min:0,max:50},on:{"on-blur":e.classCountBlur}})],1)]),e._v(" "),a("div",{staticStyle:{height:"100%",display:"flex"}},[a("TalTab",{staticStyle:{width:"20%"}},e._l(e.gradeList,(function(t){return a("TalTabItem",{key:t.gradeId,attrs:{active:t.gradeId===e.gradeId},on:{click:function(a){return e.setCurrentGradeId(t.gradeId)}}},[a("span",{staticClass:"grade-name"},[e._v(e._s(t.gradeName))]),e._v(" "),a("span",{staticClass:"grade-count"},[e._v("共"+e._s(t.classCount?t.classCount:0)+"个")])])})),1),e._v(" "),a("div",{staticClass:"clazz-wrapper"},[e._l(e.classList,(function(t,n){return a("Row",{key:t.id,staticClass:"grade"},[a("Col",{staticClass:"clazz-name",attrs:{span:6}},[a("div",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(t.className))]),e._v(" "),t.editing?a("Input",{staticStyle:{width:"100px"},attrs:{value:t.className},on:{"on-blur":function(t){return e.classBlur(t,n,"name")}}}):a("div",{staticClass:"edit-icon",on:{click:function(a){return e.editClassName(t.id)}}})],1),e._v(" "),a("Col",{staticClass:"clazz-count",attrs:{span:6}},[a("span",{staticStyle:{"margin-right":"20px"}},[e._v("人数")]),e._v(" "),a("InputNumber",{attrs:{value:Number(t.studentCount),min:0,max:200},on:{"on-blur":function(t){return e.classBlur(t,n,"count")}}})],1),e._v(" "),a("Col",{staticClass:"clazz-log",attrs:{span:12}},[a("div",{staticClass:"log-text"},[a("div",[e._v(e._s(t.log.message))]),e._v(" "),a("div",[e._v(e._s(t.log.createTime))])]),e._v(" "),n+1===e.classList.length?a("div",{staticClass:"delete",on:{click:function(a){return e.deleteClass(t.id)}}}):a("div",{staticStyle:{width:"14px"}})])],1)})),e._v(" "),e.classList.length?a("Row",{staticClass:"grade"},[a("Col",{staticClass:"clazz-name",staticStyle:{cursor:"pointer"},attrs:{span:6},nativeOn:{click:function(t){return e.addNewClass(t)}}},[a("span",{staticStyle:{"margin-right":"5px"}},[e._v("+")]),a("span",[e._v("新建班级")])])],1):e._e()],2)],1)])}),[],!1,null,"a87836da",null).exports),$={name:"RecordLog",mixins:[L],props:{schoolId:String,cityCode:String},data:function(){return{source:"log",tableData:[],editTimeRange:[],icons:{modify:"edit",add:"add"},startTime:"",endTime:"",pageSize:10,pageNo:1,totalCount:0}},watch:{classIds:function(e,t){0===e.length&&t.length>0&&(this.classIds=Object(o.a)(t),this.$Message.warning({content:"请至少选择一个班级",duration:5}))}},methods:{queryLogs:function(){var e=this;Object(s.l)({cityCode:this.cityCode,schoolIds:this.classIds.join(","),startTime:this.startTime,endTime:this.endTime,pageNo:this.pageNo,pageSize:this.pageSize}).then((function(t){e.tableData=t.records,e.totalCount=t.totalCount})).catch((function(t){e.$Message.error({content:"查询维护记录失败："+t.message,duration:5})}))},search:function(){this.pageNo=1,this.queryLogs()},timeChange:function(e){this.startTime=e[0]+" 00:00:00",this.endTime=e[1]+" 00:00:00"},changePage:function(e){this.pageNo=e,this.queryLogs()},pageSizeChange:function(e){this.pageNo=1,this.pageSize=e,this.queryLogs()}}},A=(a("a215"),{name:"record",components:{RecordEdit:M,RecordLog:Object(m.a)($,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Form",{attrs:{inline:"","label-width":70}},[a("FormItem",{attrs:{label:"年级"}},[a("Select",{on:{"on-change":e.setCurrentGradeId},model:{value:e.gradeId,callback:function(t){e.gradeId=t},expression:"gradeId"}},e._l(e.gradeList,(function(t){return a("Option",{key:t.gradeId,attrs:{value:t.gradeId}},[e._v(e._s(t.gradeName))])})),1)],1),e._v(" "),a("FormItem",{attrs:{label:"班级"}},[a("Select",{attrs:{multiple:"",filterable:""},model:{value:e.classIds,callback:function(t){e.classIds=t},expression:"classIds"}},e._l(e.classList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.className))])})),1)],1),e._v(" "),a("FormItem",{attrs:{label:"修改时间"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",separator:" ~ ","show-week-numbers":"",placement:"bottom-end",placeholder:"请选择",transfer:""},on:{"on-change":e.timeChange}})],1),e._v(" "),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1)],1),e._v(" "),e.tableData.length?[a("Timeline",{staticStyle:{"max-height":"600px","overflow-y":"auto"}},e._l(e.tableData,(function(t){return a("TimelineItem",{key:t.id},[a("Icon",{attrs:{slot:"dot",type:"ios-radio-button-on",color:"#3b7eff"},slot:"dot"}),e._v(" "),a("div",{staticClass:"record-bar"},[a("div",{staticClass:"left"},[a("div",{staticClass:"icon",class:e.icons[t.operateType]}),e._v(" "),a("span",{staticStyle:{"margin-top":"5px"}},[e._v(e._s(t.operateName))])]),e._v(" "),a("div",{staticClass:"right"},[a("span",{staticStyle:{color:"rgba(0, 0, 0, 0.45)","font-size":"12px","line-height":"24px"}},[e._v(e._s(t.createTime))]),e._v(" "),a("span",[e._v(e._s(t.message))])])])],1)})),1),e._v(" "),a("div",{class:{"page-fix":e.tableData.length<3},staticStyle:{margin:"10px"}},[a("div",{staticStyle:{"text-align":"right"}},[a("Page",{attrs:{total:e.totalCount,"page-size":e.pageSize,current:e.pageNo,"show-elevator":"","show-sizer":"","show-total":""},on:{"update:current":function(t){e.pageNo=t},"on-page-size-change":e.pageSizeChange,"on-change":e.changePage}})],1)])]:a("span",{staticStyle:{"font-size":"14px",color:"rgba(0, 0, 0, 0.25)"}},[e._v("暂无数据")])],2)}),[],!1,null,"579babdd",null).exports},props:{schoolList:{type:Array,default:function(){return[]}},cityCode:String},data:function(){return{schoolId:""}},methods:{init:function(){var e=this;this.$nextTick((function(){e.$refs.tab1.queryGradeClassNum(),e.$refs.tab2.queryGradeClassNum()}))},schoolChange:function(e){this.schoolId=e,this.init()},tabChange:function(e){"name2"===e&&this.$refs.tab2.queryClassList()}},mounted:function(){this.schoolList.length&&(this.schoolId=this.schoolList[0].schoolId,this.init())}});a("1bad");function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var z,E={name:"schoolDic",components:{SchoolTable:_,Record:Object(m.a)(A,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper"},[a("Form",{attrs:{inline:"","label-width":40}},[a("FormItem",{attrs:{label:"学校"}},[a("Select",{on:{"on-change":e.schoolChange},model:{value:e.schoolId,callback:function(t){e.schoolId=t},expression:"schoolId"}},e._l(e.schoolList,(function(t){return a("Option",{key:t.schoolId,attrs:{value:t.schoolId}},[e._v("\n          "+e._s(t.schoolName)+"\n        ")])})),1)],1)],1),e._v(" "),a("Tabs",{attrs:{value:"name1"},on:{"on-click":e.tabChange}},[a("TabPane",{attrs:{label:"信息录入",name:"name1"}},[a("RecordEdit",{ref:"tab1",attrs:{"city-code":e.cityCode,"school-id":e.schoolId}})],1),e._v(" "),a("TabPane",{attrs:{label:"维护记录",name:"name2"}},[a("RecordLog",{ref:"tab2",attrs:{"city-code":e.cityCode,"school-id":e.schoolId}})],1)],1)],1)}),[],!1,null,"406574ce",null).exports},data:function(){return{recordModal:!1,formData:{servicecenterId:"",schoolIdList:[]},scList:[],initSearchParams:{pageSize:10,pageNo:1},queryId:1361}},computed:F(F({},Object(c.e)("resource",["allSchool","schoolDataSearch"])),Object(c.e)("roleRelativeData",["userInfo"])),methods:F(F({},Object(c.b)("resource",["queryAllSchool","querySchoolData"])),{},{recordShow:function(){this.recordModal=!0},onSearch:function(){2!==this.userInfo.crmRoleId&&(this.formData.servicecenterId=this.userInfo.baseDataId);var e=F(F({},this.schoolDataSearch),this.formData);this.querySchoolData(e)},onReset:function(){this.$refs.searchForm.resetFields(),2!==this.userInfo.crmRoleId&&(this.formData.servicecenterId=this.userInfo.baseDataId);var e=F(F({},this.initSearchParams),this.formData);this.querySchoolData(e)},onExport:(z=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a,n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.formData,a=t.schoolIdList,n=t.servicecenterId,r={servicecenterId:n,schoolIds:a&&a.length>0?a:[],cityCode:this.userInfo.cityCode},this.$message.info({message:"正在导出excel，请勿关闭当前标签页",duration:5e3}),Object(s.j)(r).then((function(e){!function e(t,a){Object(s.d)({id:t,queryId:a.queryId,cityCode:this.userInfo.cityCode}).then((function(n){n.filePath?(window.open(n.filePath),a.exportIng=!1):setTimeout((function(){e(t,a)}),2e3)})).catch((function(e){a.exportIng=!1,a.$message.error({message:"导出失败："+e.message,duration:5e3})}))}(e.id,i)})).catch((function(e){i.$message.error({message:e.message,duration:5e3})}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return z.apply(this,arguments)}),queryDeptByAreaCode:function(e){var t=this,a=e.cityCode,n=e.baseDataId,r=e.crmRoleId;Object(i.l)({areaCode:a}).then((function(e){t.scList=e,t.formData.servicecenterId=2!==r?n:e[0].deptCode,t.querySchoolList(t.formData.servicecenterId),t.initSearchParams=F(F({},t.initSearchParams),{},{cityCode:a,servicecenterId:t.formData.servicecenterId}),t.querySchoolData(t.initSearchParams)})).catch((function(e){t.$message.error("查询服务中心列表错误："+e.message)}))},querySchoolList:function(e){var t={cityCode:this.userInfo.cityCode,servicecenterId:e};this.queryAllSchool(t)},changeServicecenterId:function(e){this.querySchoolList(e)}}),watch:{userInfo:{handler:function(e){e&&e.cityCode&&this.queryDeptByAreaCode(e)},immediate:!0}}},H=(a("05fd"),Object(m.a)(E,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dic-wrapper"},[a("div",{staticClass:"title"},[a("div",{staticClass:"text"},[e._v("校内字典")]),e._v(" "),a("div",{staticClass:"btn-group"},[a("Button",{attrs:{type:"primary"},on:{click:e.recordShow}},[e._v("信息录入")]),e._v(" "),a("Button",{on:{click:e.onExport}},[e._v("下载表格")])],1)]),e._v(" "),a("div",{staticClass:"search-wrapper"},[a("Form",{ref:"searchForm",attrs:{model:e.formData,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"服务中心",prop:"servicecenterId"}},[a("Select",{staticClass:"select_w",attrs:{disabled:2!==e.userInfo.crmRoleId},on:{"on-change":e.changeServicecenterId},model:{value:e.formData.servicecenterId,callback:function(t){e.$set(e.formData,"servicecenterId",t)},expression:"formData.servicecenterId"}},e._l(e.scList,(function(e,t){return a("Option",{key:e.deptCode+t,attrs:{value:e.deptCode,label:e.deptName}})})),1)],1),e._v(" "),a("FormItem",{attrs:{label:"学校",prop:"schoolIdList"}},[a("Select",{staticClass:"select_minW",attrs:{multiple:""},model:{value:e.formData.schoolIdList,callback:function(t){e.$set(e.formData,"schoolIdList",t)},expression:"formData.schoolIdList"}},e._l(e.allSchool,(function(e){return a("Option",{key:e.schoolId,attrs:{value:e.schoolId,label:e.schoolName}})})),1)],1)],1),e._v(" "),a("div",[a("Button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),e._v(" "),a("Button",{on:{click:e.onReset}},[e._v("重置")])],1)],1),e._v(" "),a("SchoolTable"),e._v(" "),a("Modal",{attrs:{title:"信息录入","footer-hide":"",width:"80%"},model:{value:e.recordModal,callback:function(t){e.recordModal=t},expression:"recordModal"}},[e.recordModal?a("Record",{attrs:{"school-list":e.allSchool,"city-code":e.userInfo.cityCode}}):e._e()],1)],1)}),[],!1,null,"598e992f",null));t.default=H.exports},a0f1:function(e,t,a){e.exports=a.p+"img/copper.63de491f.png"},a215:function(e,t,a){"use strict";var n=a("47cc");a.n(n).a},a264:function(e,t,a){"use strict";var n=a("d831");a.n(n).a},a289:function(e,t,a){},a45b:function(e,t,a){},a866:function(e,t,a){"use strict";var n=a("9780");a.n(n).a},ad18:function(e,t,a){e.exports=a.p+"img/gold.71a19c62.png"},b6fa:function(e,t,a){"use strict";var n=a("1c69");a.n(n).a},bd61:function(e,t,a){"use strict";var n=a("d5d1");a.n(n).a},c391:function(e,t,a){},c48f:function(e,t,a){"use strict";var n=a("c391");a.n(n).a},c602:function(e,t,a){},c68d:function(e,t,a){"use strict";var n=a("d15a");a.n(n).a},c89e:function(e,t,a){"use strict";var n=a("409f");a.n(n).a},ce12:function(e,t,a){},d15a:function(e,t,a){},d473:function(e,t,a){"use strict";var n=a("1ad0");a.n(n).a},d5d1:function(e,t,a){},d831:function(e,t,a){},d8e7:function(e,t,a){},e0e9:function(e,t,a){"use strict";a("8e6e"),a("cadf"),a("456d"),a("f751"),a("0d6d"),a("96cf");var n,r,i,s,o=a("3b8d"),l=(a("ac6a"),a("bd86")),c=a("7665"),u=a("6167"),d=a("49e5"),p=a("c3a7"),m=a("c7d4"),f=a("7e65"),h=a("e61f"),g=a("a78e"),v=a.n(g);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}t.a={data:function(){return{showBackupRecordModal:!1,showNoPaymentModal:!1,diagnosisModal:!1,showDiagnosisFllowModal:!1,showAuditionFollowModal:!1,showAuditionApplyFollowModal:!1,keyActionModal:!1,maintainRecordAddModal:!1,stuDetail:{},followDiagnosisArr:[],followAuditionArr:[],followApplyArr:[],activeTabId:"",diagnosisData:[],diagnosisColumns:[{type:"index",width:30,align:"center"},{title:"城市",key:"cityName",align:"center"},{title:"年级",key:"gradeName",align:"center"},{title:"学科",key:"subjectName",align:"center"},{title:"学期",key:"termName",align:"center"},{title:"学员编号",key:"stuCode",align:"center",width:100},{title:"学员姓名",key:"stuName",align:"center"},{title:"分数",key:"score",align:"center"},{title:"班次级别",key:"levelDegreeName",align:"center"},{title:"班次名称",key:"levelName",align:"center"},{title:"报告URL",slot:"reportUrl",align:"center",width:130},{title:"成绩来源",key:"sourceTypeName",align:"center"},{title:"班次生效时间",key:"effectiveClaLevelTime",align:"center"},{title:"成绩是否有效",slot:"isValid",align:"center"},{title:"成绩是否用于报班",slot:"forRegist",align:"center"},{title:"作答时间",key:"answerDateTime",align:"center",width:130}],keyActionData:[],cubeCols:[{title:"活动名称",align:"center",key:"activityName"},{title:"活动类型",align:"center",key:"type"},{title:"活动URL",align:"center",slot:"url"}],maintainRecordAddData:{},appClassConsultContent:[],isShowAppConsultModal:!1}},methods:{refreshFullData:function(){var e=this;setTimeout((function(){e.taskSummary(1),e.taskSummary(3),e.$refs.taskTable1.getTableData(),e.$refs.taskTable2.getTableData()}),1500)},handleAction:function(e){var t=e.type,a=e.row,n="";switch(t){case 1:n="散诊跟进",this.followDiagnosisHandle(a);break;case 2:n="试听跟进",this.followAuditionHandle(a);break;case 3:n="诊断报告",this.diagnosisHandle(a.taskList);break;case 4:n="报班信息",this.classInfoHandle(a);break;case 5:n="候补记录",this.backupRecordHandle(a);break;case 6:n="关键行为",this.showKeyAction(a);break;case 7:Object(h.a)("15-5006",{task_name:this.activeRecordTaskType?this.activeRecordTaskType.taskName:"全部任务"}),this.maintainRecordAdd(a);break;case 8:n="试听申请跟进",this.auditionApplyHandle(a);break;case 9:this.appClassConsult(a)}n&&Object(h.a)("15-5007",{task_name:n})},addSuccess:function(e){var t=this,a=e;a.identityId="",a.pyUid=this.stuDetail.pyUid,Object(f.a)(a).then((function(){t.maintainRecordAddModal=!1,t.$Message.success({content:"添加维护记录成功",duration:5}),t.$refs.addrecord.setValue(),t.refreshFullData()})).catch((function(e){t.$Message.error({content:"添加维护记录失败："+e.message,duration:5})}))},maintainRecordAdd:function(e){var t=this;this.stuDetail=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e),this.maintainRecordAddModal=!0,Object(f.o)({studentUid:e.pyUid}).then((function(e){t.maintainRecordAddData=e})).catch((function(e){t.$Message.error({content:"获取信息失败："+e.message,duration:5})}))},showKeyAction:function(e){var t=this;this.stuDetail.cityCode=e.areaCode,this.stuDetail.studentId=e.studentId,Object(u.N)({studentId:e.studentId,pyUid:e.pyUid,uid:e.pyUid,mode:4,cityCode:e.areaCode}).then((function(e){t.keyActionData=e,t.keyActionModal=!0})).catch((function(e){t.$Message.error("查询关键行为错误："+e.message)}))},handleFollowAuditionRecordSuccess:function(){this.refreshFullData()},handleFollowAuditionTabsClick:function(e){this.followAuditionArr.forEach((function(t){t.id===e&&(t.init=!0)}))},handleFollowDiagnosisRecordSuccess:function(){this.refreshFullData()},handleFollowDiagnosisTabsClick:function(e){this.followDiagnosisArr.forEach((function(t){t.id===e&&(t.init=!0)}))},followDiagnosisHandle:(s=Object(o.a)(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stuDetail={realName:t.stuRealName,gradeName:t.stuGradeName,card:t.stuLoginName,cityCode:t.areaCode,areaCode:t.areaCode,uid:t.pyUid},e.prev=1,e.next=4,Object(c.h)({pyUid:t.pyUid});case 4:(a=e.sent).forEach((function(e,t){0===t?(n.activeTabId=e.id,e.init=!0):e.init=!1})),this.followDiagnosisArr=a,this.showDiagnosisFllowModal=!0,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),this.$Message.error({content:e.t0.message,duration:5});case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return s.apply(this,arguments)}),appClassConsult:(i=Object(o.a)(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],t.taskList&&t.taskList.length>0&&t.taskList.forEach((function(e){40===e.taskType&&a.push(e.taskId)})),a=a.length>0&&a.join(","),e.prev=3,n={taskId:a},e.next=7,Object(u.A)(n);case 7:r=e.sent,this.appClassConsultContent=r||[],this.isShowAppConsultModal=!0,e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),this.isShowAppConsultModal=!1,this.$Message.error({content:e.t0.message,duration:5});case 16:case"end":return e.stop()}}),e,this,[[3,12]])}))),function(e){return i.apply(this,arguments)}),diagnosisHandle:function(e){var t=this;try{var a=[];e.forEach((function(e){a.push(e.taskId)})),this.diagnosisData=[],this.$nextTick(Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.L)(a);case 2:n=e.sent,t.diagnosisData=Object.freeze(n),t.diagnosisModal=!0;case 5:case"end":return e.stop()}}),e)}))))}catch(e){this.$Message.error({content:"获取诊断报告失败："+e.message})}},classInfoHandle:function(e){var t=this,a={cityCode:e.areaCode,uid:e.pyUid};Object(d.b)(a).then((function(a){t.stuDetail={cityCode:e.cityCode,studentId:a.studentId,bindingCode:a.bindingCode},t.showNoPaymentModal=!0})).catch((function(e){t.$Message.error({content:"获取学员信息失败: "+e.message,duration:5})}))},backupRecordHandle:function(e){var t=this,a={cityCode:e.areaCode,uid:e.pyUid};Object(d.b)(a).then((function(a){t.stuDetail={cityCode:e.cityCode,studentId:a.studentId,bindingCode:a.bindingCode},t.showBackupRecordModal=!0})).catch((function(e){t.$Message.error({content:"获取学员信息失败: "+e.message,duration:5})}))},followAuditionHandle:(r=Object(o.a)(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stuDetail={realName:t.stuRealName,gradeName:t.stuGradeName,card:t.stuLoginName,cityCode:t.areaCode,areaCode:t.areaCode,uid:t.pyUid},e.prev=1,e.next=4,Object(p.c)({pyUid:t.pyUid,operationType:1});case 4:if((a=(a=e.sent).map((function(e,t){return 0===t?(n.activeTabId=e.id,Object.assign(e,{init:!0})):Object.assign(e,{init:!1})})))&&0!==a.length){e.next=9;break}return this.$Message.info({content:"试听任务已全部处理"}),e.abrupt("return");case 9:this.followAuditionArr=a,this.showAuditionFollowModal=!0,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),this.$Message.error({content:e.t0.message,duration:5});case 16:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e){return r.apply(this,arguments)}),handleFollowApplyTabsClick:function(e){this.followApplyArr.forEach((function(t){t.id===e&&(t.init=!0)}))},auditionApplyHandle:(n=Object(o.a)(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(m.c)({pyUid:t.pyUid,empNo:JSON.parse(v.a.get("columbusUserInfo")).id});case 3:if((a=(a=e.sent).appointmentList.map((function(e,t){return 0===t?(n.activeTabId=e.id,Object.assign(e,{init:!0})):Object.assign(e,{init:!1})})))&&0!==a.length){e.next=8;break}return this.$Message.info({content:"试听任务已全部处理"}),e.abrupt("return");case 8:this.followApplyArr=a,this.showAuditionApplyFollowModal=!0,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.$Message.error({content:e.t0.message,duration:5});case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return n.apply(this,arguments)})}}},e1db:function(e,t,a){},e457:function(e,t,a){},e5ed:function(e,t,a){},e61fc:function(e,t,a){"use strict";var n=a("0d3d");a.n(n).a},ef29:function(e,t,a){"use strict";var n=a("41e1");a.n(n).a},f068:function(e,t,a){},f5af:function(e,t,a){},f60d:function(e,t,a){"use strict";var n=a("ce12");a.n(n).a},f6ce:function(e,t,a){"use strict";var n=a("1c43");a.n(n).a},f79b:function(e,t,a){},fc85:function(e,t,a){"use strict";var n=a("8b5d");a.n(n).a}}]);
//# sourceMappingURL=resource.8d10d86d.js.map