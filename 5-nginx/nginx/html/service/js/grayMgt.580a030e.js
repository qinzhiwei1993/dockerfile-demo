(window.webpackJsonp=window.webpackJsonp||[]).push([["grayMgt"],{"2af2":function(t,e,a){"use strict";a.r(e);a("8e6e"),a("cadf"),a("456d"),a("0d6d");var r=a("bd86"),n=(a("f751"),a("386d"),a("ac6a"),a("96cf"),a("3b8d")),s=a("867e"),i=a("f825"),c=a("66df");function o(t){return c.a.request({url:"store/saveCityGray",method:"post",data:t})}function u(t){return c.a.request({url:"store/getServiceCenterList",method:"get",params:t})}function l(t){return c.a.request({url:"store/saveServiceCenterGray",method:"post",data:t})}function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}var d,f,p,m,y,g,v={components:{ScrollWrap:a("ce61").a},data:function(){var t=this;return{cityList:[],areaList:[],tableLoading:!1,tableData:[],columns:[{title:"服务中心",key:"serviceCenterName",align:"center"},{title:"操作时间",key:"createDate",align:"center"},{title:"状态",key:"status",align:"center",render:function(e,a){return e(i.Switch,{props:{value:a.row.status,disabled:1!==t.formData.status,"true-value":1,"false-value":0},on:{"on-change":function(e){t.saveServiceCenterGray(a.row,e)}}})}}],formData:{cityCode:"",status:"",wechatStatus:"",areaId:"",likeName:"",totalCount:0,pageSize:10,pageNo:1},grayStatusMap:{0:"关闭",1:"部分",2:"全量"},currentCity:null,maxTableHeight:null}},mounted:function(){this.queryCityGrayList()},methods:{handleOnResize:function(t){this.maxTableHeight=t.clientHeight-132-92-10},saveServiceCenterGray:(g=Object(n.a)(regeneratorRuntime.mark((function t(e,a){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.status=a,t.prev=1,r={cityName:this.formData.cityName,cityCode:this.formData.cityCode,status:a,serviceCenterId:e.serviceCenterId,serviceCenterName:e.serviceCenterName,areaId:e.areaId},t.next=5,l(r);case 5:this.$Message.success("服务中心灰度状态修改成功"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),e.status=1===a?0:1,this.$Message.error({content:"服务中心灰度状态修改失败: ".concat(t.t0.message),duration:5});case 12:case"end":return t.stop()}}),t,this,[[1,8]])}))),function(t,e){return g.apply(this,arguments)}),search:function(){this.getTableData()},handleWechatStatusChange:(y=Object(n.a)(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={cityName:this.formData.cityName,cityCode:this.formData.cityCode,wechatStatus:e},t.next=4,o(a);case 4:this.currentCity.wechatStatus=e,this.$Message.success("灰度状态变更成功"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),this.formData.wechatStatus=this.currentCity.wechatStatus,this.$Message.error({content:"灰度状态变更失败: ".concat(t.t0.message),duration:5});case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(t){return y.apply(this,arguments)}),handleGrayStatusChange:(m=Object(n.a)(regeneratorRuntime.mark((function t(e){var a,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={cityName:this.formData.cityName,cityCode:this.formData.cityCode,status:e},t.next=4,o(a);case 4:this.currentCity.status=e,this.cityList.forEach((function(t){t.cityCode===r.currentCity.cityCode&&r.$set(t,r.currentCity)})),this.search(),this.$Message.success("灰度状态变更成功"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),this.formData.status=this.currentCity.status,this.$Message.error({content:"灰度状态变更失败: ".concat(t.t0.message),duration:5});case 14:case"end":return t.stop()}}),t,this,[[0,10]])}))),function(t){return m.apply(this,arguments)}),handleCityChange:function(t){var e=this.cityList.filter((function(e){return e.cityCode===t}))[0];this.currentCity=e,Object.assign(this.formData,function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},e)),this.getAreaList(),this.search()},getTableData:(p=Object(n.a)(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.formData.cityCode){t.next=2;break}return t.abrupt("return",this.$Message.warning("请选择分校"));case 2:return this.tableLoading=!0,t.prev=3,e={cityCode:this.formData.cityCode,areaId:this.formData.areaId,likeName:this.formData.likeName},t.next=7,u(e);case 7:a=t.sent,this.tableData=a,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),this.$Message.error({content:"获取服务服务中心灰度列表失败: ".concat(t.t0.message),duration:5});case 14:this.tableLoading=!1;case 15:case"end":return t.stop()}}),t,this,[[3,11]])}))),function(){return p.apply(this,arguments)}),getAreaList:(f=Object(n.a)(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e={cityCode:this.formData.cityCode},t.next=4,Object(s.c)(e);case 4:a=t.sent,this.areaList=Object.freeze(a),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.$Message.error({content:"获取区域列表失败: ".concat(t.t0.message),duration:5});case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return f.apply(this,arguments)}),queryCityGrayList:(d=Object(n.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a=void 0,c.a.request({url:"store/queryCityGrayList",method:"get",params:a});case 3:e=t.sent,this.cityList=Object.freeze(e)||[],t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),this.$Message.error({content:"获取灰度分校列表失败: ".concat(t.t0.message),duration:5});case 10:case"end":return t.stop()}var a}),t,this,[[0,7]])}))),function(){return d.apply(this,arguments)})}},b=(a("5078"),a("2877")),C=Object(b.a)(v,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"layout"},[a("div",{staticClass:"top"},[a("Select",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{filterable:"",placeholder:"请选择分校"},on:{"on-change":t.handleCityChange},model:{value:t.formData.cityCode,callback:function(e){t.$set(t.formData,"cityCode",e)},expression:"formData.cityCode"}},t._l(t.cityList,(function(e,r){return a("Option",{key:r,attrs:{value:e.cityCode}},[t._v(t._s(e.cityName+"-"+t.grayStatusMap[e.status]))])})),1),t._v(" "),t.formData.cityCode?[a("RadioGroup",{on:{"on-change":t.handleGrayStatusChange},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},[a("Radio",{attrs:{label:2}},[a("span",[t._v("全量")])]),t._v(" "),a("Radio",{attrs:{label:1}},[a("span",[t._v("部分")])]),t._v(" "),a("Radio",{attrs:{label:0}},[a("span",[t._v("关闭")])])],1),t._v(" "),a("div",{staticClass:"border"}),t._v(" "),a("div",{staticClass:"add-wx"},[t._v("\n        加微方式:\n        "),a("RadioGroup",{staticStyle:{"margin-left":"20px"},on:{"on-change":t.handleWechatStatusChange},model:{value:t.formData.wechatStatus,callback:function(e){t.$set(t.formData,"wechatStatus",e)},expression:"formData.wechatStatus"}},[a("Radio",{attrs:{label:1}},[a("span",[t._v("企微")])]),t._v(" "),a("Radio",{attrs:{label:0}},[a("span",[t._v("个微")])])],1)],1)]:t._e()],2),t._v(" "),a("ScrollWrap",{attrs:{"open-resize":"","cus-style":{"max-height":"calc(100vh - 132px)"}},on:{"on-resize":t.handleOnResize}},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"search"},[a("Select",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{clearable:"",filterable:"",placeholder:"请选择区域",inline:""},model:{value:t.formData.areaId,callback:function(e){t.$set(t.formData,"areaId",e)},expression:"formData.areaId"}},t._l(t.areaList,(function(e,r){return a("Option",{key:r,attrs:{value:e.schoolId}},[t._v(t._s(e.name))])})),1),t._v(" "),a("Input",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{clearable:"",placeholder:"请输入服务中心"},model:{value:t.formData.likeName,callback:function(e){t.$set(t.formData,"likeName",e)},expression:"formData.likeName"}}),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1),t._v(" "),a("Table",{attrs:{border:"",loading:t.tableLoading,columns:t.columns,data:t.tableData,"max-height":t.maxTableHeight}})],1)])],1)}),[],!1,null,"af8a12f2",null);e.default=C.exports},5078:function(t,e,a){"use strict";var r=a("e4ce");a.n(r).a},ce61:function(t,e,a){"use strict";var r=a("90de"),n={props:{openResize:{type:Boolean,default:!1},cusStyle:{type:Object,default:null}},mounted:function(){this.openResize&&(this.getClientHeight(),Object(r.g)(window,"resize",this.getClientHeight))},beforeDestroy:function(){this.openResize&&Object(r.f)(window,"resize",this.getClientHeight)},methods:{getClientHeight:function(){var t=document.body.clientHeight,e=document.body.clientWidth;console.log(t),this.$emit("on-resize",{clientHeight:t,clientWidth:e})}}},s=(a("ee56"),a("2877")),i=Object(s.a)(n,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"scroll-wrap",style:this.cusStyle},[this._t("default")],2)}),[],!1,null,"d57f6b8e",null);e.a=i.exports},e4ce:function(t,e,a){},eb1b:function(t,e,a){},ee56:function(t,e,a){"use strict";var r=a("eb1b");a.n(r).a}}]);
//# sourceMappingURL=grayMgt.580a030e.js.map