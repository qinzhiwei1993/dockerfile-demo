{"version":3,"sources":["webpack:///./src/view/shift/consultshift.vue?7af7","webpack:///./src/view/shift/consultshift.vue?87f5","webpack:///src/view/shift/consultshift.vue","webpack:///./src/view/shift/consultshift.vue?8bcf","webpack:///./src/view/shift/consultshift.vue","webpack:///./src/view/shift/shiftWatch.vue?76ff","webpack:///src/view/shift/shiftWatch.vue","webpack:///./src/view/shift/shiftWatch.vue?fa4a","webpack:///./src/view/shift/shiftWatch.vue","webpack:///./src/view/shift/entrustshift.vue?62aa","webpack:///src/view/shift/entrustshift.vue","webpack:///./src/view/shift/entrustshift.vue?10ad","webpack:///./src/view/shift/entrustshift.vue","webpack:///./src/view/shift/shiftWatch.vue?ac50","webpack:///./src/view/shift/entrustshift.vue?6e15"],"names":["name","data","serviceCenterId","serviceCenterList","weekDay","tableData","intervalList","scheduleList","onlineAdvisers","dataList","loading","numTransWeek","1","2","3","4","5","6","7","todayTime","currentIsEdit","weekDayList","methods","getDataByDate","this","findIndex","cityCode","userInfo","serviceId","date","content","err","message","duration","changeSchedule","crmRoleId","schedule","deleted","push","workStartTime","int","workEndTime","onlineIdentityId","String","adv","identityId","workHour","userWorkCode","$Message","warning","save","$Modal","confirm","title","onOk","details","localDate","isAuthorize","displayOnOff","queryWeekDay","e","computed","$store","state","roleRelativeData","component","_vm","_h","$createElement","_c","_self","staticClass","attrs","staticStyle","on","serviceCenterChange","model","value","callback","$$v","expression","_l","item","key","id","_v","_s","deptName","_e","week","slice","userName","class","$event","directives","rawName","exportUrl","config","timeTfield","btnLoading","tableLoading","formData","searchParams","pickerOptions","disabledDate","mounted","yesterday","areaCode","queryTableData","search","params","upload","util","dealDisabledDate","times","Date","now","time","getTime","$set","length","Object","keys","advisers","agentIdentityId","agentIds","workHours","tableColumns","ruleForm","addModal","ids","openAdd","$refs","form","validate","valid","assignorIdentityId","a","assignorWorkCode","assignorWorkName","agentWorkCode","agentWorkName","agents","render","h","cancel","resetFields","selectionChange","rows","map","deleteAgent","dayName","$haveAuthority","scopedSlots","_u","fn","ref","row","join","index"],"mappings":"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","file":"js/shift.62607270.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./consultshift.vue?vue&type=style&index=0&id=125c3a74&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./consultshift.vue?vue&type=style&index=0&id=125c3a74&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',{staticClass:\"gary\",attrs:{\"id\":\"onlineAdviserSchedule\"}},[(this.serviceCenterList.length)?_c('Form',[_c('FormItem',{attrs:{\"label\":\"服务中心筛选：\"}},[_c('Select',{staticStyle:{\"width\":\"300px\"},attrs:{\"filterable\":\"\"},on:{\"on-change\":_vm.serviceCenterChange},model:{value:(_vm.serviceCenterId),callback:function ($$v) {_vm.serviceCenterId=$$v},expression:\"serviceCenterId\"}},_vm._l((_vm.serviceCenterList),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(_vm._s(item.deptName))])}),1)],1)],1):_vm._e(),_vm._v(\" \"),_c('Radio-group',{attrs:{\"type\":\"button\",\"size\":\"large\"},on:{\"on-change\":_vm.getDataByDate},model:{value:(_vm.weekDay),callback:function ($$v) {_vm.weekDay=$$v},expression:\"weekDay\"}},_vm._l((_vm.weekDayList),function(item){return _c('Radio',{key:item.date,staticClass:\"radio_margin\",attrs:{\"label\":item.date}},[_vm._v(\"\\n      \"+_vm._s(((_vm.numTransWeek[item.week]) + \" (\" + (item.date.slice(5)) + \")\"))+\"\\n    \")])}),1),_vm._v(\" \"),_c('div',{staticClass:\"notice\"},[_c('p',[_vm._v(\"【注意事项】\")]),_vm._v(\" \"),_c('p',[_vm._v(\"\\n      1.编辑完成一天的排班后请务必保存后再继续编辑；连续编辑多天排班后再点击保存时，系统只会保存最后一天的排班；\\n    \")]),_vm._v(\" \"),_c('p',[_vm._v(\"2.点击保存后，排班更改实时生效，请确认编辑无误后再保存；\")]),_vm._v(\" \"),_c('p',[_vm._v(\"3.建议每次编辑后，将排班表整体核实一遍，以免编辑错误影响工作；\")]),_vm._v(\" \"),_c('p',[_vm._v(\"\\n      4.排班列表右上角黄色角标代表该顾问在该时段已委托给他人代维护，详细代班关系查询请移步至“代班管理”页面查看；\\n    \")])]),_vm._v(\" \"),(_vm.loading)?_c('Spin',{attrs:{\"fix\":\"\"}},[_c('Icon',{staticClass:\"demo-spin-icon-load\",attrs:{\"type\":\"ios-loading\",\"size\":\"18\"}})],1):_c('table',{staticStyle:{\"table-layout\":\"fixed\",\"border\":\"1px solid #ddd\",\"border-collapse\":\"collapse\",\"margin-top\":\"10px\"},attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"0\",\"bgcolor\":\"#ffffff\",\"bordercolordark\":\"#ffffff\",\"bordercolorlight\":\"#000000\"}},[_c('thead',[_c('tr',{},[_c('th',{staticStyle:{\"height\":\"50px\"}},[_vm._v(\" \")]),_vm._v(\" \"),_vm._l((_vm.onlineAdvisers),function(adv){return _c('th',{key:adv.identityId,staticStyle:{\"font-size\":\"16px\",\"font-weight\":\"bold\",\"color\":\"#444\",\"width\":\"20px\",\"font-family\":\"'Microsoft YaHei'\",\"word-break\":\"break-all\"}},[_vm._v(\"\\n          \"+_vm._s(adv.userName)+\"\\n        \")])})],2)]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.intervalList),function(int){return _c('tr',{key:int.workHour},[_c('td',{staticStyle:{\"text-align\":\"center\",\"width\":\"100px\",\"font-size\":\"16px\",\"font-weight\":\"bold\",\"color\":\"#333\",\"min-width\":\"100px\",\"white-space\":\"nowrap\"}},[_vm._v(\"\\n          \"+_vm._s(int.workStartTime + '-' + int.workEndTime)+\"\\n        \")]),_vm._v(\" \"),_vm._l((_vm.onlineAdvisers),function(adv){return _c('td',{key:adv.identityId,class:_vm.displayOnOff(int, adv) ? 'schedule-on' : 'schedule-off',on:{\"click\":function($event){return _vm.changeSchedule(int, adv)}}},[(_vm.isAuthorize(int, adv))?_c('div',{staticClass:\"icon\"},[_vm._v(\"代\")]):_vm._e()])})],2)}),0)]),_vm._v(\" \"),_c('div',{staticStyle:{\"margin-top\":\"10px\",\"text-align\":\"right\"}},[_c('Button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.currentIsEdit && _vm.userInfo.crmRoleId !== 2),expression:\"currentIsEdit && userInfo.crmRoleId !== 2\"}],attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保存\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Layout id=\"onlineAdviserSchedule\" class=\"gary\">\n    <Form v-if=\"this.serviceCenterList.length\">\n      <FormItem label=\"服务中心筛选：\">\n        <Select v-model=\"serviceCenterId\" style=\"width: 300px\" @on-change=\"serviceCenterChange\" filterable>\n          <Option v-for=\"item in serviceCenterList\" :key=\"item.id\" :value=\"item.id\">{{ item.deptName }}</Option>\n        </Select>\n      </FormItem>\n    </Form>\n    <Radio-group\n      v-model=\"weekDay\"\n      type=\"button\"\n      size=\"large\"\n      @on-change=\"getDataByDate\"\n    >\n      <Radio\n        class=\"radio_margin\"\n        v-for=\"item in weekDayList\"\n        :key=\"item.date\"\n        :label=\"item.date\"\n      >\n        {{ `${numTransWeek[item.week]} (${item.date.slice(5)})` }}\n      </Radio>\n    </Radio-group>\n    <div class=\"notice\">\n      <p>【注意事项】</p>\n      <p>\n        1.编辑完成一天的排班后请务必保存后再继续编辑；连续编辑多天排班后再点击保存时，系统只会保存最后一天的排班；\n      </p>\n      <p>2.点击保存后，排班更改实时生效，请确认编辑无误后再保存；</p>\n      <p>3.建议每次编辑后，将排班表整体核实一遍，以免编辑错误影响工作；</p>\n      <p>\n        4.排班列表右上角黄色角标代表该顾问在该时段已委托给他人代维护，详细代班关系查询请移步至“代班管理”页面查看；\n      </p>\n    </div>\n    <Spin fix v-if=\"loading\">\n      <Icon type=\"ios-loading\" size=\"18\" class=\"demo-spin-icon-load\"></Icon>\n    </Spin>\n    <table\n      v-else\n      border=\"1\"\n      cellspacing=\"0\"\n      cellpadding=\"0\"\n      bgcolor=\"#ffffff\"\n      bordercolordark=\"#ffffff\"\n      bordercolorlight=\"#000000\"\n      style=\"\n        table-layout: fixed;\n        border: 1px solid #ddd;\n        border-collapse: collapse;\n        margin-top: 10px;\n      \"\n    >\n      <thead>\n        <tr style=\"\">\n          <th style=\"height: 50px\">&nbsp;</th>\n          <th\n            v-for=\"adv in onlineAdvisers\"\n            :key=\"adv.identityId\"\n            style=\"\n              font-size: 16px;\n              font-weight: bold;\n              color: #444;\n              width: 20px;\n              font-family: 'Microsoft YaHei';\n              word-break: break-all;\n            \"\n          >\n            {{ adv.userName }}\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"int in intervalList\" :key=\"int.workHour\">\n          <td\n            style=\"\n              text-align: center;\n              width: 100px;\n              font-size: 16px;\n              font-weight: bold;\n              color: #333;\n              min-width: 100px;\n              white-space: nowrap;\n            \"\n          >\n            {{ int.workStartTime + '-' + int.workEndTime }}\n          </td>\n          <td\n            v-for=\"adv in onlineAdvisers\"\n            :key=\"adv.identityId\"\n            @click=\"changeSchedule(int, adv)\"\n            :class=\"displayOnOff(int, adv) ? 'schedule-on' : 'schedule-off'\"\n          >\n            <div v-if=\"isAuthorize(int, adv)\" class=\"icon\">代</div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <div style=\"margin-top: 10px; text-align: right\">\n      <Button v-show=\"currentIsEdit && userInfo.crmRoleId !== 2\" type=\"primary\" @click=\"save\">保存</Button>\n    </div>\n  </Layout>\n</template>\n\n<script>\nimport {\n  getOnlineShiftByDate,\n  insertOnlineAdvisorShift,\n  getOnlineConsults,\n  getSchoolConfiguration,\n  getWeekDay\n} from '@/api/advisor'\nimport { getDeptByAreaCode } from '@/api/crm'\nimport { dateFormat } from '@/utils/utils'\nexport default {\n  name: 'consultshift',\n  data () {\n    return {\n      serviceCenterId: '',\n      serviceCenterList: '',\n      weekDay: '',\n      tableData: [],\n      intervalList: [],\n      scheduleList: [],\n      onlineAdvisers: [],\n      dataList: {},\n      loading: false,\n      numTransWeek: {\n        1: '周一',\n        2: '周二',\n        3: '周三',\n        4: '周四',\n        5: '周五',\n        6: '周六',\n        7: '周日'\n      },\n      todayTime: '',\n      currentIsEdit: false,\n      weekDayList: []\n    }\n  },\n  methods: {\n    async serviceCenterChange () {\n      try {\n        this.onlineAdvisers = await getOnlineConsults({\n          cityCode: this.userInfo.cityCode,\n          serviceId: this.serviceCenterId\n        })\n        this.getDataByDate()\n      } catch (e) {\n        this.$Message.error({\n          content: '初始化失败：' + e.message || e,\n          duration: 5\n        })\n      }\n    },\n    /**\n     * 按日期查询排班数据\n     */\n    getDataByDate () {\n      this.currentIsEdit = this.weekDayList.findIndex(item => item.date === this.weekDay) !== -1 ? this.weekDayList[this.weekDayList.findIndex(item => item.date === this.weekDay)].editable : false\n      this.loading = true\n      getOnlineShiftByDate({\n        cityCode: this.userInfo.cityCode,\n        serviceId: this.serviceCenterId,\n        date: this.weekDay\n      }).then(data => {\n        this.scheduleList = data\n      }).catch(err => {\n        this.$Message.error({\n          content: '查询排班信息错误：' + err.message,\n          duration: 5\n        })\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    /**\n     * 改变排班\n     * @param int 排班时间\n     * @param adv 排班人\n     */\n    changeSchedule (int, adv) {\n      if (this.userInfo.crmRoleId === 2) {\n        this.$Message.warning({\n          content: '城市经理不能设置排班',\n          duration: 5\n        })\n        return\n      }\n      const schedule = this.scheduleList.find(s => s.workHour === int.workHour && s.onlineIdentityId === String(adv.identityId))\n      if (schedule) {\n        schedule.deleted = schedule.deleted === 0 ? 1 : 0\n      } else {\n        this.scheduleList.push({\n          workStartTime: int.workStartTime,\n          workEndTime: int.workEndTime,\n          deleted: 0,\n          onlineIdentityId: String(adv.identityId),\n          workHour: int.workHour,\n          userWorkCode: adv.userWorkCode\n        })\n      }\n    },\n    save () {\n      this.$Modal.confirm({\n        title: '保存排班',\n        content: '<p>1.编辑完成一天的排班后请务必保存后再继续编辑；连续编辑多天排班后再点击保存时，系统只会保存最后一天的排班；</p><p>2.排班更改将在点击\"确定\"后实时生效，是否仍要更改？</p>',\n        // loading: true,\n        onOk: () => {\n          insertOnlineAdvisorShift({\n            details: this.scheduleList,\n            localDate: this.weekDay\n          }).then(data => {\n            this.$Message.success({\n              content: '保存成功',\n              duration: 5\n            })\n            this.$Modal.remove()\n            this.getDataByDate()\n          }).catch(err => {\n            this.$Message.error({\n              content: '保存失败：' + err.message,\n              duration: 5\n            })\n          })\n        }\n      })\n    },\n    /**\n     * 是否代班\n     */\n    isAuthorize (int, adv) {\n      const schedule = this.scheduleList.find(s => s.workHour === int.workHour && s.onlineIdentityId === String(adv.identityId) && s.isAuthorize)\n      if (schedule) {\n        return schedule.deleted === 0\n      } else {\n        return false\n      }\n    },\n    displayOnOff (int, adv) {\n      const schedule = this.scheduleList.find(s => s.workHour === int.workHour && s.onlineIdentityId === String(adv.identityId))\n      if (schedule) {\n        return schedule.deleted === 0\n      } else {\n        return false\n      }\n    },\n    /**\n     * 查询星期列表\n     */\n    queryWeekDay () {\n      getWeekDay().then(data => {\n        this.weekDayList = data\n      }).catch(e => {\n        this.$Message.error({\n          content: '初始化失败：' + e.message || e,\n          duration: 5\n        })\n      })\n    }\n  },\n  computed: {\n    userInfo () {\n      return this.$store.state.roleRelativeData.userInfo\n    }\n  },\n  async mounted () {\n    try {\n      this.loading = true\n      this.todayTime = dateFormat(new Date(Date.now()), 'yyyy-MM-dd')\n      this.weekDay = this.todayTime\n      this.queryWeekDay()\n      if (this.userInfo.crmRoleId === 2) { // 如果是城市经理，查询管理的服务中心\n        this.serviceCenterList = await getDeptByAreaCode({\n          areaCode: this.userInfo.cityCode,\n          isActive: 1\n        })\n        this.serviceCenterId = this.serviceCenterList[0].id\n      } else {\n        this.serviceCenterId = this.userInfo.crmDeptId\n      }\n      this.onlineAdvisers = await getOnlineConsults({\n        cityCode: this.userInfo.cityCode,\n        serviceId: this.serviceCenterId\n      })\n      const schoolConfig = await getSchoolConfiguration()\n      for (let i = schoolConfig.startHour; i <= schoolConfig.endHour; i++) {\n        this.intervalList.push({\n          workHour: i,\n          workStartTime: `${i}:00`,\n          workEndTime: `${i + 1}:00`\n        })\n      }\n      this.getDataByDate()\n    } catch (e) {\n      this.$Message.error({\n        content: '初始化失败：' + e.message || e,\n        duration: 5\n      })\n    } finally {\n      this.loading = false\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n#onlineAdviserSchedule {\n  /*width: 100%;*/\n  overflow-x: auto;\n  padding: 10px;\n  position: relative;\n}\n\n.notice {\n  margin-top: 10px;\n}\n\n.schedule-off {\n  padding-top: 5px;\n  height: 40px;\n  background-color: #e9f3ff;\n  cursor: pointer;\n  position: relative;\n  :hover {\n    background-color: #92a6bb;\n  }\n}\n\n.schedule-on {\n  padding-top: 5px;\n  height: 40px;\n  background-color: #81bdff;\n  cursor: pointer;\n  position: relative;\n  z-index: 20;\n  animation: scale 0.2s;\n  :hover {\n    background-color: #92a6bb;\n  }\n}\n@keyframes scale {\n  30% {\n    transform: scale(1);\n  }\n  70% {\n    transform: scale(1.5);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n@-webkit-keyframes scale /*Safari and Chrome*/ {\n  30% {\n    transform: scale(1);\n  }\n  70% {\n    transform: scale(1.5);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n\n.icon {\n  width: 16px;\n  height: 20px;\n  padding: 2px;\n  font-size: 12px;\n  position: absolute;\n  top: 0;\n  right: 0;\n  border-bottom-left-radius: 5px;\n  background: #ffca43;\n}\n\n.demo-spin-icon-load {\n  animation: ani-demo-spin 1s linear infinite;\n}\n\n@keyframes ani-demo-spin {\n  from {\n    transform: rotate(0deg);\n  }\n\n  50% {\n    transform: rotate(180deg);\n  }\n\n  to {\n    transform: rotate(360deg);\n  }\n}\n.radio_margin {\n  margin: 0 5px 5px 0;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./consultshift.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./consultshift.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./consultshift.vue?vue&type=template&id=125c3a74&scoped=true&\"\nimport script from \"./consultshift.vue?vue&type=script&lang=js&\"\nexport * from \"./consultshift.vue?vue&type=script&lang=js&\"\nimport style0 from \"./consultshift.vue?vue&type=style&index=0&id=125c3a74&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"125c3a74\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content-data\"},[_c('el-card',{staticClass:\"search-box\"},[_c('el-form',{attrs:{\"model\":_vm.formData,\"label-width\":\"80px\",\"inline\":true}},[_c('el-form-item',{attrs:{\"prop\":\"date\",\"label\":\"日期\"}},[_c('el-date-picker',{attrs:{\"type\":\"date\",\"value-format\":\"yyyy-MM-dd\",\"size\":\"small\",\"placeholder\":\"选择日期\",\"picker-options\":_vm.pickerOptions},model:{value:(_vm.formData.date),callback:function ($$v) {_vm.$set(_vm.formData, \"date\", $$v)},expression:\"formData.date\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"loading\":_vm.btnLoading,\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.search}},[_vm._v(\"查询\")])],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"size\":\"small\",\"disabled\":_vm.tableData.length === 0},on:{\"click\":_vm.upload}},[_vm._v(\"导出\")])],1)],1)],1),_vm._v(\" \"),_c('el-card',[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.tableLoading),expression:\"tableLoading\"}],attrs:{\"data\":_vm.tableData}},[_c('el-table-column',{attrs:{\"fixed\":true,\"prop\":\"schoolName\",\"label\":\"分校\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"fixed\":true,\"prop\":\"serviceDeptName\",\"width\":\"180\",\"label\":\"服务中心\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"fixed\":true,\"prop\":\"notLoginTimeSum\",\"width\":\"130\",\"label\":\"累计未排班时长(单位：分钟)\"}}),_vm._v(\" \"),_vm._l((Object.keys(_vm.timeTfield)),function(item){return _c('el-table-column',{key:item,attrs:{\"prop\":_vm.timeTfield[item],\"align\":\"center\",\"label\":item,\"width\":\"105\"}})})],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","x<!--\n * @Descripttion: 服务中心排班监控\n * @version:\n * @Author: lijing\n * @Date: 2021-05-24 11:30:52\n * @LastEditors: lijing\n * @LastEditTime: 2021-05-31 10:57:36\n-->\n<template>\n  <div class=\"content-data\">\n    <el-card class=\"search-box\">\n      <el-form\n        :model=\"formData\"\n        label-width=\"80px\"\n        :inline=\"true\"\n      >\n        <el-form-item\n          prop=\"date\"\n          label=\"日期\"\n        >\n          <el-date-picker\n            v-model=\"formData.date\"\n            type=\"date\"\n            value-format=\"yyyy-MM-dd\"\n            size=\"small\"\n            placeholder=\"选择日期\"\n            :picker-options=\"pickerOptions\"\n          >\n          </el-date-picker>\n        </el-form-item>\n        <el-form-item>\n          <el-button\n            :loading=\"btnLoading\"\n            size=\"small\"\n            type=\"primary\"\n            @click=\"search\"\n          >查询</el-button>\n        </el-form-item>\n        <el-form-item>\n          <el-button\n            size=\"small\"\n            @click=\"upload\"\n            :disabled=\"tableData.length === 0\"\n          >导出</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n    <el-card>\n      <el-table\n        v-loading=\"tableLoading\"\n        :data=\"tableData\"\n      >\n        <el-table-column\n          :fixed=\"true\"\n          prop=\"schoolName\"\n          label=\"分校\"\n        >\n        </el-table-column>\n        <el-table-column\n          :fixed=\"true\"\n          prop=\"serviceDeptName\"\n          width=\"180\"\n          label=\"服务中心\"\n        >\n        </el-table-column>\n        <el-table-column\n          :fixed=\"true\"\n          prop=\"notLoginTimeSum\"\n          width=\"130\"\n          label=\"累计未排班时长(单位：分钟)\"\n        >\n        </el-table-column>\n        <el-table-column\n          v-for=\"item in Object.keys(timeTfield)\"\n          :prop=\"timeTfield[item]\"\n          align=\"center\"\n          :label=\"item\"\n          width=\"105\"\n          :key=\"item\"\n        >\n        </el-table-column>\n      </el-table>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { serviceNotShift } from '../../api/advisor'\nimport { mapState } from 'vuex'\nimport { dateFormat } from '@/utils/utils'\nimport util from '@/common/util.js'\nimport config from '../../config'\nimport { runEnv } from '../../libs/util'\nconst env = runEnv()\nconst urls = {\n  exportUrl: config.baseUrl[env] + '/SPLAT/crmPanelList/serviceNotShiftDownload'\n}\nexport default {\n  name: 'shiftWatch',\n  data () {\n    return {\n      timeTfield: {\n        '9:00-10:00': 'nine',\n        '10:00-11:00': 'ten',\n        '11:00-12:00': 'eleven',\n        '12:00-13:00': 'twelve',\n        '13:00-14:00': 'thirteen',\n        '14:00-15:00': 'fourteen',\n        '15:00-16:00': 'fifteen',\n        '16:00-17:00': 'sixteen',\n        '17:00-18:00': 'seventeen',\n        '18:00-19:00': 'eighteen',\n        '19:00-20:00': 'nineteen',\n        '20:00-21:00': 'twenty'\n      },\n      tableData: [],\n      btnLoading: false,\n      tableLoading: false,\n      loading: false,\n      formData: {\n        date: ''\n      },\n      searchParams: {},\n      pickerOptions: {\n        disabledDate: (time) => {\n          return this.dealDisabledDate(time)\n        }\n      }\n    }\n  },\n  computed: {\n    ...mapState('roleRelativeData', ['userInfo'])\n  },\n  mounted () {\n    let yesterday = dateFormat(new Date(Date.now() - 24 * 60 * 60 * 1000), 'yyyy-MM-dd')\n    this.formData.date = yesterday\n    this.searchParams = {\n      date: this.formData.date,\n      areaCode: this.userInfo.cityCode\n    }\n    this.queryTableData(this.searchParams)\n  },\n  methods: {\n    async queryTableData (params) {\n      this.tableData = []\n      this.btnLoading = true\n      this.tableLoading = true\n      try {\n        this.tableData = await serviceNotShift(params)\n        this.btnLoading = false\n        this.tableLoading = false\n      } catch (err) {\n        this.$message.error(err.message)\n        this.btnLoading = false\n        this.tableLoading = false\n      }\n    },\n    search () {\n      this.btnLoading = true\n      let params = {\n        ...this.searchParams,\n        ...this.formData\n      }\n      this.queryTableData(params)\n    },\n    upload () {\n      let params = {\n        ...this.searchParams,\n        ...this.formData\n      }\n      util.download(urls.exportUrl, params, 'get')\n    },\n    dealDisabledDate (time) {\n      var times = Date.now() - 8.64e7\n      return time.getTime() >= times\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n.content-data {\n  width: 100%;\n  .search-box {\n    margin-bottom: 15px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shiftWatch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shiftWatch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./shiftWatch.vue?vue&type=template&id=8cef0d3c&scoped=true&\"\nimport script from \"./shiftWatch.vue?vue&type=script&lang=js&\"\nexport * from \"./shiftWatch.vue?vue&type=script&lang=js&\"\nimport style0 from \"./shiftWatch.vue?vue&type=style&index=0&id=8cef0d3c&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8cef0d3c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',{staticClass:\"gary\",attrs:{\"id\":\"entrust-wrapper\"}},[_c('div',{staticClass:\"header\"},[_c('RadioGroup',{attrs:{\"type\":\"button\",\"size\":\"large\"},on:{\"on-change\":_vm.getDataByDate},model:{value:(_vm.weekDay),callback:function ($$v) {_vm.weekDay=$$v},expression:\"weekDay\"}},[_c('Radio',{attrs:{\"label\":\"1\"}},[_vm._v(\"周一\")]),_vm._v(\" \"),_c('Radio',{attrs:{\"label\":\"2\"}},[_vm._v(\"周二\")]),_vm._v(\" \"),_c('Radio',{attrs:{\"label\":\"3\"}},[_vm._v(\"周三\")]),_vm._v(\" \"),_c('Radio',{attrs:{\"label\":\"4\"}},[_vm._v(\"周四\")]),_vm._v(\" \"),_c('Radio',{attrs:{\"label\":\"5\"}},[_vm._v(\"周五\")]),_vm._v(\" \"),_c('Radio',{attrs:{\"label\":\"6\"}},[_vm._v(\"周六\")]),_vm._v(\" \"),_c('Radio',{attrs:{\"label\":\"7\"}},[_vm._v(\"周日\")])],1),_vm._v(\" \"),(_vm.$haveAuthority('roleRelativeData', '/shift/entrustshift/edit'))?_c('div',[_c('Button',{staticClass:\"add-btn\",attrs:{\"type\":\"primary\",\"icon\":\"md-add\"},on:{\"click\":_vm.openAdd}},[_vm._v(\"新增代班设置\")]),_vm._v(\" \"),_c('Button',{attrs:{\"icon\":\"md-trash\",\"disabled\":!_vm.ids.length},on:{\"click\":_vm.deleteAgent}},[_vm._v(\"删除代班设置\")])],1):_vm._e()],1),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"table-wrapper\"},[(_vm.loading)?_c('Spin',{attrs:{\"fix\":\"\"}},[_c('Icon',{staticClass:\"demo-spin-icon-load\",attrs:{\"type\":\"ios-loading\",\"size\":\"18\"}})],1):_vm._e(),_vm._v(\" \"),_c('Table',{attrs:{\"border\":\"\",\"columns\":_vm.tableColumns,\"data\":_vm.tableData},on:{\"on-selection-change\":_vm.selectionChange},scopedSlots:_vm._u([{key:\"workHour\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(\"\\n          \"+_vm._s(row.workHour + ':00-' + (row.workHour + 1) + ':00')+\"\\n        \")]}},{key:\"agents\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(\"\\n          \"+_vm._s(row.agents.map(function (a) { return a.assignorWorkName; }).join(','))+\"\\n        \")]}}])})],1),_vm._v(\" \"),_c('div',{staticClass:\"notice\"},[_c('p',{staticClass:\"title\"},[_vm._v(\"【代班功能说明】\")]),_vm._v(\" \"),_c('p',[_vm._v(\" 1.代班功能主要解决顾问伙伴在其他伙伴休假倒班时需用盘古登录服务中心他人账号进行IM维护的问题；通过代班机制可以实现在代班期间代班顾问仅需登录自己的账号即可同时维护原顾问的IM中用户发来的全部文字及语音消息。\")]),_vm._v(\" \"),_c('p',[_vm._v(\" 2.代班期间所产生的全部文字，语音的消息响应时长均不计入代办顾问与原顾问的响应时长中。\")]),_vm._v(\" \"),_c('p',[_vm._v(\" 3.在代班期间内，原顾问的盘古端将接收不到用户发来的消息，均转移至代办顾问账号下；但手机端云客CRM则不受影响。\")]),_vm._v(\" \"),_c('p',[_vm._v(\" 4.在代班期间内，代班顾问和家长没有建立沟通的情况下，原顾问仍可通过自己的盘古系统发送消息给用户。\")]),_vm._v(\" \"),_c('p',{staticClass:\"title\"},[_vm._v(\"【代班设置规则】\")]),_vm._v(\" \"),_c('p',[_vm._v(\" 1.代班功能的代班顾问与原顾问均为同服务中心顾问角色。\")]),_vm._v(\" \"),_c('p',[_vm._v(\" 2.一个顾问在同一时段内不能既为代班顾问又为原顾问。\")]),_vm._v(\" \"),_c('p',[_vm._v(\" 3.一个顾问作为原顾问在同一时段内不能委托给两个顾问代班。\")])])]),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"新增代班设置\",\"footer-hide\":\"\",\"closable\":false,\"mask-closable\":false},on:{\"cancel\":_vm.cancel},model:{value:(_vm.addModal),callback:function ($$v) {_vm.addModal=$$v},expression:\"addModal\"}},[_c('Form',{ref:\"form\",attrs:{\"label-width\":80,\"rules\":_vm.ruleForm,\"model\":_vm.formData}},[_c('FormItem',{attrs:{\"label\":\"代班日期\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.dayName)+\"\\n      \")]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"代班顾问\",\"prop\":\"agentIdentityId\"}},[_c('Select',{attrs:{\"clearable\":\"\",\"filterable\":\"\"},on:{\"on-clear\":function($event){_vm.formData.agentIds = []}},model:{value:(_vm.formData.agentIdentityId),callback:function ($$v) {_vm.$set(_vm.formData, \"agentIdentityId\", $$v)},expression:\"formData.agentIdentityId\"}},_vm._l((_vm.advisers),function(item,index){return _c('Option',{key:index,attrs:{\"value\":item.identityId}},[_vm._v(_vm._s(item.userName))])}),1)],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"原顾问\",\"prop\":\"agentIds\"}},[_c('Select',{attrs:{\"multiple\":\"\",\"clearable\":\"\",\"filterable\":\"\",\"disabled\":!_vm.formData.agentIdentityId},model:{value:(_vm.formData.agentIds),callback:function ($$v) {_vm.$set(_vm.formData, \"agentIds\", $$v)},expression:\"formData.agentIds\"}},_vm._l((_vm.advisers),function(item,index){return _c('Option',{key:index,attrs:{\"disabled\":_vm.formData.agentIdentityId === item.identityId,\"value\":item.identityId}},[_vm._v(_vm._s(item.userName))])}),1)],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"代班时段\",\"prop\":\"workHours\"}},[_c('Select',{attrs:{\"multiple\":\"\",\"clearable\":\"\",\"disabled\":!_vm.formData.agentIdentityId || !_vm.formData.agentIds.length},model:{value:(_vm.formData.workHours),callback:function ($$v) {_vm.$set(_vm.formData, \"workHours\", $$v)},expression:\"formData.workHours\"}},_vm._l((_vm.intervalList),function(item,index){return _c('Option',{key:index,attrs:{\"value\":item.workHour}},[_vm._v(_vm._s(item.workStartTime + '-' + item.workEndTime))])}),1)],1)],1),_vm._v(\" \"),_c('div',{staticStyle:{\"text-align\":\"right\"}},[_c('Button',{on:{\"click\":_vm.cancel}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"确定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Layout id=\"entrust-wrapper\" class=\"gary\">\n    <div class=\"header\">\n      <RadioGroup v-model=\"weekDay\" type=\"button\" size=\"large\" @on-change=\"getDataByDate\">\n        <Radio label=\"1\">周一</Radio>\n        <Radio label=\"2\">周二</Radio>\n        <Radio label=\"3\">周三</Radio>\n        <Radio label=\"4\">周四</Radio>\n        <Radio label=\"5\">周五</Radio>\n        <Radio label=\"6\">周六</Radio>\n        <Radio label=\"7\">周日</Radio>\n      </RadioGroup>\n      <div v-if=\"$haveAuthority('roleRelativeData', '/shift/entrustshift/edit')\">\n        <Button class=\"add-btn\" type=\"primary\" icon=\"md-add\" @click=\"openAdd\">新增代班设置</Button>\n        <Button icon=\"md-trash\" :disabled=\"!ids.length\" @click=\"deleteAgent\">删除代班设置</Button>\n      </div>\n    </div>\n    <div class=\"content\">\n      <div class=\"table-wrapper\">\n        <Spin fix v-if=\"loading\">\n          <Icon type=\"ios-loading\" size=18 class=\"demo-spin-icon-load\"></Icon>\n        </Spin>\n        <Table border :columns=\"tableColumns\" :data=\"tableData\" @on-selection-change=\"selectionChange\">\n          <template slot-scope=\"{ row }\" slot=\"workHour\">\n            {{ row.workHour + ':00-' + (row.workHour + 1) + ':00'}}\n          </template>\n          <template slot-scope=\"{ row }\" slot=\"agents\">\n            {{ row.agents.map(a => a.assignorWorkName).join(',') }}\n          </template>\n        </Table>\n      </div>\n      <div class=\"notice\">\n        <p class=\"title\">【代班功能说明】</p>\n        <p> 1.代班功能主要解决顾问伙伴在其他伙伴休假倒班时需用盘古登录服务中心他人账号进行IM维护的问题；通过代班机制可以实现在代班期间代班顾问仅需登录自己的账号即可同时维护原顾问的IM中用户发来的全部文字及语音消息。</p>\n        <p> 2.代班期间所产生的全部文字，语音的消息响应时长均不计入代办顾问与原顾问的响应时长中。</p>\n        <p> 3.在代班期间内，原顾问的盘古端将接收不到用户发来的消息，均转移至代办顾问账号下；但手机端云客CRM则不受影响。</p>\n        <p> 4.在代班期间内，代班顾问和家长没有建立沟通的情况下，原顾问仍可通过自己的盘古系统发送消息给用户。</p>\n        <p class=\"title\">【代班设置规则】</p>\n        <p> 1.代班功能的代班顾问与原顾问均为同服务中心顾问角色。</p>\n        <p> 2.一个顾问在同一时段内不能既为代班顾问又为原顾问。</p>\n        <p> 3.一个顾问作为原顾问在同一时段内不能委托给两个顾问代班。</p>\n      </div>\n    </div>\n    <Modal v-model=\"addModal\" title=\"新增代班设置\" @cancel=\"cancel\" footer-hide :closable=\"false\" :mask-closable=\"false\">\n      <Form ref=\"form\" :label-width=\"80\" :rules=\"ruleForm\" :model=\"formData\">\n        <FormItem label=\"代班日期\">\n          {{ dayName }}\n        </FormItem>\n        <FormItem label=\"代班顾问\" prop=\"agentIdentityId\">\n          <Select v-model=\"formData.agentIdentityId\" clearable filterable @on-clear=\"formData.agentIds = []\">\n            <Option v-for=\"(item,index) in advisers\" :value=\"item.identityId\" :key=\"index\">{{ item.userName }}</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"原顾问\" prop=\"agentIds\">\n          <Select v-model=\"formData.agentIds\" multiple clearable filterable :disabled=\"!formData.agentIdentityId\">\n            <Option v-for=\"(item,index) in advisers\" :disabled=\"formData.agentIdentityId === item.identityId\" :value=\"item.identityId\" :key=\"index\">{{ item.userName }}</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"代班时段\" prop=\"workHours\">\n          <Select v-model=\"formData.workHours\" multiple clearable :disabled=\"!formData.agentIdentityId || !formData.agentIds.length\">\n            <Option v-for=\"(item,index) in intervalList\" :value=\"item.workHour\" :key=\"index\">{{ item.workStartTime + '-' + item.workEndTime }}</Option>\n          </Select>\n        </FormItem>\n      </Form>\n      <div style=\"text-align: right\">\n        <Button @click=\"cancel\">取消</Button>\n        <Button @click=\"save\" type=\"primary\">确定</Button>\n      </div>\n    </Modal>\n  </Layout>\n</template>\n\n<script>\nimport {\n  getAdvisorAuthorizeByDate,\n  getSchoolConfiguration,\n  getOnlineConsults,\n  insertAdvisorAuthorize,\n  deleteAdvisorAuthorize\n} from '@/api/advisor'\nexport default {\n  name: 'entrustshift',\n  data () {\n    return {\n      weekDay: '1',\n      tableData: [],\n      intervalList: [],\n      scheduleList: [],\n      advisers: [],\n      formData: {\n        agentIdentityId: '', // 代班顾问身份id\n        agentIds: [], // 原顾问身份id\n        workHours: [] // 代班时段\n      },\n      loading: false,\n      tableColumns: [\n        {\n          type: 'selection',\n          width: 50,\n          align: 'center'\n        },\n        {\n          title: '委托时段',\n          slot: 'workHour',\n          width: 150,\n          align: 'center'\n        },\n        {\n          title: '代班顾问',\n          key: 'agentWorkName',\n          align: 'center'\n        },\n        {\n          title: '原顾问',\n          slot: 'agents',\n          align: 'center'\n        }\n      ],\n      ruleForm: {\n        agentIdentityId: [{ required: true, message: '代班顾问不能为空', trigger: 'change', type: 'number' }],\n        agentIds: [{ required: true, message: '原顾问不能为空', trigger: 'change', type: 'array' }],\n        workHours: [{ required: true, message: '代班时段不能为空', trigger: 'change', type: 'array' }]\n      },\n      addModal: false,\n      ids: []\n    }\n  },\n  methods: {\n    getDataByDate (weekDay) {\n      this.ids = []\n      this.loading = true\n      getAdvisorAuthorizeByDate({\n        cityCode: '010',\n        weekDay\n      }).then(data => {\n        this.tableData = data\n      }).catch(err => {\n        this.$Message.error({\n          content: '查询顾问委托列表错误：' + err.message,\n          duration: 5\n        })\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    openAdd () {\n      this.addModal = true\n    },\n    save () {\n      this.$refs.form.validate(valid => {\n        if (valid) {\n          // 组装原顾问信息\n          const agents = this.advisers.filter(a => this.formData.agentIds.includes(a.identityId)).map(a => {\n            return {\n              assignorIdentityId: String(a.identityId),\n              assignorWorkCode: a.userWorkCode,\n              assignorWorkName: a.userName\n            }\n          })\n          const adv = this.advisers.find(a => a.identityId === this.formData.agentIdentityId)\n          const params = Object.assign({}, this.formData, {\n            agentIdentityId: String(adv.identityId),\n            agentWorkCode: adv.userWorkCode,\n            agentWorkName: adv.userName,\n            agents,\n            weekDay: this.weekDay\n          })\n          insertAdvisorAuthorize(params).then(data => {\n            this.$Message.success({\n              content: '保存成功',\n              duration: 5\n            })\n            this.cancel()\n            this.getDataByDate(this.weekDay)\n          }).catch(err => {\n            this.$Modal.error({\n              title: '保存失败',\n              render: (h) => {\n                return h('div', [\n                  h('p', '请修改后重试！'),\n                  h('p', '1.代班顾问在选中的时段中不得同时存在“原顾问”身份；'),\n                  h('p', '2.原顾问在选中的时段内不得同时被两个人代班；')\n                ])\n              },\n              content: '保存失败：' + err.message\n            })\n          })\n        } else {\n          this.$Message.warning({\n            content: '请完善必填信息',\n            duration: 5\n          })\n        }\n      })\n    },\n    cancel () {\n      this.addModal = false\n      this.formData = {\n        agentIdentityId: '', // 代班顾问身份id\n        agentIds: [], // 原顾问身份id\n        workHours: [] // 代班时段\n      }\n      this.$refs.form.resetFields()\n    },\n    selectionChange (rows) {\n      this.ids = rows.map(r => r.ids)\n    },\n    deleteAgent () {\n      this.$Modal.confirm({\n        title: '删除确认',\n        content: `选中的代班设置执行“删除”操作在点击“确认”后将实时生效，是否仍要更改？`,\n        onOk: () => {\n          deleteAdvisorAuthorize(this.ids).then(() => {\n            this.$Message.success('删除成功！')\n            this.getDataByDate(this.weekDay)\n          }).catch(err => {\n            this.$Message.error('删除失败：' + err.message)\n          })\n        }\n      })\n    }\n  },\n  computed: {\n    dayName () {\n      switch (this.weekDay) {\n        case '1':\n          return '周一'\n        case '2':\n          return '周二'\n        case '3':\n          return '周三'\n        case '4':\n          return '周四'\n        case '5':\n          return '周五'\n        case '6':\n          return '周六'\n        case '7':\n          return '周日'\n        default:\n          return ''\n      }\n    }\n  },\n  async mounted () {\n    try {\n      this.loading = true\n      this.advisers = await getOnlineConsults()\n      const schoolConfig = await getSchoolConfiguration({\n        // cityCode: '010'\n      })\n      for (let i = schoolConfig.startHour; i <= schoolConfig.endHour; i++) {\n        this.intervalList.push({\n          workHour: i,\n          workStartTime: `${i}:00`,\n          workEndTime: `${i + 1}:00`\n        })\n      }\n      this.getDataByDate(1)\n    } catch (e) {\n      this.$Message.error({\n        content: '初始化失败：' + e.message || e,\n        duration: 5\n      })\n      this.loading = false\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n  #entrust-wrapper {\n    /*width: 100%;*/\n    overflow-x: auto;\n    padding: 10px;\n    position: relative;\n    .header {\n      display: flex;\n      margin-bottom: 10px;\n      .add-btn {\n        margin-left: 20px;\n        margin-right: 10px;\n      }\n    }\n    .content {\n      display: flex;\n      .table-wrapper {\n        width: 70%;\n        margin-right: 20px;\n        .demo-spin-icon-load{\n          animation: ani-demo-spin 1s linear infinite;\n        }\n        @keyframes ani-demo-spin {\n          from { transform: rotate(0deg);}\n          50%  { transform: rotate(180deg);}\n          to   { transform: rotate(360deg);}\n        }\n      }\n      .notice {\n        margin-top: 10px;\n        p {\n          line-height: 20px;\n          margin-bottom: 10px;\n        }\n        .title {\n          font-weight: bold;\n        }\n      }\n    }\n  }\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./entrustshift.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./entrustshift.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./entrustshift.vue?vue&type=template&id=1e37f11a&scoped=true&\"\nimport script from \"./entrustshift.vue?vue&type=script&lang=js&\"\nexport * from \"./entrustshift.vue?vue&type=script&lang=js&\"\nimport style0 from \"./entrustshift.vue?vue&type=style&index=0&id=1e37f11a&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1e37f11a\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shiftWatch.vue?vue&type=style&index=0&id=8cef0d3c&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shiftWatch.vue?vue&type=style&index=0&id=8cef0d3c&scoped=true&lang=less&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./entrustshift.vue?vue&type=style&index=0&id=1e37f11a&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./entrustshift.vue?vue&type=style&index=0&id=1e37f11a&scoped=true&lang=less&\""],"sourceRoot":""}